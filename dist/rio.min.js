!function i(a,s,u){function c(t,e){if(!s[t]){if(!a[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(d)return d(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[t]={exports:{}};a[t][0].call(r.exports,function(e){return c(a[t][1][e]||e)},r,r.exports,i,a,s,u)}return s[t].exports}for(var d="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,o){var n;Object.defineProperty(o,"__esModule",{value:!0}),o.DIR_MODEL="model",o.DIR_EVENT_CLICK="click",o.PRE="r-",o.REG_SINGLE=/^\{\{([^\{\}]*)\}\}$/,o.REG_MULTI=/\{\{(.*?)\}\}/,o.REG_EVENT=/^(\w+)\((.*)\)$/,o.REG_STR=/^(['"])(.*?)\1$/,o.REG_MID_STR=/(['"])(.*?)\1/,o.REG_IN=/^\[(\w+)\]$/,o.REG_OUT=/^\((\w+)\)$/,o.REG_ATTR=/^[A-z_]\w*$/,o.REG_TEST_OUTPUT=/^((click))$/,(n=o.VNodeStatus||(o.VNodeStatus={}))[n.ACTIVE=0]="ACTIVE",n[n.INACTIVE=1]="INACTIVE",n[n.DEPRECATED=2]="DEPRECATED"},{}],2:[function(e,t,o){function n(e,t){if("select"!=e.NodeName.toLowerCase()){var o=e.Dom.getAttribute("type");switch(null!=o&&""!=o||(o="text"),o){case"text":e.Dom.value=t;break;case"radio":e.Dom.value==t?e.Dom.checked=!0:e.Dom.checked=!1;break;case"checkbox":"[object Array]"==toString.call(t)&&(-1==t.indexOf(e.Dom.value)?e.Dom.checked=!1:e.Dom.checked=!0)}}else e.Dom.value=t}Object.defineProperty(o,"__esModule",{value:!0}),o.DirModel=function(i,a){var e=a.Vdom.GetAttr("type");"input"==a.Vdom.NodeName.toLowerCase()&&"checkbox"==e?a.mvvm.$watch(a,i,function(e){n(a,e)},!0):a.mvvm.$watch(a,i,function(e){n(a,e)}),a.Dom.addEventListener("input",function(e){if("select"!=a.NodeName.toLowerCase()){var t=a.Dom.getAttribute("type");switch(null!=t&&""!=t||(t="text"),t){case"text":case"radio":a.mvvm.SetValue(i,e.target.value);break;case"checkbox":var o=a.mvvm.GetExpValue(i);if("[object Array]"==toString.call(o)){var n=o,r=n.indexOf(e.target.value);-1==r?n.push(e.target.value):n.splice(r,1)}}}else a.mvvm.SetValue(i,e.target.value)})}},{}],3:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var i=e("../const");o.OnClick=function(e,n){if(i.REG_EVENT.test(e)){var t=RegExp.$1,o=RegExp.$2;if(0<o.length){var r=o.split(",");n.Dom.addEventListener("click",function(){var e,o=[];r.forEach(function(e){if(i.REG_STR.test(e))o.push(RegExp.$2);else{if("true"===e)return void o.push(!0);"false"===e&&o.push(!1);var t=new Number(e).valueOf();isNaN(t)?o.push(n.mvvm.GetExpValue(e)):o.push(t.valueOf())}}),(e=n.mvvm).RevokeMethod.apply(e,[t].concat(o))})}else n.Dom.addEventListener("click",function(){n.mvvm.RevokeMethod(t)})}}},{"../const":1}],4:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var n=e("./manager/components-manager"),r=e("./manager/directive-manager");window.Rio={component:function(e,t,o){return t.$name=e,t.$namespace=null!=o?o:"default",n.RegisterComponent(t),this},directive:function(e,t,o){return t.$name=e,t.$namespace=null!=o?o:"default",r.RegisterDirective(t),this},namespace:function(o){return{component:function(e,t){return window.Rio.component(e,t,o),this},directive:function(e,t){return window.Rio.directive(e,t,o),this}}}},document.addEventListener("DOMContentLoaded",function(){n.Start()})},{"./manager/components-manager":5,"./manager/directive-manager":6}],5:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var i=e("../mvvm/mvvm"),a=e("../vnode/custom-node"),s=e("../vdom/vdom"),u=e("../util"),c=[],n={default:{}};function d(e,t){e=e.toLowerCase(),t=t.toLowerCase();var o=n[t]&&n[t][e];return o&&null==o.$id&&function(t){if(t.$id=t.$namespace+"_"+t.$name,null!=t.templateUrl&&(t.template=u.HttpGet(t.templateUrl),null==t.template))return u.LogError("path "+t.templateUrl+" not found");var e=(new DOMParser).parseFromString(t.template,"text/html").body.children[0];t.$domtree=s.TraverseDom(e),null!=t.styleUrl&&(t.style=u.HttpGet(t.styleUrl));if(null!=t.style){var o=t.style.replace(/(?!\s)([^\{\}]+)(?=\{[^\{\}]*\})/g,function(e){return e+"["+t.$id+"]"}),n=document.createElement("style");n.type="text/css",n.innerHTML=o,document.getElementsByTagName("head")[0].appendChild(n),function t(e,o){e.AddAttr(o);1==e.NodeType&&e.Children.forEach(function(e){t(e,o)})}(t.$domtree,t.$id)}}(o),o}function h(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),!(!n[t]||!n[t][e])}o.Start=function(){!function e(t){var o=u.GetNS(t.nodeName);if(h(o.value,o.namespace||"default")){var n=d(o.value,o.namespace||"default");c.push({option:n,dom:t})}else for(var r=0;r<t.children.length;r++){var i=t.children[r];e(i)}}(document.body),c.forEach(function(e){var t=s.TraverseDom(e.dom),o=new i.MVVM(e.option),n=new a.CustomNode(t,null,null,o);n.ParseTemplate(),(o.$FenceNode=n).AttachDom();var r=o.Render();e.dom.parentElement.replaceChild(r,e.dom)})},o.RegisterComponent=function(e){!function(e){if(u.IsStringEmpty(e.$name))throw new Error("component name should not be null");if(u.IsStringEmpty(e.template)&&u.IsStringEmpty(e.templateUrl))throw new Error("component template should not be null");if(n[e.$namespace]&&n[e.$namespace][e.$name])throw new Error("component "+e.$name+" has already exist")}(e),e.data=e.data||{},e.events=e.events||[],e.methods=e.methods||{},e.props=e.props||[],e.$name=e.$name||"",e.computed=e.computed||{},null==n[e.$namespace]&&(n[e.$namespace]={}),n[e.$namespace][e.$name]=e},o.GetComponent=d,o.IsComponentRegistered=h},{"../mvvm/mvvm":9,"../util":14,"../vdom/vdom":15,"../vnode/custom-node":16}],6:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var n=e("../util"),r={default:{}};o.RegisterDirective=function(e){!function(e){if(n.IsStringEmpty(e.$name))throw new Error("directive name should not be null");if(r[e.$namespace]&&r[e.$namespace][e.$name])throw new Error("directive "+e.$name+" has already exist")}(e),e.data=e.data||{},e.events=e.events||[],e.methods=e.methods||{},e.props=e.props||[],null==r[e.$namespace]&&(r[e.$namespace]={}),r[e.$namespace][e.$name]=e},o.GetDirective=function(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),r[t]&&r[t][e]},o.IsDirectiveRegistered=function(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),!(!r[t]||!r[t][e])}},{"../util":14}],7:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t){this.itemExp=e,this.arrayExp=t};o.ForExp=n},{}],8:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../observer/observe"),r=function(){function e(e,t,o){this.$directive=t,this.$vnode=o,this.$methods={},this.$Ins=[],this.$Outs=[],null!=e.data?this.$data=JSON.parse(JSON.stringify(e.data)):this.$data={},this.$methods=e.methods||{},this.$Ins=e.props||[],this.$Outs=e.events||[],this.proxyData(),this.proxyMethod(),this.$observe=new n.Observe(this)}return e.prototype.proxyData=function(){var e=function(t){Object.defineProperty(o,t,{get:function(){return this.$data[t]},set:function(e){this.$data[t]=e}})},o=this;for(var t in this.$data)e(t)},e.prototype.proxyMethod=function(){var e=function(e){Object.defineProperty(t,e,{get:function(){return this.$methods[e]}})},t=this;for(var o in this.$methods)e(o)},e.prototype.$ondestroy=function(){null!=this.$methods.$destroy&&this.$methods.$destroy()},e.prototype.$watch=function(e,t){this.$observe.AddWatcher(this.$vnode,e,t)},e.prototype.Render=function(){var n=this;this.$element=this.$vnode.Dom,this.$Ins.forEach(function(o){var e=n.$directive.GetIn(o.name);if(null==e&&o.required)throw new Error("component '"+n.$name+"' need prop '"+o.name);null!=e&&(n.$vnode.mvvm.$watch(n.$vnode,e,function(e,t){n.$checkProp(o,e),n[o.name]=e}),n.$observe.ReactiveKey(n,o.name,!0))}),this.$methods&&this.$methods.$init&&this.$methods.$init.call(this)},e.prototype.$checkProp=function(e,t){var o=function(e,t,o){throw new Error("component '"+e+"' prop '"+t+"' not receive "+o)};"array"==e.type&&"[object Array]"!=toString.call(t)&&o(this.$name,e.name,e.type),"object"==e.type&&"[object Object]"!=toString.call(t)&&o(this.$name,e.name,e.type),"number"==e.type&&"[object Number]"!=toString.call(t)&&o(this.$name,e.name,e.type),"boolean"==e.type&&"[object Boolean]"!=toString.call(t)&&o(this.$name,e.name,e.type),"string"==e.type&&"[object String]"!=toString.call(t)&&o(this.$name,e.name,e.type)},e}();o.DirectiveMVVM=r},{"./../observer/observe":12}],9:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var r=e("./revoke-event"),n=e("../observer/observe"),i=function(){function e(e){this.$methods={},this.$computed={},this.$Ins=[],this.$Outs=[],this.$name="",this.hirented=!1,this.$data=JSON.parse(JSON.stringify(e.data)),this.$methods=e.methods,this.$name=e.$name,this.$computed=e.computed,this.$template=e.template,this.$Namespace=e.$namespace,this.$domtree=e.$domtree,e.methods&&e.methods.$init&&e.methods.$init.call(this),this.$Ins=e.props,this.$Outs=e.events,this.$observe=new n.Observe(this),this.$observe.ReactiveData(this.$data),this.proxyData(),this.proxyMethod()}return e.prototype.proxyData=function(){var e=function(t){Object.defineProperty(o,t,{get:function(){return this.$data[t]},set:function(e){this.$data[t]=e}})},o=this;for(var t in this.$data)e(t)},e.prototype.proxyMethod=function(){var e=function(e){Object.defineProperty(t,e,{get:function(){return this.$methods[e]}})},t=this;for(var o in this.$methods)e(o)},e.prototype.proxyComputed=function(){for(var e in this.$computed)this.$observe.WatchComputed(this.$FenceNode,e,this.$computed[e])},e.prototype.SetHirented=function(e){this.hirented=e},e.prototype.GetTemplate=function(){return this.$template},e.prototype.GetDomTree=function(){return this.$domtree},e.prototype.Render=function(){var n=this;return this.proxyComputed(),this.hirented&&(Object.keys(this.$FenceNode.mvvm.$data).forEach(function(o){n.$FenceNode.mvvm.$watch(n.$FenceNode,o,function(e,t){n[o]=e}),n.$observe.ReactiveKey(n,o,!0)}),Object.keys(this.$FenceNode.mvvm.$computed).forEach(function(o){n.$FenceNode.mvvm.$watch(n.$FenceNode,o,function(e,t){n[o]=e}),n.$observe.ReactiveKey(n,o,!0)})),this.$Ins.forEach(function(o){var e=n.$FenceNode.GetIn(o.name);if(null==e&&o.required)throw new Error("component '"+n.$name+"' need prop '"+o.name);null!=e&&(n.$FenceNode.mvvm.$watch(n.$FenceNode,e,function(e,t){n.$checkProp(o,e),n[o.name]=e}),n.$observe.ReactiveKey(n,o.name,!0))}),this.$TreeRoot.Render(),this.$TreeRoot.Dom},e.prototype.RevokeMethod=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];this.hirented?(t=this.$FenceNode.mvvm).RevokeMethod.apply(t,[e].concat(o)):null!=this.$methods[e]&&this.$methods[e].apply(this,o)},e.prototype.GetExpValue=function(e){return this.$observe.GetValueWithExp(e)},e.prototype.SetValue=function(e,t){for(var o=e.split("."),n=this.$data,r=!0,i=0;i<o.length-1;i++){if(null==n){r=!1;break}n=n[o[i]]}r&&null!=n&&(n[o[o.length-1]]=t)},e.prototype.$emit=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(null!=this.$FenceNode&&null!=this.$FenceNode.mvvm){var n=this.$FenceNode.GetOut(e);r.RevokeEvent(n,t,this.$FenceNode.mvvm)}},e.prototype.$watch=function(e,t,o,n){this.$observe.AddWatcher(e,t,o,n)},e.prototype.$ondestroy=function(){null!=this.$methods.$destroy&&this.$methods.$destroy(),this.$TreeRoot.OnRemoved()},e.prototype.$checkProp=function(e,t){var o=function(e,t,o){throw new Error("component '"+e+"' prop '"+t+"' not receive "+o)};"array"==e.type&&"[object Array]"!=toString.call(t)&&o(this.$name,e.name,e.type),"object"==e.type&&"[object Object]"!=toString.call(t)&&o(this.$name,e.name,e.type),"number"==e.type&&"[object Number]"!=toString.call(t)&&o(this.$name,e.name,e.type),"boolean"==e.type&&"[object Boolean]"!=toString.call(t)&&o(this.$name,e.name,e.type),"string"==e.type&&"[object String]"!=toString.call(t)&&o(this.$name,e.name,e.type)},e}();o.MVVM=i},{"../observer/observe":12,"./revoke-event":10}],10:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var s=e("../const");o.RevokeEvent=function(e,o,n){if(s.REG_EVENT.test(e)){var t=RegExp.$1,r=RegExp.$2;if(0<r.length){var i=r.split(","),a=[];i.forEach(function(e){if(s.REG_STR.test(e))a.push(RegExp.$2);else{if("true"===e)return void a.push(!0);if("false"===e)return void a.push(!1);if("$event"==e)return void a.push.apply(a,o);var t=new Number(e).valueOf();isNaN(t)?a.push(n.GetExpValue(e)):a.push(t.valueOf())}}),n.RevokeMethod.apply(n,[t].concat(a))}else n.RevokeMethod(t)}}},{"../const":1}],11:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var n=[],r=!1;function i(){var t=[];n.forEach(function(e){return t.push(e)}),n=[],t.forEach(function(e){return e.Update()}),0<n.length&&i()}o.AddWatcher=function(e){-1==n.indexOf(e)&&n.push(e),r||(r=!0,setTimeout(function(){i(),r=!1},0))},o.RevokeWatcher=i},{}],12:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var u=e("./watcher"),n=e("./msg-queue"),r=e("../const"),i=function(){function s(e){this.data=e}return s.prototype.GetValue=function(e){var t;return"string"==typeof(s.target=e).ExpOrFunc&&(t=EvalExp(this.data,e.ExpOrFunc)),"function"==typeof e.ExpOrFunc&&(t=e.ExpOrFunc.call(this.data)),s.target=null,t},s.prototype.GetValueWithExp=function(e){return EvalExp(this.data,e)},s.prototype.AddWatcher=function(e,t,o,n){new u.Watcher(e,t,o,this,n)},s.prototype.ReactiveData=function(o){var n=this;null!=o&&"object"==typeof o&&Object.keys(o).forEach(function(e){var t=new c(e);n.defineReactive(o,e,!1,t),n.ReactiveData(o[e])})},s.prototype.ReactiveKey=function(e,t,o){var n=new c(t);this.defineReactive(e,t,o,n)},s.prototype.reactiveArray=function(a,s){var u=this;a.push==Array.prototype.push&&(Object.defineProperty(a,"push",{enumerable:!1,configurable:!0,value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o,n=a.length,r=(o=Array.prototype.push).call.apply(o,[a].concat(e)),i=n;i<r;i++)u.ReactiveKey(a,""+i,!1);return s.Notify(),r}}),Object.defineProperty(a,"pop",{enumerable:!1,configurable:!0,value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o,n=(o=Array.prototype.pop).call.apply(o,[a].concat(e));return s.Notify(),n}}),Object.defineProperty(a,"splice",{enumerable:!1,configurable:!0,value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o,n=(o=Array.prototype.splice).call.apply(o,[a].concat(e));2<e.length&&e.slice(2).forEach(function(e){var t=a.indexOf(e);u.ReactiveKey(a,""+t,!1)});return s.Notify(),n}}),Object.defineProperty(a,"shift",{enumerable:!1,configurable:!0,value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o,n=(o=Array.prototype.shift).call.apply(o,[a].concat(e));return s.Notify(),n}}))},s.prototype.defineReactive=function(e,t,o,n){var r=this,i=e[t];"[object Array]"==toString.call(i)&&this.reactiveArray(i,n),Object.defineProperty(e,t,{get:function(){return null!=s.target&&n.AddTarget(s.target),i},set:function(e){e!=i&&(i=e,"[object Array]"==toString.call(i)&&r.reactiveArray(i,n),o||r.ReactiveData(e),n.Notify())},enumerable:!0,configurable:!0})},s.prototype.WatchComputed=function(t,e,o){var n,r=this,i=new c(e),a=!0;Object.defineProperty(this.data,e,{get:function(){if(null!=s.target&&i.AddTarget(s.target),a){var e=s.target;s.target=null,new u.Watcher(t,o,function(e){n=e,i.Notify()},r),s.target=e,a=!1}return n},enumerable:!0,configurable:!0})},s}();o.Observe=i;var c=function(){function e(e){this.key=e,this.watches=[]}return e.prototype.GetKey=function(){return this.key},e.prototype.AddTarget=function(e){-1==this.watches.indexOf(e)&&this.watches.push(e)},e.prototype.Notify=function(){this.watches=this.watches.filter(function(e){return e.GetVNode().GetStatus()==r.VNodeStatus.ACTIVE?(n.AddWatcher(e),!0):e.GetVNode().GetStatus()==r.VNodeStatus.INACTIVE||e.GetVNode().GetStatus()!=r.VNodeStatus.DEPRECATED&&void 0})},e}();o.Depender=c},{"../const":1,"./msg-queue":11,"./watcher":13}],13:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var n=e("../const"),r=function(){function e(e,t,o,n,r){if(this.vnode=e,this.ExpOrFunc=t,this.cb=o,this.observer=n,this.deep=r,this.deepRecord=[],this.value=this.observer.GetValue(this),this.deep&&"[object Array]"==toString.call(this.value))for(var i=0;i<this.value.length;i++)this.deepRecord[i]=this.value[i];this.cb(this.value,void 0)}return e.prototype.GetVNode=function(){return this.vnode},e.prototype.Update=function(){var e=this.observer.GetValue(this);if(this.value!=e)this.vnode.GetStatus()==n.VNodeStatus.ACTIVE&&this.cb(e,this.value),this.value=e;else if(this.deep&&"[object Array]"==toString.call(this.value)){for(var t=!1,o=0;o<e.length;o++)if(e[o]!=this.deepRecord[o]){this.cb(e,this.value),t=!0;break}if(t){this.deepRecord=[];for(o=0;o<e.length;o++)this.deepRecord[o]=e[o]}}},e}();o.Watcher=r},{"../const":1}],14:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0}),o.LogError=function(e){console.error(e)},o.LogInfo=function(e){console.log(e)},o.GetNS=function(e){var t=e.split(":");return 1==t.length?{namespace:null,value:t[0]}:2==t.length?{namespace:t[0],value:t[1]}:void 0},o.HttpGet=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),4==t.readyState&&200==t.status?t.responseText:null},o.IsStringEmpty=function(e){return null==e||""==(e=e.trim())},o.Trim=function(e,t){if(1<t.length)throw new Error("only receve one character");for(var o=-1;e[o+1]==t;)o++;for(var n=e.length;e[n-1]==t;)n--;return e.substring(o+1,n)}},{}],15:[function(u,e,t){Object.defineProperty(t,"__esModule",{value:!0});var c,o,d=u("../manager/components-manager"),h=u("../mvvm/mvvm"),p=u("../util"),m=u("../const"),l=u("../vnode/vinalla-node"),a=function(){function e(){this.Attrs=[],this.Children=[]}return e.prototype.GetAttr=function(e){for(var t=0;t<this.Attrs.length;t++)if(this.Attrs[t].Name==e)return this.Attrs[t].Value;return null},e.prototype.AddAttr=function(e){this.Attrs.push({Name:e,Value:""})},e}();t.VDom=a,t.TraverseDom=function e(t){if(3!=t.nodeType||""!=t.nodeValue.trim()){var o=new a;if(o.NodeValue=t.nodeValue,null!=o.NodeValue&&(o.NodeValue=o.NodeValue.replace(/\s+/g,"")),o.NodeName=t.nodeName,o.NodeType=t.nodeType,1==t.nodeType){for(var n=t,r=0;r<n.attributes.length;r++)o.Attrs.push({Name:n.attributes[r].name,Value:n.attributes[r].value});for(r=0;r<n.childNodes.length;r++){var i=e(n.childNodes[r]);i&&o.Children.push(i)}}return o}},(o=c=t.Priority||(t.Priority={}))[o.NORMAL=0]="NORMAL",o[o.IF=1]="IF",o[o.FOR=2]="FOR",t.NewVNode=function(e,t,o,n){if(void 0===n&&(n=c.FOR),"slot"==e.NodeName.toLowerCase())return new(u("../vnode/slot-node").SlotNode)(e,t,o,e.GetAttr("name"));if(n>=c.FOR&&null!=e.GetAttr(m.PRE+"for"))return new(u("../vnode/for-node").ForNode)(e,t,o,e.GetAttr(m.PRE+"for"));if(n>=c.IF&&null!=e.GetAttr(m.PRE+"if"))return new(u("../vnode/if-node").IfNode)(e,t,o,e.GetAttr(m.PRE+"if"));var r=p.GetNS(e.NodeName);if(d.IsComponentRegistered(r.value,r.namespace||"default")){var i=d.GetComponent(r.value,r.namespace||"default"),a=new h.MVVM(i),s=new(u("../vnode/custom-node").CustomNode)(e,t,o,a);return(a.$FenceNode=s).ParseTemplate(),s}return new l.VinallaNode(e,t,o)}},{"../const":1,"../manager/components-manager":5,"../mvvm/mvvm":9,"../util":14,"../vnode/custom-node":16,"../vnode/for-node":18,"../vnode/if-node":19,"../vnode/slot-node":20,"../vnode/vinalla-node":22}],16:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var s=e("./vinalla-node"),u=e("../const"),c=e("../manager/components-manager"),d=e("../mvvm/mvvm"),h=e("../util"),p=e("../vdom/vdom"),m=e("./template-node"),i=function(i){function a(e,t,o,n){var r=i.call(this,e,t,o)||this;return r.Vdom=e,r.mvvm=t,r.Parent=o,r.SurroundMvvm=n,r.ins_pure={},r.ins_exp={},r.outs={},r}return r(a,i),a.prototype.AddIns=function(e,t){this.ins_exp[e]=t},a.prototype.GetTemplate=function(e){for(var t=0;t<this.Children.length;t++){var o=this.Children[t];if(o.templatename==e)return o}return null},a.prototype.Render=function(){this.Dom=this.SurroundMvvm.Render(),this.Dom&&this.Parent&&this.Parent.Dom&&this.Parent.Dom.appendChild(this.Dom)},a.prototype.childSet=function(){var e=new m.TemplateNode(this.Vdom,this.mvvm?this.mvvm:this.SurroundMvvm,this,"default");e.Parent=this;for(var t={default:e},o=0;o<this.Vdom.Children.length;o++){var n=this.Vdom.Children[o],r=this.Vdom.GetAttr("slot");null!=r&&""!=r||(r="default"),null==t[r]&&(t[r]=new m.TemplateNode(this.Vdom,this.mvvm?this.mvvm:this.SurroundMvvm,this,r),t[r].Parent=this);var i=p.NewVNode(n,t[r].mvvm,t[r]);i.AttachDom(),t[r].Children.push(i)}for(var a in t)this.Children.push(t[a])},a.prototype.ParseTemplate=function(){var e=this.SurroundMvvm.GetDomTree(),t=h.GetNS(e.NodeName);if(c.IsComponentRegistered(t.value,t.namespace||this.SurroundMvvm.$Namespace)){var o=c.GetComponent(t.value,t.namespace||this.SurroundMvvm.$Namespace),n=new d.MVVM(o),r=new a(e,this.SurroundMvvm,null,n);this.SurroundMvvm.$TreeRoot=r,n.$FenceNode=this,r.ParseTemplate()}else this.SurroundMvvm.$TreeRoot=new s.VinallaNode(e,this.SurroundMvvm,null);this.SurroundMvvm.$TreeRoot.AttachDom()},a.prototype.GetInValue=function(e){return null!=this.ins_pure[e]?this.ins_pure[e]:null!=this.ins_exp[e]?this.mvvm.GetExpValue(this.ins_exp[e]):null},a.prototype.GetIn=function(e){return this.ins_pure[e]||this.ins_exp[e]},a.prototype.GetOut=function(e){return this.outs[e]},a.prototype.Refresh=function(){this.SurroundMvvm.$TreeRoot.Refresh()},a.prototype.Update=function(){this.SurroundMvvm.$TreeRoot.Update()},a.prototype.OnRemoved=function(){this.SurroundMvvm.$ondestroy()},a.prototype.SetStatus=function(e){this.status=e,this.SurroundMvvm.$TreeRoot.SetStatus(e)},a.prototype.AddProperty=function(e,t){for(var o=0;o<this.SurroundMvvm.$Ins.length;o++){var n=this.SurroundMvvm.$Ins[o];if(u.REG_IN.test(e)&&n.name==RegExp.$1)return void(this.ins_exp[RegExp.$1]=t);if(n.name==e)return void(this.ins_pure[e]=t)}for(o=0;o<this.SurroundMvvm.$Outs.length;o++){var r=this.SurroundMvvm.$Outs[o];if(u.REG_OUT.test(e)&&r==RegExp.$1)return void(this.outs[RegExp.$1]=t)}i.prototype.AddProperty.call(this,e,t)},a}(e("./vnode").VNode);o.CustomNode=i},{"../const":1,"../manager/components-manager":5,"../mvvm/mvvm":9,"../util":14,"../vdom/vdom":15,"./template-node":21,"./vinalla-node":22,"./vnode":23}],17:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var i=e("../const"),n=function(){function e(e,t){var o=this;this.vdom=e,this.directiveOption=t,this.ins_pure={},this.ins_exp={},this.outs={},this.vdom.Attrs.forEach(function(e){o.addProperty(e.Name,e.Value)})}return e.prototype.addProperty=function(e,t){for(var o=0;o<this.directiveOption.props.length;o++){var n=this.directiveOption.props[o];if(i.REG_IN.test(e)&&n.name==RegExp.$1)return void(this.ins_exp[RegExp.$1]=t);if(n.name==e)return void(this.ins_pure[e]=t)}for(o=0;o<this.directiveOption.events.length;o++){var r=this.directiveOption.events[o];if(i.REG_OUT.test(e)&&r==RegExp.$1)return void(this.outs[RegExp.$1]=t)}},e.prototype.GetIn=function(e){return this.ins_pure[e]||this.ins_exp[e]},e.prototype.GetOut=function(e){return this.outs[e]},e}();o.Directive=n},{"../const":1}],18:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var s=e("../models"),i=e("../mvvm/mvvm"),u=e("../vdom/vdom"),c=e("./custom-node"),a=e("./vnode"),d=e("../const"),h=function(a){function e(e,t,o,n){var r=a.call(this,e,t,o)||this;r.Vdom=e,r.mvvm=t,r.Parent=o,r.originForExp=n,r.dynamicVNodes=[],r.IsTemplate=!0;var i=r.originForExp.trim().split(/\s+/);return r.ForExp=new s.ForExp(i[0],i[2]),r}return r(e,a),e.prototype.newCopyNode=function(e){var t=this.ForExp.itemExp,o=new i.MVVM({$name:"",data:{},methods:{},computed:{},events:[],$namespace:this.mvvm.$Namespace,props:[{name:t,required:!0}]});o.SetHirented(!0);var n=new c.CustomNode(this.Vdom,this.mvvm,null,o);return(o.$FenceNode=n).IsCopy=!0,n.AddIns(t,this.ForExp.arrayExp+"["+e+"]"),n},e.prototype.reImplementForExp=function(e){var t=this;if(e>this.dynamicVNodes.length){for(var o=[],n=this.dynamicVNodes.length,r=this.dynamicVNodes.length;r<e;r++){var i=this.newCopyNode(r),a=u.NewVNode(this.Vdom,i.SurroundMvvm,null,u.Priority.IF);a.AttachDom(),i.SurroundMvvm.$TreeRoot=a,o.push(i)}return o.forEach(function(e){t.dynamicVNodes.push(e),e.Render()}),this.Parent.AddChildren(this,o,n),void this.Parent.Refresh()}if(e<this.dynamicVNodes.length){var s=this.dynamicVNodes.splice(e);s.forEach(function(e){return e.SetStatus(d.VNodeStatus.DEPRECATED)}),this.Parent.RemoveChildren(s),s.forEach(function(e){e.OnRemoved()}),this.Parent.Refresh()}},e.prototype.Update=function(){var e=this.mvvm.GetExpValue(this.ForExp.arrayExp);"[object Array]"===toString.call(e)&&this.reImplementForExp(e.length)},e.prototype.AttachDom=function(){},e.prototype.Render=function(){this.mvvm.$watch(this,this.ForExp.arrayExp+".length",this.reImplementForExp.bind(this))},e.prototype.OnRemoved=function(){this.dynamicVNodes.forEach(function(e){return e.OnRemoved()})},e.prototype.SetStatus=function(t){this.status=t,this.dynamicVNodes.forEach(function(e){return e.SetStatus(t)})},e}(a.VNode);o.ForNode=h},{"../const":1,"../models":7,"../mvvm/mvvm":9,"../vdom/vdom":15,"./custom-node":16,"./vnode":23}],19:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=e("./vnode"),a=e("../vdom/vdom"),s=e("../const"),u=function(i){function e(e,t,o,n){var r=i.call(this,e,t,o)||this;return r.Vdom=e,r.mvvm=t,r.Parent=o,r.ifExp=n,r.IsTemplate=!0,r}return r(e,i),e.prototype.AttachDom=function(){},e.prototype.Render=function(){var t=this;this.mvvm.$watch(this,this.ifExp,function(e){return t.reImpletement(e)})},e.prototype.Update=function(){var e=this.mvvm.GetExpValue(this.ifExp);this.reImpletement(e)},e.prototype.reImpletement=function(e){e?(null==this.dynamicVNode?(this.instance(),this.dynamicVNode.Render()):this.dynamicVNode.Update(),null!=this.Parent?(this.Parent.AddChildren(this,[this.dynamicVNode],0),this.Parent.Refresh()):(this.mvvm.$FenceNode.Dom=this.dynamicVNode.Dom,this.mvvm.$FenceNode.Parent.Refresh()),this.dynamicVNode.SetStatus(s.VNodeStatus.ACTIVE)):null!=this.dynamicVNode&&(null!=this.Parent?(this.Parent.RemoveChildren([this.dynamicVNode]),this.Parent.Refresh()):(this.mvvm.$FenceNode.Dom=null,this.mvvm.$FenceNode.Parent.Refresh()),this.dynamicVNode.SetStatus(s.VNodeStatus.INACTIVE))},e.prototype.instance=function(){this.dynamicVNode=a.NewVNode(this.Vdom,this.mvvm,null,a.Priority.NORMAL),this.dynamicVNode.IsCopy=!0,this.dynamicVNode.AttachDom()},e.prototype.OnRemoved=function(){null!=this.dynamicVNode&&this.dynamicVNode.OnRemoved()},e.prototype.SetStatus=function(e){this.status=e,null!=this.dynamicVNode&&this.dynamicVNode.SetStatus(e)},e}(i.VNode);o.IfNode=u},{"../const":1,"../vdom/vdom":15,"./vnode":23}],20:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(i){function e(e,t,o,n){var r=i.call(this,e,t,o)||this;return r.vdom=e,r.mvvm=t,r.Parent=o,r.name=n,null!=r.name&&""!=r.name||(r.name="default"),r}return r(e,i),e.prototype.Render=function(){var e=this.mvvm.$FenceNode.GetTemplate(this.name);if(null!=e)for(e.Render(),this.Dom=e.Dom;null!=this.Dom.firstChild;)this.Parent.Dom.appendChild(this.Dom.firstChild);return null},e.prototype.Update=function(){var e=this.mvvm.$FenceNode.GetTemplate(this.name);null!=e&&e.Update()},e.prototype.SetStatus=function(e){this.status=e,this.mvvm.$FenceNode.GetTemplate(this.name).SetStatus(e)},e.prototype.OnRemoved=function(){this.mvvm.$FenceNode.GetTemplate(this.name).OnRemoved()},e}(e("./vnode").VNode);o.SlotNode=i},{"./vnode":23}],21:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(i){function e(e,t,o,n){var r=i.call(this,e,t,o)||this;return r.vdom=e,r.mvvm=t,r.Parent=o,r.templatename=n,r}return r(e,i),e.prototype.Render=function(){this.Dom=document.createElement("div"),this.Children.forEach(function(e){e.Render()})},e.prototype.Update=function(){var t=[];this.Children.forEach(function(e){t.push(e)}),t.forEach(function(e){e.Update()})},e}(e("./vnode").VNode);o.TemplateNode=i},{"./vnode":23}],22:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var u=e("../manager/directive-manager"),c=e("../mvvm/directive-mvvm"),d=e("../util"),h=e("./../const"),p=e("./directive"),i=e("./vnode"),a=e("../directive/model"),s=e("../directive/onclick"),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.directives=[],e.innerDirective=[],e}return r(e,t),e.prototype.AddProperty=function(e,t){h.REG_ATTR.test(e)&&this.Attrs.push({name:e,value:t})},e.prototype.OnRemoved=function(){t.prototype.OnRemoved.call(this),this.directives.forEach(function(e){return e.$ondestroy()})},e.prototype.directiveBind=function(){var t=this;this.directives.forEach(function(e){return e.Render()}),this.innerDirective.forEach(function(e){e.name==h.PRE+"model"&&a.DirModel(e.value,t),e.name==h.PRE+"click"&&s.OnClick(e.value,t)})},e.prototype.basicSet=function(){var t=this;this.NodeValue=this.Vdom.NodeValue,this.NodeName=this.Vdom.NodeName,this.NodeType=this.Vdom.NodeType;for(var a=this.Vdom.Attrs,e=function(e){var t=s.Vdom.Attrs[e],o=d.GetNS(t.Name);if(null==o.namespace&&(o.namespace=s.mvvm.$Namespace),u.IsDirectiveRegistered(o.value,o.namespace)){var r=u.GetDirective(o.value,o.namespace);a=a.filter(function(e){var t=e.Name;(h.REG_IN.test(e.Name)||h.REG_OUT.test(e.Name))&&(t=RegExp.$1);var o=r.props.some(function(e){return e.name==t}),n=r.events.some(function(e){return e==t});return!(o||n)});var n=new p.Directive(s.Vdom,r),i=new c.DirectiveMVVM(r,n,s);return s.directives.push(i),{value:void 0}}},s=this,o=0;o<this.Vdom.Attrs.length;o++){var n=e(o);if("object"==typeof n)return n.value}(a=a.filter(function(e){return e.Name==h.PRE+"model"?(t.innerDirective.push({name:e.Name,value:e.Value}),!1):e.Name!=h.PRE+"click"||(t.innerDirective.push({name:e.Name,value:e.Value}),!1)})).forEach(function(e){t.AddProperty(e.Name,e.Value)})},e}(i.VNode);o.VinallaNode=m},{"../directive/model":2,"../directive/onclick":3,"../manager/directive-manager":6,"../mvvm/directive-mvvm":8,"../util":14,"./../const":1,"./directive":17,"./vnode":23}],23:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var r=e("../const"),n=e("../vdom/vdom"),i=e("./../const"),a=function(){function e(e,t,o){this.Vdom=e,this.mvvm=t,this.Parent=o,this.Attrs=[],this.Children=[],this.IsTemplate=!1,this.IsCopy=!1,this.status=i.VNodeStatus.ACTIVE}return e.prototype.AddProperty=function(e,t){i.REG_ATTR.test(e)&&this.Attrs.push({name:e,value:t})},e.prototype.directiveBind=function(){},e.prototype.Render=function(){var o=this;if(1==this.NodeType){var t=document.createElement(this.NodeName);this.Attrs.forEach(function(e){t.setAttribute(e.name,e.value)}),this.Dom=t;var n=[];this.Children.forEach(function(e){e.IsCopy||n.push(e)}),n.forEach(function(e){e.Render()}),this.directiveBind()}if(3==this.NodeType)if(this.Dom=document.createTextNode(this.NodeValue),r.REG_SINGLE.test(this.NodeValue))this.mvvm.$watch(this,RegExp.$1,function(e,t){o.Dom.textContent=e});else if(i.REG_MULTI.test(this.NodeValue)){var e=this.multiBindParse(this.NodeValue);this.mvvm.$watch(this,e,function(e,t){o.Dom.textContent=e})}else this.Dom.textContent=this.NodeValue;this.Parent&&this.Parent.Dom&&this.Parent.Dom.appendChild(this.Dom)},e.prototype.multiBindParse=function(e){for(var t=/\{\{([^\{\}]*)\}\}/g,o=t.exec(e),n="",r=0;o;)o.index!=r&&(n+="'"+e.substring(r,o.index)+"'+"),r=o.index+o[0].length,n+="("+RegExp.$1+")+",o=t.exec(e);return n.lastIndexOf("+")==n.length-1&&(n=n.substring(0,n.length-1)),n},e.prototype.Update=function(){if(1==this.NodeType){var t=[];return this.Children.forEach(function(e){t.push(e)}),void t.forEach(function(e){e.Update()})}if(3==this.NodeType)if(r.REG_SINGLE.test(this.NodeValue))this.Dom.textContent=this.mvvm.GetExpValue(RegExp.$1);else if(i.REG_MULTI.test(this.NodeValue)){var e=this.multiBindParse(this.NodeValue);this.Dom.textContent=this.mvvm.GetExpValue(e)}else this.Dom.textContent=this.NodeValue},e.prototype.Refresh=function(){var t=this;if(!this.IsTemplate){var e=this.Dom.childNodes,o=[];this.Children.forEach(function(e){e.IsTemplate||null==e.Dom||(o=o.concat(e))});for(var n={old_j:-1,i:0,j:0},r=[];!(n.i>e.length-1);)if(n.j>o.length-1)r.push({type:"remove",node:e[n.i]}),n.i++,n.j=n.old_j+1;else if(e[n.i]==o[n.j].Dom)if(e[n.i]!=o[n.j].Dom);else{if(n.i<n.j)for(var i=n.old_j+1;i<n.j;)r.push({type:"add",beforeNode:e[n.i],node:o[i].Dom}),i++;n.old_j=n.j,n.i++,n.j++}else n.j++;for(;n.j<o.length;)r.push({type:"add",beforeNode:null,node:o[n.j].Dom}),n.j++;r.forEach(function(e){"add"==e.type&&(null!=e.beforeNode?t.Dom.insertBefore(e.node,e.beforeNode):t.Dom.appendChild(e.node)),"remove"==e.type&&e.node.remove()})}},e.prototype.AddChildren=function(e,t,o){for(var n=0;n<this.Children.length;n++)if(this.Children[n]==e){(r=this.Children).splice.apply(r,[n+1+o,0].concat(t));break}var r},e.prototype.RemoveChildren=function(t){this.Children=this.Children.filter(function(e){return-1==t.indexOf(e)})},e.prototype.OnRemoved=function(){this.Children.forEach(function(e){e.IsCopy||e.OnRemoved()})},e.prototype.basicSet=function(){this.NodeValue=this.Vdom.NodeValue,this.NodeName=this.Vdom.NodeName,this.NodeType=this.Vdom.NodeType;for(var e=0;e<this.Vdom.Attrs.length;e++)this.AddProperty(this.Vdom.Attrs[e].Name,this.Vdom.Attrs[e].Value)},e.prototype.childSet=function(){for(var e=0;e<this.Vdom.Children.length;e++){var t=this.Vdom.Children[e],o=n.NewVNode(t,this.mvvm,this);null!=o&&(o.AttachDom(),this.Children.push(o))}},e.prototype.AttachDom=function(){this.basicSet(),this.childSet()},e.prototype.SetStatus=function(t){this.status=t,this.Children.forEach(function(e){e.IsCopy||e.SetStatus(t)})},e.prototype.GetStatus=function(){return this.status},e}();o.VNode=a},{"../const":1,"../vdom/vdom":15,"./../const":1}]},{},[4]);var EvalExp=function(context,exp){var res;with(context)res=eval(exp);return res};