!function i(a,s,u){function d(t,e){if(!s[t]){if(!a[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(c)return c(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var r=s[t]={exports:{}};a[t][0].call(r.exports,function(e){return d(a[t][1][e]||e)},r,r.exports,i,a,s,u)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)d(u[e]);return d}({1:[function(e,t,o){var n;Object.defineProperty(o,"__esModule",{value:!0}),o.DIR_MODEL="model",o.DIR_EVENT_CLICK="click",o.REG_SINGLE=/^\{\{([^\{\}]*)\}\}$/,o.REG_MULTI=/\{\{(.*?)\}\}/,o.REG_EVENT=/^(\w+)\((.*)\)$/,o.REG_STR=/^(['"])(.*?)\1$/,o.REG_MID_STR=/(['"])(.*?)\1/,o.REG_IN=/^\[(\w+)\]$/,o.REG_OUT=/^\((\w+)\)$/,o.REG_ATTR=/^[A-z_]\w*$/,o.REG_TEST_INPUT=/^((model))$/,o.REG_TEST_OUTPUT=/^((click))$/,(n=o.VNodeStatus||(o.VNodeStatus={}))[n.ACTIVE=0]="ACTIVE",n[n.INACTIVE=1]="INACTIVE",n[n.DEPRECATED=2]="DEPRECATED"},{}],2:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var i=e("./model"),a=e("./onclick");o.DirectiveBind=function(e){var t=e.GetInput();for(var o in t)switch(o){case"model":i.DirModel(t[o],e)}var n=e.GetOutput();for(var r in n)switch(r){case"click":a.OnClick(n[r],e)}}},{"./model":3,"./onclick":4}],3:[function(e,t,o){function n(e,t){if("select"!=e.NodeName.toLowerCase()){var o=e.Dom.getAttribute("type");switch(null!=o&&""!=o||(o="text"),o){case"text":e.Dom.value=t;break;case"radio":e.Dom.value==t?e.Dom.checked=!0:e.Dom.checked=!1;break;case"checkbox":"[object Array]"==toString.call(t)&&(-1==t.indexOf(e.Dom.value)?e.Dom.checked=!1:e.Dom.checked=!0)}}else e.Dom.value=t}Object.defineProperty(o,"__esModule",{value:!0}),o.DirModel=function(i,a){var e=a.Vdom.GetAttr("type");"input"==a.Vdom.NodeName.toLowerCase()&&"checkbox"==e?a.mvvm.$watchExpOrFunc(a,i,function(e){n(a,e)},!0):a.mvvm.$watchExpOrFunc(a,i,function(e){n(a,e)}),a.Dom.addEventListener("input",function(e){if("select"!=a.NodeName.toLowerCase()){var t=a.Dom.getAttribute("type");switch(null!=t&&""!=t||(t="text"),t){case"text":case"radio":a.mvvm.SetValue(i,e.target.value);break;case"checkbox":var o=a.mvvm.GetExpValue(i);if("[object Array]"==toString.call(o)){var n=o,r=n.indexOf(e.target.value);-1==r?n.push(e.target.value):n.splice(r,1)}}}else a.mvvm.SetValue(i,e.target.value)})}},{}],4:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var i=e("../const");o.OnClick=function(e,n){if(i.REG_EVENT.test(e)){var t=RegExp.$1,o=RegExp.$2;if(0<o.length){var r=o.split(",");n.Dom.addEventListener("click",function(){var e,o=[];r.forEach(function(e){if(i.REG_STR.test(e))o.push(RegExp.$2);else{if("true"===e)return void o.push(!0);"false"===e&&o.push(!1);var t=new Number(e).valueOf();isNaN(t)?o.push(n.mvvm.GetExpValue(e)):o.push(t.valueOf())}}),(e=n.mvvm).RevokeMethod.apply(e,[t].concat(o))})}else n.Dom.addEventListener("click",function(){n.mvvm.RevokeMethod(t)})}}},{"../const":1}],5:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var r=e("./manager/components-manager"),i=e("./manager/value-manager");window.Rio={component:function(e,t){return t.$name=e,r.RegisterComponent(t,"default"),this},value:function(e){return i.RegisterValue(e,"default"),this},namespace:function(o){var n={component:function(e,t){return t.$name=e,r.RegisterComponent(t,o),n},value:function(e){return i.RegisterValue(e,o),n}};return n}},document.addEventListener("DOMContentLoaded",function(){r.Start()})},{"./manager/components-manager":6,"./manager/value-manager":7}],6:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var i=e("../mvvm/mvvm"),a=e("../vnode/custom-node"),s=e("../vdom/vdom"),u=e("../util"),d=[],n={default:{}};function c(e,t){e=e.toLowerCase(),t=t.toLowerCase();var o=n[t]&&n[t][e];return o&&null==o.$id&&function(t){if(t.$id=t.$namespace+"_"+t.$name,null!=t.templateUrl&&(t.template=u.HttpGet(t.templateUrl),null==t.template))return u.LogError("path "+t.templateUrl+" not found");var e=(new DOMParser).parseFromString(t.template,"text/html").body.children[0];t.$domtree=s.TraverseDom(e),null!=t.styleUrl&&(t.style=u.HttpGet(t.styleUrl));if(null!=t.style){var o=t.style.replace(/(?!\s)([^\{\}]+)(?=\{[^\{\}]*\})/g,function(e){return e+"["+t.$id+"]"}),n=document.createElement("style");n.type="text/css",n.innerHTML=o,document.getElementsByTagName("head")[0].appendChild(n),function t(e,o){e.AddAttr(o);1==e.NodeType&&e.Children.forEach(function(e){t(e,o)})}(t.$domtree,t.$id)}}(o),o}function h(e,t){return e=e.toLowerCase(),t=t.toLowerCase(),!(!n[t]||!n[t][e])}o.Start=function(){!function e(t){var o=u.GetNS(t.nodeName);if(h(o.value,o.namespace||"default")){var n=c(o.value,o.namespace||"default");d.push({option:n,dom:t})}else for(var r=0;r<t.children.length;r++){var i=t.children[r];e(i)}}(document.body),d.forEach(function(e){var t=s.TraverseDom(e.dom),o=new i.MVVM(e.option),n=new a.CustomNode(t,null,null,o);n.ParseTemplate(),(o.$FenceNode=n).AttachDom();var r=o.Render();e.dom.parentElement.replaceChild(r,e.dom)})},o.RegisterComponent=function(e,t){e.$namespace=t.toLowerCase(),null==n[t]&&(n[t]={}),n[t][e.$name]=e},o.GetComponent=c,o.IsComponentRegistered=h},{"../mvvm/mvvm":9,"../util":14,"../vdom/vdom":15,"../vnode/custom-node":16}],7:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var r={default:{}};o.RegisterValue=function(e,t){null==r[t]&&(r[t]={});var o=r[t];for(var n in e)o[n]=e[n]},o.GetValue=function(e,t){return r[t]&&r[t][e]},o.GetValues=function(e){return r[e]},o.IsValueRegistered=function(e,t){return!(!r[t]||!r[t][e])}},{}],8:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var n=function(e,t){this.itemExp=e,this.arrayExp=t};o.ForExp=n},{}],9:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var r=e("./revoke-event"),n=e("../observer/observe"),i=function(){function e(e){this.$methods={},this.$computed={},this.$Ins=[],this.$Outs=[],this.$name="",this.hirented=!1,null!=e.data?this.$data=JSON.parse(JSON.stringify(e.data)):this.$data={},this.$methods=e.methods||{},this.$name=e.$name||"",this.$computed=e.computed||{},this.$template=e.template,this.$Namespace=e.$namespace,this.$domtree=e.$domtree,e.methods&&e.methods.$init&&e.methods.$init.call(this),this.$Ins=e.props||[],this.$Outs=e.events||[],this.$observe=new n.Observe(this),this.$observe.ReactiveData(this.$data),this.proxyData(),this.proxyMethod()}return e.prototype.proxyData=function(){var e=function(t){Object.defineProperty(o,t,{get:function(){return this.$data[t]},set:function(e){this.$data[t]=e}})},o=this;for(var t in this.$data)e(t)},e.prototype.proxyMethod=function(){var e=function(e){Object.defineProperty(t,e,{get:function(){return this.$methods[e]}})},t=this;for(var o in this.$methods)e(o)},e.prototype.proxyComputed=function(){for(var e in this.$computed)this.$observe.WatchComputed(this.$FenceNode,e,this.$computed[e])},e.prototype.SetHirented=function(e){this.hirented=e},e.prototype.GetTemplate=function(){return this.$template},e.prototype.GetDomTree=function(){return this.$domtree},e.prototype.Render=function(){var n=this;return this.proxyComputed(),this.hirented&&(Object.keys(this.$FenceNode.mvvm.$data).forEach(function(o){n.$FenceNode.mvvm.$watchExpOrFunc(n.$FenceNode,o,function(e,t){n[o]=e}),n.$observe.ReactiveKey(n,o,!0)}),Object.keys(this.$FenceNode.mvvm.$computed).forEach(function(o){n.$FenceNode.mvvm.$watchExpOrFunc(n.$FenceNode,o,function(e,t){n[o]=e}),n.$observe.ReactiveKey(n,o,!0)})),this.$Ins.forEach(function(o){if(null==n.$FenceNode.GetIn(o.name)&&o.required)throw new Error("component '"+n.$name+"' need prop '"+o.name);var e=n.$FenceNode.GetIn(o.name);n.$FenceNode.mvvm.$watchExpOrFunc(n.$FenceNode,e,function(e,t){n.$checkProp(o,e),n[o.name]=e}),n.$observe.ReactiveKey(n,o.name,!0)}),this.$TreeRoot.Render(),this.$TreeRoot.Dom},e.prototype.RevokeMethod=function(e){for(var t,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];this.hirented?(t=this.$FenceNode.mvvm).RevokeMethod.apply(t,[e].concat(o)):null!=this.$methods[e]&&this.$methods[e].apply(this,o)},e.prototype.GetExpValue=function(e){return this.$observe.GetValueWithExp(e)},e.prototype.SetValue=function(e,t){for(var o=e.split("."),n=this.$data,r=!0,i=0;i<o.length-1;i++){if(null==n){r=!1;break}n=n[o[i]]}r&&null!=n&&(n[o[o.length-1]]=t)},e.prototype.$emit=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(null!=this.$FenceNode&&null!=this.$FenceNode.mvvm){var n=this.$FenceNode.GetOut(e);r.RevokeEvent(n,t,this.$FenceNode.mvvm)}},e.prototype.$watchExpOrFunc=function(e,t,o,n){this.$observe.AddWatcher(e,t,o,n)},e.prototype.$ondestroy=function(){null!=this.$methods.$destroy&&this.$methods.$destroy(),this.$TreeRoot.OnRemoved()},e.prototype.$checkProp=function(e,t){var o=function(e,t,o){throw new Error("component '"+e+"' prop '"+t+"' not receive "+o)};"array"==e.type&&"[object Array]"!=toString.call(t)&&o(this.$name,e.name,e.type),"object"==e.type&&"[object Object]"!=toString.call(t)&&o(this.$name,e.name,e.type),"number"==e.type&&"[object Number]"!=toString.call(t)&&o(this.$name,e.name,e.type),"boolean"==e.type&&"[object Boolean]"!=toString.call(t)&&o(this.$name,e.name,e.type),"string"==e.type&&"[object String]"!=toString.call(t)&&o(this.$name,e.name,e.type)},e}();o.MVVM=i},{"../observer/observe":12,"./revoke-event":10}],10:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var s=e("../const");o.RevokeEvent=function(e,o,n){if(s.REG_EVENT.test(e)){var t=RegExp.$1,r=RegExp.$2;if(0<r.length){var i=r.split(","),a=[];i.forEach(function(e){if(s.REG_STR.test(e))a.push(RegExp.$2);else{if("true"===e)return void a.push(!0);if("false"===e)return void a.push(!1);if("$event"==e)return void a.push.apply(a,o);var t=new Number(e).valueOf();isNaN(t)?a.push(n.GetExpValue(e)):a.push(t.valueOf())}}),n.RevokeMethod.apply(n,[t].concat(a))}else n.RevokeMethod(t)}}},{"../const":1}],11:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var n=[],r=!1;function i(){var t=[];n.forEach(function(e){return t.push(e)}),n=[],t.forEach(function(e){return e.Update()}),0<n.length&&i()}o.AddWatcher=function(e){-1==n.indexOf(e)&&n.push(e),r||(r=!0,setTimeout(function(){i(),r=!1},0))},o.RevokeWatcher=i},{}],12:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var u=e("./watcher"),n=e("./msg-queue"),r=e("../const"),i=function(){function s(e){this.data=e}return s.prototype.GetValue=function(e){var t;return"string"==typeof(s.target=e).ExpOrFunc&&(t=EvalExp(this.data,e.ExpOrFunc)),"function"==typeof e.ExpOrFunc&&(t=e.ExpOrFunc.call(this.data)),s.target=null,t},s.prototype.GetValueWithExp=function(e){return EvalExp(this.data,e)},s.prototype.AddWatcher=function(e,t,o,n){new u.Watcher(e,t,o,this,n)},s.prototype.ReactiveData=function(o){var n=this;null!=o&&"object"==typeof o&&Object.keys(o).forEach(function(e){var t=new d(e);n.defineReactive(o,e,!1,t),n.ReactiveData(o[e])})},s.prototype.ReactiveKey=function(e,t,o){var n=new d(t);this.defineReactive(e,t,o,n)},s.prototype.reactiveArray=function(a,s){var u=this;a.push==Array.prototype.push&&(Object.defineProperty(a,"push",{enumerable:!1,configurable:!0,value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var o,n=a.length,r=(o=Array.prototype.push).call.apply(o,[a].concat(e)),i=n;i<r;i++)u.ReactiveKey(a,""+i,!1);return s.Notify(),r}}),Object.defineProperty(a,"pop",{enumerable:!1,configurable:!0,value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o,n=(o=Array.prototype.pop).call.apply(o,[a].concat(e));return s.Notify(),n}}),Object.defineProperty(a,"splice",{enumerable:!1,configurable:!0,value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o,n=(o=Array.prototype.splice).call.apply(o,[a].concat(e));2<e.length&&e.slice(2).forEach(function(e){var t=a.indexOf(e);u.ReactiveKey(a,""+t,!1)});return s.Notify(),n}}),Object.defineProperty(a,"shift",{enumerable:!1,configurable:!0,value:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var o,n=(o=Array.prototype.shift).call.apply(o,[a].concat(e));return s.Notify(),n}}))},s.prototype.defineReactive=function(e,t,o,n){var r=this,i=e[t];"[object Array]"==toString.call(i)&&this.reactiveArray(i,n),Object.defineProperty(e,t,{get:function(){return null!=s.target&&n.AddTarget(s.target),i},set:function(e){e!=i&&(i=e,"[object Array]"==toString.call(i)&&r.reactiveArray(i,n),o||r.ReactiveData(e),n.Notify())},enumerable:!0,configurable:!0})},s.prototype.WatchComputed=function(t,e,o){var n,r=this,i=new d(e),a=!0;Object.defineProperty(this.data,e,{get:function(){if(null!=s.target&&i.AddTarget(s.target),a){var e=s.target;s.target=null,new u.Watcher(t,o,function(e){n=e,i.Notify()},r),s.target=e,a=!1}return n},enumerable:!0,configurable:!0})},s}();o.Observe=i;var d=function(){function e(e){this.key=e,this.watches=[]}return e.prototype.GetKey=function(){return this.key},e.prototype.AddTarget=function(e){-1==this.watches.indexOf(e)&&this.watches.push(e)},e.prototype.Notify=function(){this.watches=this.watches.filter(function(e){return e.GetVNode().GetStatus()==r.VNodeStatus.ACTIVE?(n.AddWatcher(e),!0):e.GetVNode().GetStatus()==r.VNodeStatus.INACTIVE||e.GetVNode().GetStatus()!=r.VNodeStatus.DEPRECATED&&void 0})},e}();o.Depender=d},{"../const":1,"./msg-queue":11,"./watcher":13}],13:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var n=e("../const"),r=function(){function e(e,t,o,n,r){if(this.vnode=e,this.ExpOrFunc=t,this.cb=o,this.observer=n,this.deep=r,this.deepRecord=[],this.value=this.observer.GetValue(this),this.deep&&"[object Array]"==toString.call(this.value))for(var i=0;i<this.value.length;i++)this.deepRecord[i]=this.value[i];this.cb(this.value,void 0)}return e.prototype.GetVNode=function(){return this.vnode},e.prototype.Update=function(){var e=this.observer.GetValue(this);if(this.value!=e)this.vnode.GetStatus()==n.VNodeStatus.ACTIVE&&this.cb(e,this.value),this.value=e;else if(this.deep&&"[object Array]"==toString.call(this.value)){for(var t=!1,o=0;o<e.length;o++)if(e[o]!=this.deepRecord[o]){this.cb(e,this.value),t=!0;break}if(t){this.deepRecord=[];for(o=0;o<e.length;o++)this.deepRecord[o]=e[o]}}},e}();o.Watcher=r},{"../const":1}],14:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0}),o.LogError=function(e){console.error(e)},o.LogInfo=function(e){console.log(e)},o.GetNS=function(e){var t=e.split(":");return 1==t.length?{namespace:null,value:t[0]}:2==t.length?{namespace:t[0],value:t[1]}:void 0},o.HttpGet=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),4==t.readyState&&200==t.status?t.responseText:null}},{}],15:[function(s,e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=s("../vnode/vnode"),d=s("../manager/components-manager"),c=s("../mvvm/mvvm"),h=s("../util"),a=function(){function e(){this.Attrs=[],this.Children=[]}return e.prototype.GetAttr=function(e){for(var t=0;t<this.Attrs.length;t++)if(this.Attrs[t].Name==e)return this.Attrs[t].Value;return null},e.prototype.AddAttr=function(e){this.Attrs.push({Name:e,Value:""})},e}();t.VDom=a,t.TraverseDom=function e(t){if(3!=t.nodeType||""!=t.nodeValue.trim()){var o=new a;if(o.NodeValue=t.nodeValue,null!=o.NodeValue&&(o.NodeValue=o.NodeValue.replace(/\s+/g,"")),o.NodeName=t.nodeName,o.NodeType=t.nodeType,1==t.nodeType){for(var n=t,r=0;r<n.attributes.length;r++)o.Attrs.push({Name:n.attributes[r].name,Value:n.attributes[r].value});for(r=0;r<n.childNodes.length;r++){var i=e(n.childNodes[r]);i&&o.Children.push(i)}}return o}},t.NewVNode=function(e,t,o){if("slot"==e.NodeName.toLowerCase())return new(s("../vnode/slot-node").SlotNode)(e,t,o,e.GetAttr("name"));if(null!=e.GetAttr("[for]"))return new(s("../vnode/for-node").ForNode)(e,t,o,e.GetAttr("[for]"));if(null!=e.GetAttr("[if]"))return new(s("../vnode/if-node").IfNode)(e,t,o,e.GetAttr("[if]"));var n=h.GetNS(e.NodeName);if(d.IsComponentRegistered(n.value,n.namespace||"default")){var r=d.GetComponent(n.value,n.namespace||"default"),i=new c.MVVM(r),a=new(s("../vnode/custom-node").CustomNode)(e,t,o,i);return(i.$FenceNode=a).ParseTemplate(),a}return new u.VNode(e,t,o)},t.NewVNodeNoFor=function(e,t,o){if("slot"==e.NodeName.toLowerCase())return new(s("../vnode/slot-node").SlotNode)(e,t,o,e.GetAttr("name"));if(null!=e.GetAttr("[if]"))return new(s("../vnode/if-node").IfNode)(e,t,o,e.GetAttr("[if]"));var n=h.GetNS(e.NodeName);if(d.IsComponentRegistered(n.value,n.namespace||"default")){var r=d.GetComponent(n.value,n.namespace||"default"),i=new c.MVVM(r),a=new(s("../vnode/custom-node").CustomNode)(e,t,o,i);return(i.$FenceNode=a).ParseTemplate(),a}return new u.VNode(e,t,o)},t.NewVNodeNoForNoIf=function(e,t,o){if("slot"==e.NodeName.toLowerCase())return new(s("../vnode/slot-node").SlotNode)(e,t,o,e.GetAttr("name"));var n=h.GetNS(e.NodeName);if(d.IsComponentRegistered(n.value,n.namespace||"default")){var r=d.GetComponent(n.value,n.namespace||"default"),i=new c.MVVM(r),a=new(s("../vnode/custom-node").CustomNode)(e,t,o,i);return(i.$FenceNode=a).ParseTemplate(),a}return new u.VNode(e,t,o)}},{"../manager/components-manager":6,"../mvvm/mvvm":9,"../util":14,"../vnode/custom-node":16,"../vnode/for-node":17,"../vnode/if-node":18,"../vnode/slot-node":19,"../vnode/vnode":21}],16:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var s=e("../manager/components-manager"),u=e("../mvvm/mvvm"),d=e("../util"),c=e("../vdom/vdom"),h=e("./template-node"),p=e("./vnode"),i=function(i){function a(e,t,o,n){var r=i.call(this,e,t,o)||this;return r.Vdom=e,r.mvvm=t,r.Parent=o,r.SurroundMvvm=n,r}return r(a,i),a.prototype.AddIns=function(e,t){this.ins_exp[e]=t},a.prototype.GetTemplate=function(e){for(var t=0;t<this.Children.length;t++){var o=this.Children[t];if(o.templatename==e)return o}return null},a.prototype.Render=function(){this.Dom=this.SurroundMvvm.Render(),this.Dom&&this.Parent&&this.Parent.Dom&&this.Parent.Dom.appendChild(this.Dom)},a.prototype.childSet=function(){var e=new h.TemplateNode(this.Vdom,this.mvvm?this.mvvm:this.SurroundMvvm,this,"default");e.Parent=this;for(var t={default:e},o=0;o<this.Vdom.Children.length;o++){var n=this.Vdom.Children[o],r=this.Vdom.GetAttr("slot");null!=r&&""!=r||(r="default"),null==t[r]&&(t[r]=new h.TemplateNode(this.Vdom,this.mvvm?this.mvvm:this.SurroundMvvm,this,r),t[r].Parent=this);var i=c.NewVNode(n,t[r].mvvm,t[r]);i.AttachDom(),t[r].Children.push(i)}for(var a in t)this.Children.push(t[a])},a.prototype.ParseTemplate=function(){var e=this.SurroundMvvm.GetDomTree(),t=d.GetNS(e.NodeName);if(s.IsComponentRegistered(t.value,t.namespace||this.SurroundMvvm.$Namespace)){var o=s.GetComponent(t.value,t.namespace||this.SurroundMvvm.$Namespace),n=new u.MVVM(o),r=new a(e,this.SurroundMvvm,null,n);this.SurroundMvvm.$TreeRoot=r,n.$FenceNode=this,r.ParseTemplate()}else this.SurroundMvvm.$TreeRoot=new p.VNode(e,this.SurroundMvvm,null);this.SurroundMvvm.$TreeRoot.AttachDom()},a.prototype.GetInValue=function(e){return null!=this.ins_pure[e]?this.ins_pure[e]:null!=this.ins_exp[e]?this.mvvm.GetExpValue(this.ins_exp[e]):null},a.prototype.GetIn=function(e){return this.ins_pure[e]||this.ins_exp[e]},a.prototype.GetOut=function(e){return this.outs[e]},a.prototype.Refresh=function(){this.SurroundMvvm.$TreeRoot.Refresh()},a.prototype.Update=function(){this.SurroundMvvm.$TreeRoot.Update()},a.prototype.testOutput=function(e){return-1!=this.SurroundMvvm.$Outs.indexOf(e)},a.prototype.testInput=function(t){return this.SurroundMvvm.$Ins.some(function(e){return e.name==t})},a.prototype.OnRemoved=function(){this.SurroundMvvm.$ondestroy()},a.prototype.SetStatus=function(e){this.status=e,this.SurroundMvvm.$TreeRoot.SetStatus(e)},a}(p.VNode);o.CustomNode=i},{"../manager/components-manager":6,"../mvvm/mvvm":9,"../util":14,"../vdom/vdom":15,"./template-node":20,"./vnode":21}],17:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var s=e("../models"),i=e("../mvvm/mvvm"),u=e("../vdom/vdom"),d=e("./custom-node"),a=e("./vnode"),c=e("../const"),h=function(a){function e(e,t,o,n){var r=a.call(this,e,t,o)||this;r.Vdom=e,r.mvvm=t,r.Parent=o,r.originForExp=n,r.dynamicVNodes=[],r.IsTemplate=!0;var i=r.originForExp.trim().split(/\s+/);return r.ForExp=new s.ForExp(i[0],i[2]),r}return r(e,a),e.prototype.newCopyNode=function(e){var t=this.ForExp.itemExp,o=new i.MVVM({props:[{name:t,required:!0}]});o.SetHirented(!0);var n=new d.CustomNode(this.Vdom,this.mvvm,null,o);return(o.$FenceNode=n).IsCopy=!0,n.AddIns(t,this.ForExp.arrayExp+"["+e+"]"),n},e.prototype.reImplementForExp=function(e){var t=this;if(e>this.dynamicVNodes.length){for(var o=[],n=this.dynamicVNodes.length,r=this.dynamicVNodes.length;r<e;r++){var i=this.newCopyNode(r),a=u.NewVNodeNoFor(this.Vdom,i.SurroundMvvm,null);a.AttachDom(),i.SurroundMvvm.$TreeRoot=a,o.push(i)}return o.forEach(function(e){t.dynamicVNodes.push(e),e.Render()}),this.Parent.AddChildren(this,o,n),void this.Parent.Refresh()}if(e<this.dynamicVNodes.length){var s=this.dynamicVNodes.splice(e);s.forEach(function(e){return e.SetStatus(c.VNodeStatus.DEPRECATED)}),this.Parent.RemoveChildren(s),s.forEach(function(e){e.OnRemoved()}),this.Parent.Refresh()}},e.prototype.Update=function(){var e=this.mvvm.GetExpValue(this.ForExp.arrayExp);"[object Array]"===toString.call(e)&&this.reImplementForExp(e.length)},e.prototype.AttachDom=function(){},e.prototype.Render=function(){this.mvvm.$watchExpOrFunc(this,this.ForExp.arrayExp+".length",this.reImplementForExp.bind(this))},e.prototype.OnRemoved=function(){this.dynamicVNodes.forEach(function(e){return e.OnRemoved()})},e.prototype.SetStatus=function(t){this.status=t,this.dynamicVNodes.forEach(function(e){return e.SetStatus(t)})},e}(a.VNode);o.ForNode=h},{"../const":1,"../models":8,"../mvvm/mvvm":9,"../vdom/vdom":15,"./custom-node":16,"./vnode":21}],18:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=e("./vnode"),a=e("../vdom/vdom"),s=e("../const"),u=function(i){function e(e,t,o,n){var r=i.call(this,e,t,o)||this;return r.Vdom=e,r.mvvm=t,r.Parent=o,r.ifExp=n,r.IsTemplate=!0,r}return r(e,i),e.prototype.AttachDom=function(){},e.prototype.Render=function(){var t=this;this.mvvm.$watchExpOrFunc(this,this.ifExp,function(e){return t.reImpletement(e)})},e.prototype.Update=function(){var e=this.mvvm.GetExpValue(this.ifExp);this.reImpletement(e)},e.prototype.reImpletement=function(e){e?(null==this.dynamicVNode?(this.instance(),this.dynamicVNode.Render()):this.dynamicVNode.Update(),null!=this.Parent?(this.Parent.AddChildren(this,[this.dynamicVNode],0),this.Parent.Refresh()):(this.mvvm.$FenceNode.Dom=this.dynamicVNode.Dom,this.mvvm.$FenceNode.Parent.Refresh()),this.dynamicVNode.SetStatus(s.VNodeStatus.ACTIVE)):null!=this.dynamicVNode&&(null!=this.Parent?(this.Parent.RemoveChildren([this.dynamicVNode]),this.Parent.Refresh()):(this.mvvm.$FenceNode.Dom=null,this.mvvm.$FenceNode.Parent.Refresh()),this.dynamicVNode.SetStatus(s.VNodeStatus.INACTIVE))},e.prototype.instance=function(){this.dynamicVNode=a.NewVNodeNoForNoIf(this.Vdom,this.mvvm,null),this.dynamicVNode.IsCopy=!0,this.dynamicVNode.AttachDom()},e.prototype.OnRemoved=function(){null!=this.dynamicVNode&&this.dynamicVNode.OnRemoved()},e.prototype.SetStatus=function(e){this.status=e,null!=this.dynamicVNode&&this.dynamicVNode.SetStatus(e)},e}(i.VNode);o.IfNode=u},{"../const":1,"../vdom/vdom":15,"./vnode":21}],19:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(i){function e(e,t,o,n){var r=i.call(this,e,t,o)||this;return r.vdom=e,r.mvvm=t,r.Parent=o,r.name=n,null!=r.name&&""!=r.name||(r.name="default"),r}return r(e,i),e.prototype.Render=function(){var e=this.mvvm.$FenceNode.GetTemplate(this.name);if(null!=e)for(e.Render(),this.Dom=e.Dom;null!=this.Dom.firstChild;)this.Parent.Dom.appendChild(this.Dom.firstChild);return null},e.prototype.Update=function(){var e=this.mvvm.$FenceNode.GetTemplate(this.name);null!=e&&e.Update()},e.prototype.SetStatus=function(e){this.status=e,this.mvvm.$FenceNode.GetTemplate(this.name).SetStatus(e)},e.prototype.OnRemoved=function(){this.mvvm.$FenceNode.GetTemplate(this.name).OnRemoved()},e}(e("./vnode").VNode);o.SlotNode=i},{"./vnode":21}],20:[function(e,t,o){var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(i){function e(e,t,o,n){var r=i.call(this,e,t,o)||this;return r.vdom=e,r.mvvm=t,r.Parent=o,r.templatename=n,r}return r(e,i),e.prototype.Render=function(){this.Dom=document.createElement("div"),this.Children.forEach(function(e){e.Render()})},e.prototype.Update=function(){var t=[];this.Children.forEach(function(e){t.push(e)}),t.forEach(function(e){e.Update()})},e}(e("./vnode").VNode);o.TemplateNode=i},{"./vnode":21}],21:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0});var r=e("./../const"),i=e("../const"),a=e("../directive/dir-handler"),n=e("../vdom/vdom"),s=e("../util"),u=function(){function e(e,t,o){this.Vdom=e,this.mvvm=t,this.Parent=o,this.Attrs=[],this.Children=[],this.IsTemplate=!1,this.IsCopy=!1,this.ins_pure={},this.ins_exp={},this.outs={},this.status=r.VNodeStatus.ACTIVE}return e.prototype.AddProperty=function(e,t){if(t=t.trim(),r.REG_IN.test(e)){var o=RegExp.$1;if("for"==o||"if"==o)return;return this.testInput(o)?void(r.REG_STR.test(t)?this.ins_pure[o]=RegExp.$2:this.ins_exp[o]=t):void s.LogError("prop "+o+" not exist on "+this.NodeName)}if(r.REG_OUT.test(e))return this.testOutput(RegExp.$1)?void(this.outs[RegExp.$1]=t):void s.LogError("event "+RegExp.$1+" not exist on "+this.NodeName);r.REG_ATTR.test(e)&&this.Attrs.push({name:e,value:t})},e.prototype.GetOutput=function(){return this.outs},e.prototype.GetInput=function(){return this.ins_exp},e.prototype.testOutput=function(e){return r.REG_TEST_OUTPUT.test(e)},e.prototype.testInput=function(e){return r.REG_TEST_INPUT.test(e)},e.prototype.Render=function(){var o=this;if(1==this.NodeType){var t=document.createElement(this.NodeName);this.Attrs.forEach(function(e){t.setAttribute(e.name,e.value)}),this.Dom=t;var n=[];this.Children.forEach(function(e){e.IsCopy||n.push(e)}),n.forEach(function(e){e.Render()}),a.DirectiveBind(this)}if(3==this.NodeType)if(this.Dom=document.createTextNode(this.NodeValue),i.REG_SINGLE.test(this.NodeValue))this.mvvm.$watchExpOrFunc(this,RegExp.$1,function(e,t){o.Dom.textContent=e});else if(r.REG_MULTI.test(this.NodeValue)){var e=this.multiBindParse(this.NodeValue);this.mvvm.$watchExpOrFunc(this,e,function(e,t){o.Dom.textContent=e})}else this.Dom.textContent=this.NodeValue;this.Parent&&this.Parent.Dom&&this.Parent.Dom.appendChild(this.Dom)},e.prototype.multiBindParse=function(e){for(var t=/\{\{([^\{\}]*)\}\}/g,o=t.exec(e),n="",r=0;o;)o.index!=r&&(n+="'"+e.substring(r,o.index)+"'+"),r=o.index+o[0].length,n+="("+RegExp.$1+")+",o=t.exec(e);return n.lastIndexOf("+")==n.length-1&&(n=n.substring(0,n.length-1)),n},e.prototype.Update=function(){if(1==this.NodeType){var t=[];return this.Children.forEach(function(e){t.push(e)}),void t.forEach(function(e){e.Update()})}if(3==this.NodeType)if(i.REG_SINGLE.test(this.NodeValue))this.Dom.textContent=this.mvvm.GetExpValue(RegExp.$1);else if(r.REG_MULTI.test(this.NodeValue)){var e=this.multiBindParse(this.NodeValue);this.Dom.textContent=this.mvvm.GetExpValue(e)}else this.Dom.textContent=this.NodeValue},e.prototype.Refresh=function(){var t=this;if(!this.IsTemplate){var e=this.Dom.childNodes,o=[];this.Children.forEach(function(e){e.IsTemplate||null==e.Dom||(o=o.concat(e))});for(var n={old_j:-1,i:0,j:0},r=[];!(n.i>e.length-1);)if(n.j>o.length-1)r.push({type:"remove",node:e[n.i]}),n.i++,n.j=n.old_j+1;else if(e[n.i]==o[n.j].Dom)if(e[n.i]!=o[n.j].Dom);else{if(n.i<n.j)for(var i=n.old_j+1;i<n.j;)r.push({type:"add",beforeNode:e[n.i],node:o[i].Dom}),i++;n.old_j=n.j,n.i++,n.j++}else n.j++;for(;n.j<o.length;)r.push({type:"add",beforeNode:null,node:o[n.j].Dom}),n.j++;r.forEach(function(e){"add"==e.type&&(null!=e.beforeNode?t.Dom.insertBefore(e.node,e.beforeNode):t.Dom.appendChild(e.node)),"remove"==e.type&&e.node.remove()})}},e.prototype.AddChildren=function(e,t,o){for(var n=0;n<this.Children.length;n++)if(this.Children[n]==e){(r=this.Children).splice.apply(r,[n+1+o,0].concat(t));break}var r},e.prototype.RemoveChildren=function(t){this.Children=this.Children.filter(function(e){return-1==t.indexOf(e)})},e.prototype.OnRemoved=function(){this.Children.forEach(function(e){e.IsCopy||e.OnRemoved()})},e.prototype.basicSet=function(){this.NodeValue=this.Vdom.NodeValue,this.NodeName=this.Vdom.NodeName,this.NodeType=this.Vdom.NodeType;for(var e=0;e<this.Vdom.Attrs.length;e++)this.AddProperty(this.Vdom.Attrs[e].Name,this.Vdom.Attrs[e].Value)},e.prototype.childSet=function(){for(var e=0;e<this.Vdom.Children.length;e++){var t=this.Vdom.Children[e],o=n.NewVNode(t,this.mvvm,this);null!=o&&(o.AttachDom(),this.Children.push(o))}},e.prototype.AttachDom=function(){this.basicSet(),this.childSet()},e.prototype.SetStatus=function(t){this.status=t,this.Children.forEach(function(e){e.IsCopy||e.SetStatus(t)})},e.prototype.GetStatus=function(){return this.status},e}();o.VNode=u},{"../const":1,"../directive/dir-handler":2,"../util":14,"../vdom/vdom":15,"./../const":1}]},{},[5]);var EvalExp=function(context,exp){var res;with(context)res=eval(exp);return res};