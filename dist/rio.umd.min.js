!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Rio=e():t.Rio=e()}(window,function(){return function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=41)}([function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.DIR_MODEL="model",e.DIR_EVENT_CLICK="click",e.ANCHOR="ref",e.PRE="r-",e.REG_SINGLE=/^\{\{([^\{\}]*)\}\}$/,e.REG_MULTI=/\{\{(.*?)\}\}/,e.REG_EVENT=/^(\w+)\((.*)\)$/,e.REG_STR=/^(['"])(.*?)\1$/,e.REG_MID_STR=/(['"])(.*?)\1/,e.REG_IN=/^\[(\w+)\]$/,e.REG_OUT=/^\((\w+)\)$/,e.REG_ATTR=/^[A-z_][\w\-]*$/,e.REG_TEST_OUTPUT=/^((click))$/,function(t){t[t.ACTIVE=0]="ACTIVE",t[t.INACTIVE=1]="INACTIVE",t[t.DEPRECATED=2]="DEPRECATED"}(e.VNodeStatus||(e.VNodeStatus={})),function(t){t[t.CONSTANT=0]="CONSTANT",t[t.NEW=1]="NEW",t[t.DELETE=2]="DELETE"}(e.DomType||(e.DomType={}))},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(0);e.LogError=function(t){console.error(t)},e.LogInfo=function(t){console.log(t)},e.GetNS=function(t){var e=t.split(":");return 1==e.length?{namespace:null,value:e[0]}:{namespace:e[0],value:e.slice(1).join(":")}},e.HttpGet=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),4==e.readyState&&200==e.status?e.responseText:null},e.IsStringEmpty=function(t){return null==t||""==(t=t.trim())},e.Trim=function(t,e,n){if(void 0===n&&(n="both"),e.length>1)throw new Error("only receve one character");var o=-1;if("both"==n||"left"==n)for(;t[o+1]==e;)o++;var r=t.length;if("both"==n||"right"==n)for(;t[r-1]==e;)r--;return t.substring(o+1,r)},e.StrToEvalstr=function(t){if(o.REG_SINGLE.test(t))return{isconst:!1,exp:RegExp.$1};if(o.REG_MULTI.test(t)){for(var e=/\{\{([^\{\}]*)\}\}/g,n=e.exec(t),r="",i=0;n;)n.index!=i&&(r+="'"+t.substring(i,n.index)+"'+"),i=n.index+n[0].length,r+="("+RegExp.$1+")+",n=e.exec(t);return i!=t.length&&(r+="'"+t.substr(i)+"'"),r.endsWith("+")&&(r=r.substring(0,r.length-1)),{isconst:!1,exp:r}}return{isconst:!0,exp:t}},e.InsertDomChild=function(t,e,n){null==n?null!=t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e):null!=n.nextSibling?t.insertBefore(e,n.nextSibling):t.appendChild(e)},e.TypeOf=function(t){if("[object Boolean]"==toString.call(t))return"boolean";if("[object Array]"==toString.call(t))return"array";if("[object Number]"==toString.call(t))return"number";if("[object Object]"==toString.call(t))return"object";if("[object Null]"==toString.call(t))return"object";if("[object String]"==toString.call(t))return"string";if("[object Undefined]"==toString.call(t))throw new Error("function TypeOf: undefined is not allowed")},e.ParseStyle=function(t){var e={};return(t=(t=t.substr(1)).substr(0,t.length-1)).split(",").forEach(function(t){var n=t.indexOf(":"),r=t.substr(0,n);o.REG_STR.test(r)&&(r=RegExp.$2),e[r]=t.substr(n+1)}),e}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(0),i=function(){function t(t,e,n){this.Vdom=t,this.mvvm=e,this.Parent=n,this.Children=[],this.DomSet=[],this.status=r.VNodeStatus.ACTIVE,null!=this.Vdom&&(this.nodeValue=this.Vdom.NodeValue,this.nodeName=this.Vdom.NodeName,this.nodeType=this.Vdom.NodeType)}return t.prototype.Reflow=function(){var t=this;this.DomSet=[],this.Children.forEach(function(e){t.DomSet=t.DomSet.concat(e.DomSet)}),null!=this.Parent&&this.Parent.Reflow()},t.prototype.Refresh=function(){this.DomSet=this.DomSet.filter(function(t){return t.type!=r.DomType.DELETE}),this.Children.forEach(function(t){return t.Refresh()})},t.prototype.OnDestroy=function(){this.Children.forEach(function(t){t.OnDestroy()})},t.prototype.AttachChildren=function(){for(var t=0;t<this.Vdom.Children.length;t++){var e=this.Vdom.Children[t],n=o.NewVNode(e,this.mvvm,this);null!=n&&(n.AttachChildren(),this.Children.push(n))}},t.prototype.SetStatus=function(t){this.status=t,this.Children.forEach(function(e){e.SetStatus(t)})},t.prototype.GetStatus=function(){return this.status},t.prototype.OnRouterChange=function(){this.Children.forEach(function(t){return t.OnRouterChange()})},t.prototype.GetNodeName=function(){return this.nodeName.toLowerCase()},t.prototype.GetAnchor=function(t){for(var e=0;e<this.Children.length;e++){var n=this.Children[e].GetAnchor(t);if(null!=n)return n}return null},t}();e.VNode=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o,r=n(9),i=n(1),a=n(0),u=n(39),s=function(){function t(){this.Attrs=[],this.Children=[]}return t.prototype.GetAttr=function(t){for(var e=0;e<this.Attrs.length;e++)if(this.Attrs[e].Name==t)return this.Attrs[e].Value;return null},t.prototype.AddAttr=function(t,e){void 0===e&&(e=""),this.Attrs.push({Name:t,Value:e})},t}();e.VDom=s,e.TraverseDom=function t(e){if(3!=e.nodeType||""!=e.nodeValue.trim()){var n=new s;if(n.NodeValue=e.nodeValue,null!=n.NodeValue&&(n.NodeValue=n.NodeValue.trim().replace(/\s+/g," ")),n.NodeName=e.nodeName.toLowerCase(),n.NodeType=e.nodeType,1==e.nodeType){for(var o=e,r=0;r<o.attributes.length;r++)n.Attrs.push({Name:o.attributes[r].name,Value:o.attributes[r].value});for(r=0;r<o.childNodes.length;r++){var i=t(o.childNodes[r]);i&&n.Children.push(i)}}return n}},function(t){t[t.NORMAL=0]="NORMAL",t[t.IF=1]="IF",t[t.FOR=2]="FOR"}(o=e.Priority||(e.Priority={})),e.NewVNode=function(t,e,s,c){if(void 0===c&&(c=o.FOR),"slot"==t.NodeName.toLowerCase())return new(0,n(31).SlotNode)(t,e,s,t.GetAttr("name"));if(c>=o.FOR&&null!=t.GetAttr(a.PRE+"for"))return new(0,n(30).ForNode)(t,e,s,t.GetAttr(a.PRE+"for"));if(c>=o.IF&&null!=t.GetAttr(a.PRE+"if"))return new(0,n(26).IfNode)(t,e,s,t.GetAttr(a.PRE+"if"));if("r-template"==t.NodeName)return new(0,n(25).TemplateNode)(t,e,s);if("router-view"==t.NodeName)return new(0,n(24).RouterNode)(t,e,s,t.GetAttr("name"));var p=i.GetNS(t.NodeName);if(r.IsComponentRegistered(p.value,p.namespace||"default")){var l=new(r.InitComponent(p.value,p.namespace||"default")),h=new(0,n(11).CustomNode)(t,e,s,l);return l.$SetFenceNode(h),l.$initialize(),l.$AttachChildren(),h}return new u.VinallaNode(t,e,s)}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=[],o=[],r=[],i=[],a=[],u=[];e.Reactive=function(t,e){n.push(e)},e.Computed=function(t,e,n){o.push({name:e,get:n.get})},e.Prop=function(t,e,n){return function(o,i){r.push({name:t,required:e,type:n,origin:i})}},e.OnInit=function(t,e,n){i.push(e)},e.OnMount=function(t,e,n){a.push(e)},e.OnDestroy=function(t,e,n){u.push(e)},e.FetchProperty=function(){var t={computes:o,props:r,initFuncs:i,mountFuncs:a,destroyFuncs:u,datas:n};return o=[],r=[],i=[],a=[],u=[],n=[],t}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(16),r=n(10),i=n(1),a=[],u=[],s=0,c=null;function p(t){for(var e=location.pathname,n=(e=i.Trim(e,"/","right")).split("/"),o=t.fullUrl.split("/"),r=[],a=0;a<o.length;a++){if(n.length-1<a)return{matchtype:2,params:[]};if(/^\:(\w+)$/.test(o[a])){var u=RegExp.$1;r.push({name:u,value:n[a]})}else if(o[a]!=n[a])return{matchtype:2,params:[]}}var s=t.params,c=function(){var t=location.search.split("?"),e=[];if(2==t.length){var n=t[1].split("&");n.forEach(function(t){var n=t.split("=");2==n.length&&e.push({name:n[0],value:n[1]})})}return e}();return r=r.concat(c),s.forEach(function(t){if(null==r.find(function(e){return e.name==t.name})&&t.required)throw new Error("router match failed,no matched params:"+t.name)}),a==n.length?{matchtype:0,params:r}:{matchtype:1,params:r}}e.RegisterRouter=function(t){!function t(e){e.forEach(function(e){if(e.children=e.children?e.children:[],null!=e.url&&(e.url=i.Trim(e.url.trim(),"/","right")),null==e.redirect&&(null==e.url||""==e.url))throw new Error("must specify url in router");e.params=e.params?e.params:[],null==e.redirect&&0!=e.url.indexOf("/")&&(e.url="/"+e.url),t(e.children)})}(t),t.forEach(function(t){u.push(function t(e,n){var o={url:n.url,component:n.component,components:n.components,children:[],parent:e,fullUrl:"",params:n.params,redirect:n.redirect};null!=e?null!=n.redirect?o.redirect=e.fullUrl+n.redirect:o.fullUrl=e.fullUrl+n.url:o.fullUrl=n.url;for(var r=0;r<n.children.length;r++)o.children.push(t(o,n.children[r]));return o}(null,t))})};var l=0;function h(t){if(l>10)throw new Error("circular router match");null==t&&(t=u),t==u&&(l++,a=[]);for(var e=0;e<t.length;e++){var n=t[e];if(null!=n.redirect)return o.SetActiveRouter(location.pathname,[]),window.history.replaceState(null,"",n.redirect),h(u),!0;var r=p(n);if(2!=r.matchtype)if(1!=r.matchtype){if(0==r.matchtype)return o.SetActiveRouter(location.pathname,r.params),null==n.component&&null==n.components||a.push(n),!0}else if(null==n.component&&null==n.components||a.push(n),h(n.children))return!0}return!1}e.StartMatchUrl=h,e.NextRouter=function(t,e){if(null==u)throw new Error("no router specified");if(0==s&&(c=t),s<a.length){var n=e?a[s].components[e]:a[s].component;if(null==n)throw new Error("component in router be null?");return s++,n}return i.LogError("router match wrong"),null},e.MoveBack=function(){s--},e.NotifyUrlChange=function(){if(l=0,!h())throw new Error("no matched router");c.OnRouterChange(),r.RefreshApp()}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(12),i=function(){function t(t,e,n,o,r){if(this.mvvm=t,this.vnode=e,this.ExpOrFunc=n,this.cb=o,this.watchingArrayItem=r,this.deepRecord=[],this.value=this.getValue(),this.watchingArrayItem&&"[object Array]"==toString.call(this.value))for(var i=0;i<this.value.length;i++)this.deepRecord[i]=this.value[i]}return t.prototype.getValue=function(){r.SetTarget(this);var t=this.mvvm.$GetExpOrFunValue(this.ExpOrFunc);return r.CleanTarget(),t},t.prototype.GetCurValue=function(){return this.value},t.prototype.GetVNode=function(){return this.vnode},t.prototype.Update=function(){if(this.vnode.GetStatus()==o.VNodeStatus.ACTIVE){var t=this.getValue();if(this.value!=t)this.cb(t,this.value),this.value=t;else if(this.watchingArrayItem&&"[object Array]"==toString.call(this.value)){for(var e=!1,n=0;n<t.length;n++)if(t[n]!=this.deepRecord[n]){this.cb(t,this.value),e=!0;break}if(e){this.deepRecord=[];for(n=0;n<t.length;n++)this.deepRecord[n]=t[n]}}}},t}();e.Watcher=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(13),r=n(8),i=n(12),a=n(6),u=n(16),s=n(3),c=n(5),p=function(){function t(){this.$data={},this.$namespace="default",this.$dataItems=[],this.$computeItems=[],this.$isroot=!1}return Object.defineProperty(t.prototype,"$router",{get:function(){return u.GetActiveRouter()},enumerable:!0,configurable:!0}),t.prototype.$initialize=function(){var t=this;this.$dataItems=this.$InitDataItems(),this.$computeItems=this.$InitComputeItems(),this.$treeRoot=this.$InitTreeroot(),this.$namespace=this.$InitNamespace(),this.$dataItems.forEach(function(e){t.$data[e.name]=e.value,Object.defineProperty(t,e.name,{get:function(){return t.$data[e.name]},set:function(n){t.$data[e.name]=n}})}),i.ReactiveData(this.$data),this.$computeItems.forEach(function(e){i.ReactiveComputed(t,t.$treeRoot,e.name,e.get)})},t.prototype.$AttachChildren=function(){this.$treeRoot.AttachChildren()},t.prototype.$GetExpOrFunValue=function(t){var e;return"string"==typeof t&&(e=r.EvalExp(this,t)),"function"==typeof t&&(e=t.call(this)),e},t.prototype.$ExtendMvvm=function(){return this},t.prototype.$SetValue=function(t,e){for(var n=t.split("."),o=this.$data,r=!0,i=0;i<n.length-1;i++){if(null==o){r=!1;break}o=o[n[i]]}r&&null!=o&&(o[n[n.length-1]]=e)},t.prototype.$CreateWatcher=function(t,e,n,o){return new a.Watcher(this,t,e,n,o)},t.prototype.$Watch=function(t,e,n){void 0===n&&(n=!1),this.$CreateWatcher(this.$treeRoot,t,e,n)},t.prototype.$OnDestroy=function(){this.$treeRoot.OnDestroy()},t.prototype.$SetRoot=function(t){this.$isroot=t},t.prototype.$IsRoot=function(){return this.$isroot},t.prototype.$GetDataItems=function(){return this.$dataItems},t.prototype.$GetComputedItems=function(){return this.$computeItems},t.prototype.$Refresh=function(){this.$treeRoot.Refresh()},t.prototype.$RevokeMethod=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if("function"!=typeof this[t])throw new Error(t+" is not a function");this[t].apply(this,e)},t.prototype.$AddReactiveData=function(t,e){var n=this;this.$data[t]=e,Object.defineProperty(this,t,{get:function(){return n.$data[t]},set:function(e){n.$data[t]=e}}),i.ReactiveKey(this.$data,t),i.ReactiveData(e)},t.prototype.getAnchorNode=function(t){return this.$treeRoot.GetAnchor(t)},t.prototype.GetRef=function(t){var e=this.$treeRoot.GetAnchor(t);return null!=e&&e.DomSet.length>0?e.DomSet[0].dom:null},t.prototype.$AddFragment=function(t,e){var n=(new DOMParser).parseFromString(t,"text/html").body,o=this.getAnchorNode(e);if(!o)throw new Error("anchor node "+e+" not exist");for(var r=0;r<n.childNodes.length;r++){var i=s.TraverseDom(n.childNodes[r]),a=s.NewVNode(i,this,o);a.AttachChildren(),o.Children.push(a),a.Render()}o.Refresh()},t.prototype.$on=function(t,e){o.RegisterNotice(t,this.$treeRoot,e)},t.prototype.$broadcast=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];o.RevokeNotice.apply(void 0,[t].concat(e))},t.prototype.$onRouterChange=function(t){u.WatchRouterChange(this.$treeRoot,t)},t.prototype.$NavigateTo=function(t){window.history.replaceState(null,null,t),c.NotifyUrlChange()},t}();e.Mvvm=p},function(module,exports){var EvalExp=function(context,exp,attachObj){var res,newcontext=context;null!=attachObj&&(newcontext=Object.assign(context,$attachObj));try{with(newcontext)res=eval(exp);return res}catch(error){console.error("eval "+exp+" failed"),console.error(error)}return""};exports.EvalExp=EvalExp},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),r=n(3),i={},a=0;function u(t,e){return t+"::"+e}e.ComponentAutoId=function(){for(var t=a++,e="";t>0;)e+="_",t--;return e},e.Id=u,e.RegisterComponent=function(t,e,n,o){var r={$constructor:n,$id:u(e,t),$preProcess:!1,$domtree:null,$origin:o};if(null!=i[r.$id])throw new Error("component "+r.$id+" already exists");i[r.$id]=r},e.RegisterComponentDirect=function(t){if(null!=i[t.$id])throw new Error("component "+t.$id+" has already exist");i[t.$id]=t},e.InitComponent=function(t,e){t=t.toLowerCase(),e=e.toLowerCase();var n=i[u(e,t)];if(n&&!n.$preProcess&&(function(t){if(null==t.$origin.templateUrl||(t.$origin.template=o.HttpGet(t.$origin.templateUrl),null!=t.$origin.template)){var e=(new DOMParser).parseFromString(t.$origin.template,"text/html").body;if(e.children.length>1)throw new Error(t.$origin.name+"::"+t.$origin.namespace+" template should have only one root");if(1==e.children.length)t.$domtree=r.TraverseDom(e.children[0]);else{if(1!=e.childNodes.length)throw new Error("template should not be empty");t.$domtree=r.TraverseDom(e.childNodes[0])}if(null!=t.$origin.styleUrl&&(t.$origin.style=o.HttpGet(t.$origin.styleUrl)),null!=t.$origin.style){var n=document.createElement("style");n.type="text/css",n.innerHTML=t.$origin.style,document.getElementsByTagName("head")[0].appendChild(n),function t(e,n){e.AddAttr(n),1==e.NodeType&&e.Children.forEach(function(e){t(e,n)})}(t.$domtree,t.$id)}}else o.LogError("path "+t.$origin.templateUrl+" not found")}(n),n.$preProcess=!0),n)return n.$constructor;throw new Error("component "+u(e,t)+" not exists")},e.GetDomTree=function(t,e){t=t.toLowerCase(),e=e.toLowerCase();var n=i[u(e,t)];return null==n?null:n.$domtree},e.IsComponentRegistered=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),!!i[u(e,t)]}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(17),r=n(5),i=[];e.Start=function(){o.GetApp().forEach(function(t){r.StartMatchUrl();var e=new t;e.$initialize(),e.$AttachChildren(),e.$SetRoot(!0),i.push(e);var n=e.$Render(),o=document.querySelector(e.$InitEl()),a=n.dom;"none"==a.style.display&&(a.style.display=""),o.parentElement.replaceChild(n.dom,o)})},e.RefreshApp=function(){i.forEach(function(t){return t.$Refresh()})}},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(15),u=n(3),s=n(0),c=n(23),p=function(t){function e(e,n,o,r){var a=t.call(this,e,n,o)||this;if(a.Vdom=e,a.mvvm=n,a.Parent=o,a.SurroundMvvm=r,a.ins_pure={},a.ins_exp={},a.outs={},a.styles={},a.classes={},a.Vdom)for(var u=0;u<a.Vdom.Attrs.length;u++){var c=a.Vdom.Attrs[u].Name,p=a.Vdom.Attrs[u].Value;if("style"!=c&&c!=s.PRE+"style")if("class"!=c&&c!=s.PRE+"class"){for(var l=a.SurroundMvvm.$InitIns(),h=0;h<l.length;h++){var f=l[h];if(i.REG_IN.test(c)&&f.name==RegExp.$1){a.ins_exp[RegExp.$1]=p;break}if(f.name==c){a.ins_pure[c]=p;break}}for(var d=a.SurroundMvvm.$InitOuts(),m=0;m<d.length;m++){var v=d[m];if(i.REG_OUT.test(c)&&v.name==RegExp.$1){a.outs[RegExp.$1]=p;break}}}else a.classes[c]=p;else a.styles[c]=p}return a}return r(e,t),e.prototype.AddIns=function(t,e){this.ins_exp[t]=e},e.prototype.GetTemplate=function(t){for(var e=0;e<this.Children.length;e++){var n=this.Children[e];if(n.templatename==t)return n}return null},e.prototype.Render=function(){var t,e=this.SurroundMvvm.$Render();(this.DomSet=[e],null!=this.styles.style)&&this.styles.style.split(";").forEach(function(t){var n=t.split(":");e.dom.style[n[0]]=n[1]});null!=this.styles[s.PRE+"style"]&&a.GetInnerDir(s.PRE+"style")(this.styles[s.PRE+"style"],this);if(null!=this.classes.class){var n=this.classes.class.split(/\s+/);(t=e.dom.classList).add.apply(t,n)}null!=this.classes[s.PRE+"class"]&&a.GetInnerDir(s.PRE+"class")(this.classes[s.PRE+"class"],this);return this.DomSet},e.prototype.AttachChildren=function(){if(null!=this.Vdom){for(var t={default:new c.PlugNode(null,this.mvvm,null,"default")},e=0;e<this.Vdom.Children.length;e++){var n=this.Vdom.Children[e],o=n.GetAttr("slot");null!=o&&""!=o||(o="default"),null==t[o]&&(t[o]=new c.PlugNode(null,this.mvvm,null,o));var r=u.NewVNode(n,t[o].mvvm,t[o]);r.AttachChildren(),t[o].Children.push(r)}for(var i in t)this.Children.push(t[i])}},e.prototype.GetInValue=function(t){return null!=this.ins_pure[t]?this.ins_pure[t]:null!=this.ins_exp[t]?this.mvvm.$GetExpOrFunValue(this.ins_exp[t]):null},e.prototype.GetIn=function(t){return null!=this.ins_pure[t]?{value:this.ins_pure[t],const:!0}:null!=this.ins_exp[t]?{value:this.ins_exp[t],const:!1}:null},e.prototype.GetOut=function(t){return this.outs[t]},e.prototype.Refresh=function(){this.SurroundMvvm.$Refresh()},e.prototype.Update=function(){this.SurroundMvvm.$Update()},e.prototype.OnDestroy=function(){this.SurroundMvvm.$OnDestroy()},e.prototype.SetStatus=function(t){this.status=t,this.SurroundMvvm.$SetStatus(t)},e.prototype.Reflow=function(){},e.prototype.OnRouterChange=function(){this.SurroundMvvm.$OnRouterChange()},e}(n(2).VNode);e.CustomNode=p},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o,r=n(6),i=n(28);function a(t){null!=t&&"object"==typeof t&&Object.keys(t).forEach(function(e){u(t,e),a(t[e])})}function u(t,e){var n=new i.WatcherCollecter(e),r=t[e];"[object Array]"==toString.call(r)&&s(r,n),Object.defineProperty(t,e,{get:function(){return null!=o&&n.AddTarget(o),r},set:function(t){t!=r&&(r=t,"[object Array]"==toString.call(r)&&s(r,n),a(t),n.Notify())},enumerable:!0,configurable:!0})}function s(t,e){t.push==Array.prototype.push&&(Object.defineProperty(t,"push",{enumerable:!1,configurable:!0,value:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];for(var r,i=t.length,a=(r=Array.prototype.push).call.apply(r,[t].concat(n)),s=i;s<a;s++)u(t,""+s);return e.Notify(),a}}),Object.defineProperty(t,"pop",{enumerable:!1,configurable:!0,value:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r,i=(r=Array.prototype.pop).call.apply(r,[t].concat(n));return e.Notify(),i}}),Object.defineProperty(t,"splice",{enumerable:!1,configurable:!0,value:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r,i=(r=Array.prototype.splice).call.apply(r,[t].concat(n));n.length>2&&n.slice(2).forEach(function(e){var n=t.indexOf(e);u(t,""+n)});return e.Notify(),i}}),Object.defineProperty(t,"shift",{enumerable:!1,configurable:!0,value:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r,i=(r=Array.prototype.shift).call.apply(r,[t].concat(n));return e.Notify(),i}}))}e.SetTarget=function(t){o=t},e.CleanTarget=function(){o=null},e.ReactiveData=a,e.ReactiveKey=u,e.ReactiveComputed=function(t,e,n,a){var u,s=new i.WatcherCollecter(n),c=!0;Object.defineProperty(t,n,{get:function(){if(null!=o&&s.AddTarget(o),c){var n=o;o=null;var i=new r.Watcher(t,e,a,function(t){u=t,s.Notify()});u=i.GetCurValue(),o=n,c=!1}return u},enumerable:!0,configurable:!0})}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r={};e.RegisterNotice=function(t,e,n){null==r[t]&&(r[t]=[]),r[t].push({vnode:e,cb:n})},e.RevokeNotice=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];null!=r[t]&&(r[t]=r[t].filter(function(t){return t.vnode.GetStatus()!=o.VNodeStatus.DEPRECATED}),r[t].forEach(function(t){t.vnode.GetStatus()==o.VNodeStatus.ACTIVE&&t.cb.apply(t,e)}))}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),r={};e.RegisterDirective=function(t,e,n){if(null!=r[o.Id(e,t)])throw new Error("directive "+o.Id(e,t)+" already exists");r[o.Id(e,t)]=n},e.GetDirectiveCon=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),r[o.Id(e,t)]},e.IsDirectiveRegistered=function(t,e){return t=t.toLowerCase(),e=e.toLowerCase(),null!=r[o.Id(e,t)]}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(38),i=n(37),a=n(36),u=n(35),s=n(34),c=n(33),p={};function l(t,e){if(null!=p[t])throw new Error("inner directive "+t+" already exists");p[t]=e}e.GetInnerDir=function(t){return p[t]},l(o.PRE+"href",a.Href),l(o.PRE+"model",s.DirModel),l(o.PRE+"on",i.OnEvent),l(o.PRE+"html",u.Html),l(o.PRE+"class",r.Classes),l(o.PRE+"style",c.Style)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=function(){function t(t,e){this.path=t,this.params=e}return t.prototype.getParam=function(t){var e=this.params.find(function(e){return e.name==t});return e&&e.value||null},t}(),i=new r("",[]),a=null,u=[];e.SetActiveRouter=function(t,e){a=i,i=new r(t,e),(u=u.filter(function(t){return t.vnode.GetStatus()!=o.VNodeStatus.DEPRECATED})).forEach(function(t){t.vnode.GetStatus()==o.VNodeStatus.ACTIVE&&t.cb(i,a)})},e.GetActiveRouter=function(){return{active:i,previous:a}},e.WatchRouterChange=function(t,e){u.push({cb:e,vnode:t})}},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=[];e.RegisterApp=function(t){n.push(t)},e.GetApp=function(){return n}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),r=n(13),i=n(6),a=function(){function t(){this.$Ins=[],this.$Outs=[],this.$InitFuncs=[],this.$MountFuncs=[],this.$DestroyFuncs=[]}return t.prototype.$Initialize=function(t,e){var n=this;this.$directive=t,this.$vnode=e,this.$InitFuncs.forEach(function(t){n[t].call(n)})},t.prototype.$OnDestroy=function(){var t=this;this.$DestroyFuncs.forEach(function(e){t[e].call(t)})},t.prototype.$Render=function(){var t=this;this.$Ins.forEach(function(e){var n=t.$directive.GetIn(e.name);if(null==n&&e.required)throw new Error("component '"+t.$Name+"' need prop '"+e.name+"'");null!=n&&(n.const?t[e.origin]=n.value:Object.defineProperty(t,e.origin,{get:function(){var o=t.$vnode.mvvm.$GetExpOrFunValue(n.value);return t.$checkProp(e,o),o}}))}),this.$element=this.$vnode.DomSet[0].dom,this.$MountFuncs.forEach(function(e){t[e].call(t)})},t.prototype.$checkProp=function(t,e){var n=function(t,e,n){throw new Error("component '"+t+"' prop '"+e+"' not receive "+n)};"array"==t.type&&"[object Array]"!=toString.call(e)&&n(this.$Name,t.name,t.type),"object"==t.type&&"[object Object]"!=toString.call(e)&&n(this.$Name,t.name,t.type),"number"==t.type&&"[object Number]"!=toString.call(e)&&n(this.$Name,t.name,t.type),"boolean"==t.type&&"[object Boolean]"!=toString.call(e)&&n(this.$Name,t.name,t.type),"string"==t.type&&"[object String]"!=toString.call(e)&&n(this.$Name,t.name,t.type)},t.prototype.$Watch=function(t,e,n){void 0===n&&(n=!1),new i.Watcher(this,this.$vnode,t,e,n)},t.prototype.$GetExpOrFunValue=function(t){var e;return"string"==typeof t&&(e=o.EvalExp(this,t)),"function"==typeof t&&(e=t.call(this)),e},t.prototype.$on=function(t,e){r.RegisterNotice(t,this.$vnode,e)},t.prototype.$broadcast=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];r.RevokeNotice.apply(void 0,[t].concat(e))},t.prototype.$AddFragment=function(t,e){this.$vnode.mvvm.$AddFragment(t,e)},t}();e.DirectiveMVVM=a},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$el="",e}return r(e,t),e.prototype.$Render=function(){return this.$treeRoot.Render()[0]},e.prototype.$InitNamespace=function(){throw new Error("Method not implemented.")},e.prototype.$InitDataItems=function(){throw new Error("Method not implemented.")},e.prototype.$InitComputeItems=function(){throw new Error("Method not implemented.")},e.prototype.$InitTreeroot=function(){throw new Error("Method not implemented.")},e.prototype.$InitEl=function(){throw new Error("Method not implemented.")},e}(n(7).Mvvm);e.AppMvvm=i},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$name="",e.$ins=[],e.$outs=[],e}return r(e,t),e.prototype.$initialize=function(){var e=this;t.prototype.$initialize.call(this),this.$ins=this.$InitIns(),this.$outs=this.$InitOuts(),this.$name=this.$InitName(),this.$ins.forEach(function(t){var n=e.$fenceNode.GetIn(t.name);if(null==n&&t.required)throw new Error("component '"+e.$name+"' need prop '"+t.name+"'");null!=n&&(n.const?e[t.origin]=n.value:Object.defineProperty(e,t.origin,{get:function(){var o=e.$fenceNode.mvvm.$GetExpOrFunValue(n.value);return e.$checkProp(t,o),o}}))})},e.prototype.$checkProp=function(t,e){var n=function(t,e,n){throw new Error("component '"+t+"' prop '"+e+"' not receive "+n)};"array"==t.type&&"[object Array]"!=toString.call(e)&&n(this.$name,t.name,t.type),"object"==t.type&&"[object Object]"!=toString.call(e)&&n(this.$name,t.name,t.type),"number"==t.type&&"[object Number]"!=toString.call(e)&&n(this.$name,t.name,t.type),"boolean"==t.type&&"[object Boolean]"!=toString.call(e)&&n(this.$name,t.name,t.type),"string"==t.type&&"[object String]"!=toString.call(e)&&n(this.$name,t.name,t.type)},e.prototype.$Render=function(){return this.$treeRoot.Render()[0]},e.prototype.$Update=function(){this.$treeRoot.Update()},e.prototype.$SetStatus=function(t){this.$treeRoot.SetStatus(t)},e.prototype.$Emit=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(null!=this.$fenceNode&&null!=this.$fenceNode.mvvm){var r=this.$outs.find(function(e){return e.name==t});if(null==r)throw new Error("no specified event "+t+" at component "+this.$namespace+"::"+this.$name);if(n.length!=r.paramsType.length)throw new Error("no specified params "+t+" at component "+this.$namespace+"::"+this.$name);for(var a=0;a<r.paramsType.length;a++)if(i.TypeOf(n[a])!=r.paramsType[a])throw new Error("params expected "+r.paramsType[a]+",but received "+toString.call(n[a])+" at component "+this.$namespace+"::"+this.$name);var u=this.$fenceNode.GetOut(t);(e=this.$fenceNode.mvvm).$RevokeMethod.apply(e,[u].concat(n))}},e.prototype.$OnRouterChange=function(){this.$treeRoot.OnRouterChange()},e.prototype.$GetFenceNode=function(){return this.$fenceNode},e.prototype.$SetFenceNode=function(t){this.$fenceNode=t},e.prototype.$InitNamespace=function(){throw new Error("Method not implemented.")},e.prototype.$InitDataItems=function(){throw new Error("Method not implemented.")},e.prototype.$InitComputeItems=function(){throw new Error("Method not implemented.")},e.prototype.$InitName=function(){throw new Error("Method not implemented.")},e.prototype.$InitIns=function(){throw new Error("Method not implemented.")},e.prototype.$InitOuts=function(){throw new Error("Method not implemented.")},e.prototype.$InitTreeroot=function(){throw new Error("Method not implemented.")},e.prototype.$GetIns=function(){return this.$ins},e}(n(7).Mvvm);e.ComponentMvvm=a},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(14),a=n(4);e.Directive=function(t){!function(t){t.events=t.events?t.events:[],t.namespace=t.namespace?t.namespace:"default"}(t);var e=a.FetchProperty();return function(n){var o=function(n){function o(){var o=null!==n&&n.apply(this,arguments)||this;return o.$Name=t.name,o.$Namespace=t.namespace,o.$Ins=e.props,o.$Out=t.events,o.$InitFuncs=e.initFuncs,o.$MountFuncs=e.mountFuncs,o.$DestroyFuncs=e.destroyFuncs,o}return r(o,n),o}(n);i.RegisterDirective(t.name,t.namespace,o)}}},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(17),a=n(3),u=n(4);e.App=function(t){!function(t){t.namespace=t.namespace?t.namespace:"default"}(t);var e=u.FetchProperty();return function(n){var o=function(n){function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.$InitFuncs=e.initFuncs,t.$MountFuncs=e.mountFuncs,t.$DestroyFuncs=e.destroyFuncs,t}return r(o,n),o.prototype.$initialize=function(){var t=this;n.prototype.$initialize.call(this),this.$InitFuncs.forEach(function(e){t[e].call(t)})},o.prototype.$Render=function(){var t=this,e=n.prototype.$Render.call(this);return this.$MountFuncs.forEach(function(e){t[e].call(t)}),e},o.prototype.$OnDestroy=function(){var t=this;n.prototype.$OnDestroy.call(this),this.$DestroyFuncs.forEach(function(e){t[e].call(t)})},o.prototype.$InitTreeroot=function(){var e=document.querySelector(t.el);if(null==e)throw new Error("no specified element "+t.el);var n=a.TraverseDom(e);return a.NewVNode(n,this,null)},o.prototype.$InitNamespace=function(){return t.namespace},o.prototype.$InitDataItems=function(){var t=this,n=[];return e.datas.forEach(function(e){n.push({name:e,value:t[e]})}),n},o.prototype.$InitComputeItems=function(){return e.computes},o.prototype.$InitEl=function(){return t.el},o}(n);i.RegisterApp(o)}}},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e,n,o,r){var i=t.call(this,e,n,o)||this;return i.vdom=e,i.mvvm=n,i.Parent=o,i.templatename=r,i}return r(e,t),e.prototype.Render=function(){var t=this;return this.Children.forEach(function(e){var n=e.Render();t.DomSet=t.DomSet.concat(n)}),this.DomSet},e.prototype.Update=function(){var t=[];this.Children.forEach(function(e){t.push(e)}),t.forEach(function(t){t.Update()})},e}(n(2).VNode);e.PlugNode=i},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(5),a=n(0),u=n(11),s=function(t){function e(e,n,o,r){var i=t.call(this,e,n,o)||this;return i.Vdom=e,i.mvvm=n,i.Parent=o,i.routername=r,i.lastConstructor=null,i}return r(e,t),e.prototype.Render=function(){var t=i.NextRouter(this,this.routername);if(this.lastConstructor=t,null!=t){var e=this.instance(t);this.Children=[e],this.DomSet=e.Render(),i.MoveBack()}return this.DomSet},e.prototype.OnRouterChange=function(){var t=i.NextRouter(this,this.routername);if(this.lastConstructor!=t)if(this.lastConstructor=t,this.Children.forEach(function(t){t.SetStatus(a.VNodeStatus.DEPRECATED),t.OnDestroy()}),null!=t){var e=this.instance(t);this.Children=[e],this.DomSet.forEach(function(t){return t.type=a.DomType.DELETE}),this.DomSet=this.DomSet.concat(e.Render()),this.Parent.Reflow(),i.MoveBack()}else this.Children=[],this.DomSet.forEach(function(t){t.type=a.DomType.DELETE});else this.Children.forEach(function(t){return t.OnRouterChange()}),i.MoveBack()},e.prototype.instance=function(t){var e=new t,n=new u.CustomNode(null,this.mvvm,null,e);return e.$SetFenceNode(n),e.$initialize(),e.$AttachChildren(),n},e.prototype.Update=function(){},e.prototype.Reflow=function(){},e}(n(2).VNode);e.RouterNode=s},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.Render=function(){var t=this;return this.Children.forEach(function(e){t.DomSet=t.DomSet.concat(e.Render())}),this.DomSet},e.prototype.Update=function(){},e}(n(2).VNode);e.TemplateNode=i},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(2),u=n(3),s=n(0),c=function(t){function e(e,n,o,r){var i=t.call(this,e,n,o)||this;return i.Vdom=e,i.mvvm=n,i.Parent=o,i.ifExp=r,i}return r(e,t),e.prototype.AttachChildren=function(){if(this.mvvm.$GetExpOrFunValue(this.ifExp)){var t=u.NewVNode(this.Vdom,this.mvvm,null,u.Priority.NORMAL);t.AttachChildren(),this.Children=[t]}},e.prototype.Render=function(){var t=this;return this.Children.forEach(function(e){t.DomSet=t.DomSet.concat(e.Render())}),this.mvvm.$CreateWatcher(this,this.ifExp,function(e){return t.reImpletement(e)}),this.DomSet},e.prototype.Update=function(){var t=this.mvvm.$GetExpOrFunValue(this.ifExp);this.reImpletement(t)},e.prototype.reImpletement=function(t){var e=this;if(t){var n=u.NewVNode(this.Vdom,this.mvvm,null,u.Priority.NORMAL);n.AttachChildren(),this.Children=[n],this.Children.forEach(function(t){e.DomSet=e.DomSet.concat(t.Render())}),this.Parent.Reflow()}else this.Children.forEach(function(t){t.SetStatus(s.VNodeStatus.DEPRECATED),t.OnDestroy()}),this.Children=[],this.DomSet.forEach(function(t){t.type=i.DomType.DELETE})},e.prototype.OnDestroy=function(){this.Children.length>0&&this.Children[0].OnDestroy()},e.prototype.SetStatus=function(t){this.status=t,this.Children.length>0&&this.Children[0].SetStatus(t)},e}(a.VNode);e.IfNode=c},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),r=[],i=!1;function a(){var t=[];r.forEach(function(e){return t.push(e)}),r=[],t.forEach(function(t){return t.Update()}),r.length>0?a():o.RefreshApp()}e.AddWatcher=function(t){-1==r.indexOf(t)&&r.push(t),i||(i=!0,setTimeout(function(){a(),i=!1},0))},e.RevokeWatcher=a},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(27),r=n(0),i=function(){function t(t){this.key=t,this.watches=[]}return t.prototype.GetKey=function(){return this.key},t.prototype.AddTarget=function(t){-1==this.watches.indexOf(t)&&this.watches.push(t)},t.prototype.Notify=function(){this.watches=this.watches.filter(function(t){return t.GetVNode().GetStatus()==r.VNodeStatus.ACTIVE?(o.AddWatcher(t),!0):t.GetVNode().GetStatus()==r.VNodeStatus.INACTIVE||t.GetVNode().GetStatus()!=r.VNodeStatus.DEPRECATED&&void 0})},t}();e.WatcherCollecter=i},function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e){this.itemExp=t,this.arrayExp=e}}();e.ForExp=n},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n(8),u=n(29),s=n(7),c=n(3),p=n(0),l=function(t){function e(e,n,o,r){var i=t.call(this,e,n,o)||this;i.Vdom=e,i.mvvm=n,i.Parent=o,i.originForExp=r;var a=i.originForExp.trim().split(";"),s=a[0].split(/\s+/);if(i.forExp=new u.ForExp(s[0],s[2]),a.length>1){var c=a[1].split("=");if(2==c.length){if("$index"!=c[1])throw new Error("unrecognized variable "+c[1]);i.indexName=c[0]}}return i}return r(e,t),e.prototype.newCopyNode=function(t){var e=this.forExp.itemExp,n=this.forExp.arrayExp+"["+t+"]",o=this,i=new(function(i){function u(){var t=null!==i&&i.apply(this,arguments)||this;return t.$hirented=o.mvvm,t}return r(u,i),u.prototype.$InitDataItems=function(){return[]},u.prototype.$InitComputeItems=function(){return[]},u.prototype.$Render=function(){return null},u.prototype.$InitTreeroot=function(){return null},u.prototype.$InitNamespace=function(){return o.mvvm.$InitNamespace()},u.prototype.$GetExpOrFunValue=function(t){var e=this.$ExtendMvvm();return a.EvalExp(e,t)},u.prototype.$ExtendMvvm=function(){var r=o.mvvm.$ExtendMvvm();return Object.defineProperty(r,e,{get:function(){return r.$GetExpOrFunValue(n)},enumerable:!0,configurable:!0}),null!=o.indexName?Object.defineProperty(r,o.indexName,{value:t,configurable:!0,enumerable:!0}):Object.defineProperty(r,"$index",{value:t,configurable:!0,enumerable:!0}),r},u.prototype.$RevokeMethod=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=this.$ExtendMvvm();o.$RevokeMethod.apply(o,[t].concat(e))},u}(s.Mvvm)),u=c.NewVNode(this.Vdom,i,this,c.Priority.IF);return u.AttachChildren(),u},e.prototype.implementForExp=function(t){var e=this;if(t>this.Children.length){for(var n=[],o=this.Children.length;o<t;o++){var r=this.newCopyNode(o);n.push(r)}return n.forEach(function(t){e.Children.push(t),e.DomSet=e.DomSet.concat(t.Render())}),void this.Parent.Reflow()}if(t<this.Children.length){var a=this.Children.splice(t);a.forEach(function(t){e.DomSet.forEach(function(e){t.DomSet.some(function(t){return t.dom==e.dom})&&(e.type=p.DomType.DELETE)})}),a.forEach(function(t){t.SetStatus(i.VNodeStatus.DEPRECATED),t.OnDestroy()})}},e.prototype.Update=function(){var t=this.mvvm.$GetExpOrFunValue(this.forExp.arrayExp);"[object Array]"===toString.call(t)&&this.implementForExp(t.length)},e.prototype.AttachChildren=function(){for(var t=this.mvvm.$GetExpOrFunValue(this.forExp.arrayExp+".length"),e=0;e<t;e++)this.Children.push(this.newCopyNode(e))},e.prototype.Render=function(){var t=this;return this.mvvm.$CreateWatcher(this,this.forExp.arrayExp+".length",this.implementForExp.bind(this)),this.Children.forEach(function(e){t.DomSet=t.DomSet.concat(e.Render())}),this.DomSet},e.prototype.OnDestroy=function(){this.Children.forEach(function(t){return t.OnDestroy()})},e.prototype.SetStatus=function(t){this.status=t,this.Children.forEach(function(e){return e.SetStatus(t)})},e}(n(2).VNode);e.ForNode=l},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e,n,o,r){var i=t.call(this,e,n,o)||this;return i.vdom=e,i.mvvm=n,i.Parent=o,i.name=r,null!=i.name&&""!=i.name||(i.name="default"),i}return r(e,t),e.prototype.Render=function(){var t=this.mvvm.$GetFenceNode().GetTemplate(this.name);return null!=t&&(t.Parent=this,this.Children=[t],this.DomSet=t.Render()),this.DomSet},e.prototype.Update=function(){var t=this.mvvm.$GetFenceNode().GetTemplate(this.name);null!=t&&t.Update()},e.prototype.SetStatus=function(t){this.status=t,this.mvvm.$GetFenceNode().GetTemplate(this.name).SetStatus(t)},e.prototype.OnDestroy=function(){this.mvvm.$GetFenceNode().GetTemplate(this.name).OnDestroy()},e}(n(2).VNode);e.SlotNode=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=function(){function t(t){var e=this;this.vdom=t,this.ins_pure={},this.ins_exp={},this.outs={},this.vdom.Attrs.forEach(function(t){e.addProperty(t.Name,t.Value)})}return t.prototype.addProperty=function(t,e){o.REG_IN.test(t)?this.ins_exp[RegExp.$1]=e:o.REG_OUT.test(t)?this.outs[RegExp.$1]=e:this.ins_pure[t]=e},t.prototype.GetIn=function(t){return null!=this.ins_pure[t]?{value:this.ins_pure[t],const:!0}:null!=this.ins_exp[t]?{value:this.ins_exp[t],const:!1}:null},t.prototype.GetOut=function(t){return this.outs[t]},t}();e.DirectiveNode=r},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(1);e.Style=function(t,e){if(!/^\{([^:,]+:[^:\?,]+\?[^:,]+:[^:,]+)(,[^:,]+:[^:\?,]+\?[^:,]+:[^:,]+)*\}$/.test(t))throw new Error("exp format error:"+t);var n=o.ParseStyle(t),r=function(t){var o=e.mvvm.$CreateWatcher(e,n[t],function(n){"[object String]"==toString.call(n)&&""!=n?e.DomSet[0].dom.style[t]=n:e.DomSet[0].dom.style[t]=""}).GetCurValue();"[object String]"==toString.call(o)&&""!=o&&(e.DomSet[0].dom.style[t]=o)};for(var i in n)r(i)}},function(t,e){function n(t,e){var n=t.DomSet[0].dom;if("select"!=t.GetNodeName()){var o=n.getAttribute("type");switch(null!=o&&""!=o||(o="text"),o){case"text":n.value=e;break;case"radio":n.value==e?n.checked=!0:n.checked=!1;break;case"checkbox":"[object Array]"==toString.call(e)&&(-1==e.indexOf(n.value)?n.checked=!1:n.checked=!0)}}else n.value=e}Object.defineProperty(e,"__esModule",{value:!0}),e.DirModel=function(t,e){var o,r=e.Vdom.GetAttr("type"),i=e.Vdom.NodeName.toLowerCase();o="input"==i&&"checkbox"==r?e.mvvm.$CreateWatcher(e,t,function(t){n(e,t)},!0):e.mvvm.$CreateWatcher(e,t,function(t){n(e,t)}),n(e,o.GetCurValue()),e.DomSet[0].dom.addEventListener("input",function(n){if("select"!=e.GetNodeName()){var r=e.DomSet[0].dom.getAttribute("type");switch(null!=r&&""!=r||(r="text"),r){case"text":case"radio":e.mvvm.$SetValue(t,n.target.value);break;case"checkbox":var i=o.GetCurValue();if("[object Array]"==toString.call(i)){var a=i,u=a.indexOf(n.target.value);-1==u?a.push(n.target.value):a.splice(u,1)}}}else e.mvvm.$SetValue(t,n.target.value)})}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(1);e.Html=function(t,e){var n=o.StrToEvalstr(t);if(n.isconst)e.DomSet[0].dom.innerHTML=n.exp;else{var r=e.mvvm.$CreateWatcher(e,n.exp,function(t){e.DomSet[0].dom.innerHTML=t});e.DomSet[0].dom.innerHTML=r.GetCurValue()}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),r=n(1);function i(t,e){"A"==t.nodeName?t.setAttribute("href",e):t.setAttribute(o.PRE+"href",e)}e.Href=function(t,e){var n="",o=r.StrToEvalstr(t),a=e.DomSet[0].dom;if(o.isconst)n=o.exp,i(a,n);else{var u=e.mvvm.$CreateWatcher(e,o.exp,function(t){i(a,n=t)});n=u.GetCurValue(),i(a,n)}a.addEventListener("click",function(t){"A"==a.nodeName&&t.preventDefault(),e.mvvm.$NavigateTo(n)})}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(0);e.OnEvent=function(t,e,n){if(null==n||0==n.length)throw new Error("r-on need specify event name");if(o.REG_EVENT.test(t)){var r=RegExp.$1,i=RegExp.$2;if(i.length>0){var a=i.split(",");e.DomSet[0].dom.addEventListener(n[0],function(t){var n,i=[];a.forEach(function(n){if(o.REG_STR.test(n))i.push(RegExp.$2);else{if("true"===n)return void i.push(!0);if("false"===n)return void i.push(!1);if("$event"==n)return void i.push(t);var r=new Number(n).valueOf();isNaN(r)?i.push(e.mvvm.$GetExpOrFunValue(n)):i.push(r.valueOf())}}),(n=e.mvvm).$RevokeMethod.apply(n,[r].concat(i))})}else e.DomSet[0].dom.addEventListener(n[0],function(){e.mvvm.$RevokeMethod(r)})}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(1);e.Classes=function(t,e){if(!/^\{([^:,]+:[^:,]+)(,[^:,]+:[^:,]+)*\}$/.test(t))throw new Error("exp format error:"+t);var n=o.ParseStyle(t),r=function(t){e.mvvm.$CreateWatcher(e,n[t],function(n){n?e.DomSet[0].dom.classList.add(t):e.DomSet[0].dom.classList.remove(t)}).GetCurValue()&&e.DomSet[0].dom.classList.add(t)};for(var i in n)r(i)}},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(15),a=n(14),u=n(1),s=n(0),c=n(32),p=function(t){function e(e,n,o){var r=t.call(this,e,n,o)||this;r.Vdom=e,r.mvvm=n,r.Parent=o,r.directives=[],r.innerDirective=[],r.isAnchor=!1,r.anchorName="",r.attrs=[],r.nodeValue=r.Vdom.NodeValue,r.nodeName=r.Vdom.NodeName,r.nodeType=r.Vdom.NodeType;for(var p=r.Vdom.Attrs,l=function(t){var e=h.Vdom.Attrs[t],n=u.GetNS(e.Name);if(null==n.namespace&&(n.namespace=h.mvvm.$InitNamespace()),a.IsDirectiveRegistered(n.value,n.namespace)){var o=new c.DirectiveNode(h.Vdom),r=new(a.GetDirectiveCon(n.value,n.namespace));r.$Initialize(o,h),p=p.filter(function(t){var e=t.Name;(s.REG_IN.test(t.Name)||s.REG_OUT.test(t.Name))&&(e=RegExp.$1);var n=r.$Ins.some(function(t){return t.name==e}),o=r.$Outs.some(function(t){return t==e});return!(n||o)}),h.directives.push(r)}},h=this,f=0;f<r.Vdom.Attrs.length;f++)l(f);return(p=p.filter(function(t){var e=t.Name.split(":"),n=i.GetInnerDir(e[0]);return null==n||(r.innerDirective.push({dir:n,exp:t.Value,options:e.slice(1)}),!1)})).forEach(function(t){s.REG_ATTR.test(t.Name)&&(r.attrs.push({name:t.Name,value:t.Value}),t.Name==s.PRE+s.ANCHOR&&(r.isAnchor=!0,r.anchorName=t.Value))}),r}return r(e,t),e.prototype.OnDestroy=function(){t.prototype.OnDestroy.call(this),this.directives.forEach(function(t){return t.$OnDestroy()})},e.prototype.directiveBind=function(){var t=this;this.directives.forEach(function(t){return t.$Render()}),this.innerDirective.forEach(function(e){e.dir(e.exp,t,e.options)})},e.prototype.Render=function(){var t=this;if(1==this.nodeType){var e=document.createElement(this.nodeName);return this.attrs.forEach(function(n){var o=u.StrToEvalstr(n.value);if(o.isconst)e.setAttribute(n.name,o.exp);else{var r=t.mvvm.$CreateWatcher(t,o.exp,function(t,o){e.setAttribute(n.name,t)}).GetCurValue();"src"==n.name&&"img"==t.nodeName?e.src=r:e.setAttribute(n.name,r)}}),this.DomSet=[{type:s.DomType.NEW,dom:e}],this.Children.forEach(function(e){var n=e.Render();n.forEach(function(e){t.DomSet[0].dom.appendChild(e.dom)}),n.forEach(function(t){t.type=s.DomType.CONSTANT})}),this.directiveBind(),this.DomSet}if(3==this.nodeType){var n=document.createTextNode(this.nodeValue);this.DomSet=[{type:s.DomType.NEW,dom:n}];var o=u.StrToEvalstr(this.nodeValue);if(o.isconst)n.textContent=o.exp;else{var r=this.mvvm.$CreateWatcher(this,o.exp,function(t,e){n.textContent=t});n.textContent=r.GetCurValue()}return this.DomSet}if(8==this.nodeType){var i=document.createComment(this.nodeValue);return this.DomSet=[{type:s.DomType.NEW,dom:i}],this.DomSet}},e.prototype.Refresh=function(){if(this.DomSet.forEach(function(t){return t.type=s.DomType.CONSTANT}),1==this.nodeType){var t=this.DomSet[0].dom,e=null;this.Children.forEach(function(n){n.DomSet.forEach(function(n){if(n.type!=s.DomType.CONSTANT)return n.type==s.DomType.NEW?(u.InsertDomChild(t,n.dom,e),void(e=n.dom)):void(n.type!=s.DomType.DELETE||t.removeChild(n.dom));e=n.dom})})}this.Children.forEach(function(t){return t.Refresh()})},e.prototype.Update=function(){if(1==this.nodeType){var t=[];return this.Children.forEach(function(e){t.push(e)}),void t.forEach(function(t){t.Update()})}if(3==this.nodeType){var e=u.StrToEvalstr(this.nodeValue);e.isconst?this.DomSet[0].dom.textContent=e.exp:this.DomSet[0].dom.textContent=this.mvvm.$GetExpOrFunValue(e.exp)}},e.prototype.Reflow=function(){},e.prototype.GetAnchor=function(e){return this.isAnchor&&this.anchorName==e?this:t.prototype.GetAnchor.call(this,e)},e}(n(2).VNode);e.VinallaNode=p},function(t,e,n){var o,r=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),a=n(3),u=n(4);e.Component=function(t){!function(t){t.namespace=t.namespace?t.namespace:"default",t.events=t.events?t.events:[]}(t);var e=u.FetchProperty();return function(n){var o=function(n){function o(){var t=null!==n&&n.apply(this,arguments)||this;return t.$InitFuncs=e.initFuncs,t.$MountFuncs=e.mountFuncs,t.$DestroyFuncs=e.destroyFuncs,t}return r(o,n),o.prototype.$initialize=function(){var t=this;n.prototype.$initialize.call(this),this.$InitFuncs.forEach(function(e){t[e].call(t)})},o.prototype.$Render=function(){var t=this,e=n.prototype.$Render.call(this);return this.$MountFuncs.forEach(function(e){t[e].call(t)}),e},o.prototype.$OnDestroy=function(){var t=this;n.prototype.$OnDestroy.call(this),this.$DestroyFuncs.forEach(function(e){t[e].call(t)})},o.prototype.$InitTreeroot=function(){i.InitComponent(this.$InitName(),this.$InitNamespace());var t=i.GetDomTree(this.$InitName(),this.$InitNamespace());if(null==t)throw new Error("not found template or templateUrl for component "+this.$InitName()+" in "+this.$InitNamespace());return a.NewVNode(t,this,null)},o.prototype.$InitNamespace=function(){return t.namespace},o.prototype.$InitDataItems=function(){var t=this,n=[];return e.datas.forEach(function(e){n.push({name:e,value:t[e]})}),n},o.prototype.$InitComputeItems=function(){return e.computes},o.prototype.$InitName=function(){return t.name},o.prototype.$InitIns=function(){return e.props},o.prototype.$InitOuts=function(){return t.events},o}(n);return null==t.name&&(t.name=n.name.toLowerCase()+i.ComponentAutoId()),i.RegisterComponent(t.name,t.namespace,o,t),o}}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=n(10),r=n(40);e.Component=r.Component;var i=n(22);e.App=i.App;var a=n(4);e.Reactive=a.Reactive,e.Computed=a.Computed,e.Prop=a.Prop,e.OnInit=a.OnInit,e.OnDestroy=a.OnDestroy,e.OnMount=a.OnMount;var u=n(21);e.Directive=u.Directive;var s=n(20);e.ComponentMvvm=s.ComponentMvvm;var c=n(19);e.AppMvvm=c.AppMvvm;var p=n(18);e.DirectiveMVVM=p.DirectiveMVVM;var l=n(5);e.RegisterRouter=l.RegisterRouter,document.addEventListener("DOMContentLoaded",function(){o.Start()})}])});
//# sourceMappingURL=rio.umd.min.js.map