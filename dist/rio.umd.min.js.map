{"version":3,"sources":["webpack://Rio/webpack/universalModuleDefinition","webpack://Rio/webpack/bootstrap","webpack://Rio/./src/const.ts","webpack://Rio/./src/util.ts","webpack://Rio/./src/vnode/vnode.ts","webpack://Rio/./src/vdom/vdom.ts","webpack://Rio/./src/decorator/property.ts","webpack://Rio/./src/manager/components-manager.ts","webpack://Rio/./src/router/router-manager.ts","webpack://Rio/./src/mvvm/mvvm.ts","webpack://Rio/./src/manager/start.ts","webpack://Rio/./src/vnode/custom-node.ts","webpack://Rio/./src/observer/watcher.ts","webpack://Rio/./src/observer/observer.ts","webpack://Rio/./src/router/router-state.ts","webpack://Rio/./src/eval.js","webpack://Rio/./src/manager/directive-manager.ts","webpack://Rio/./src/manager/app-manager.ts","webpack://Rio/./src/mvvm/directive-mvvm.ts","webpack://Rio/./src/mvvm/app-mvvm.ts","webpack://Rio/./src/mvvm/component-mvvm.ts","webpack://Rio/./src/decorator/directive.ts","webpack://Rio/./src/decorator/app.ts","webpack://Rio/./src/vnode/plug-node.ts","webpack://Rio/./src/vnode/router-node.ts","webpack://Rio/./src/vnode/template-node.ts","webpack://Rio/./src/vnode/if-node.ts","webpack://Rio/./src/observer/msg-queue.ts","webpack://Rio/./src/observer/watcher-collect.ts","webpack://Rio/./src/models.ts","webpack://Rio/./src/vnode/for-node.ts","webpack://Rio/./src/vnode/slot-node.ts","webpack://Rio/./src/vnode/directive-node.ts","webpack://Rio/./src/directive/class.ts","webpack://Rio/./src/directive/style.ts","webpack://Rio/./src/directive/html.ts","webpack://Rio/./src/directive/onclick.ts","webpack://Rio/./src/directive/model.ts","webpack://Rio/./src/directive/href.ts","webpack://Rio/./src/directive/inner-dir.ts","webpack://Rio/./src/vnode/vinalla-node.ts","webpack://Rio/./src/decorator/component.ts","webpack://Rio/./src/main.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","DIR_MODEL","DIR_EVENT_CLICK","PRE","REG_SINGLE","REG_MULTI","REG_EVENT","REG_STR","REG_MID_STR","REG_IN","REG_OUT","REG_ATTR","REG_TEST_OUTPUT","VNodeStatus","DomType","const_1","LogError","msg","console","error","LogInfo","log","GetNS","str","res","split","length","namespace","slice","join","HttpGet","url","xhr","XMLHttpRequest","open","send","readyState","status","responseText","IsStringEmpty","trim","Trim","char","Error","start","end","substring","StrToEvalstr","test","isconst","exp","RegExp","$1","reg","exec","lastindex","index","endsWith","InsertDomChild","parent","child","after","firstChild","insertBefore","appendChild","nextSibling","TypeOf","param","toString","vdom_1","VNode","Vdom","mvvm","Parent","this","attrs","Children","DomSet","ACTIVE","nodeValue","NodeValue","nodeName","NodeName","nodeType","NodeType","Reflow","_this","forEach","concat","Rerender","filter","dom","type","DELETE","OnRemoved","AttachChildren","childdom","vchild","NewVNode","push","SetStatus","GetStatus","OnRouterChange","NavigateTo","$IsRoot","$NavigateTo","$GetFenceNode","GetNodeName","toLowerCase","Priority","components_manager_1","util_1","vinalla_node_1","VDom","Attrs","GetAttr","Name","Value","AddAttr","attr","TraverseDom","replace","htmldom","attributes","childNodes","priority","FOR","SlotNode","ForNode","IF","IfNode","TemplateNode","RouterNode","ns","IsComponentRegistered","selfmvvm","InitComponent","cust","CustomNode","$SetFenceNode","$initialize","$AttachChildren","VinallaNode","datas","computes","props","initFuncs","destroyFuncs","Data","target","key","Computed","descriptor","Prop","required","OnInit","OnDestroy","FetchProperty","repository","Id","RegisterComponent","constructor","option","factoryOption","$constructor","$id","$preProcess","$domtree","$origin","RegisterComponentDirect","templateUrl","template","DOMParser","parseFromString","body","children","styleUrl","style","document","createElement","innerHTML","getElementsByTagName","addAttr","preProcess","GetDomTree","router_state_1","start_1","matchedRouter","appRouters","cursor","firstVNode","matchRouter","vinallaUrl","location","pathname","substr","vinallaSlice","matchedSlice","fullUrls","params","j","name_1","requireParams","searchParams","searchSlice","search","name_value","getSearchParams","rp","find","matchUrl","clearMark","router","marked","routers","getLeaf","redirect","history","replaceState","SetActiveRouter","parent_1","unshift","RegisterRouter","checkRouter","component","components","urls","map","indexOf","copyRouter","fullurl","NextRouter","vnode","MoveBack","NotifyUrlChange","RefreshApp","observer_1","eval_1","watcher_1","Mvvm","$data","$namespace","$dataItems","$computeItems","$isroot","active","GetActiveRouter","cur","$InitDataItems","$InitComputeItems","$treeRoot","$InitTreeroot","$InitNamespace","item","set","ReactiveData","ReactiveComputed","$GetExpOrFunValue","expOrFunc","EvalExp","$ExtendMvvm","$SetValue","keys","hasTraget","$CreateWatcher","listener","watchingArrayItem","Watcher","$OnDestroy","$SetRoot","isroot","$GetDataItems","$GetComputedItems","$Refresh","$RevokeMethod","method","_i","arguments","apply","app_manager_1","apps","Start","GetApp","App","content","$Render","querySelector","$InitEl","parentElement","replaceChild","app","plug_node_1","_super","SurroundMvvm","ins_pure","ins_exp","outs","ins","$InitIns","i_1","prop","$InitOuts","i_2","event_1","__extends","AddIns","GetTemplate","templatename","Render","doms","templates","default","PlugNode","childnode","name_2","name_3","GetInValue","GetIn","const","GetOut","Update","$Update","$SetStatus","ExpOrFunc","cb","deepRecord","getValue","SetTarget","CleanTarget","GetVNode","newval","diff","$target","watcher_collect_1","data","reactiveKey","collecter","WatcherCollecter","reactiveArray","AddTarget","Notify","array","Array","old","_a","pop","splice","shift","func","firstget","_RouterInfo","path","getParam","listeners","listen","DEPRECATED","WatchRouterChange","context","attachObj","newcontext","assign","$attachObj","eval","RegisterDirective","GetDirectiveCon","IsDirectiveRegistered","RegisterApp","DirectiveMVVM","$directive","$vnode","$Ins","$Outs","$InitFuncs","$DestroyFuncs","destroy","$element","init","inName","$Name","newvalue","$checkProp","oldvalue","router_manager_1","AppMvvm","$el","ComponentMvvm","$name","$ins","$outs","$InitName","$fenceNode","$Emit","event","e","out","paramsType","$OnRouterChange","node","$GetIns","property_1","directive_manager_1","Directive","events","checkDirectiveOption","$DirectiveMvvm","directive","$Namespace","$Out","checkAppOption","$AppMvvm","el","vdom","vnode_1","custom_node_1","instance","componentStr","construct","custnode","ifExp","NORMAL","reImpletement","attached","queue","settimeout","RevokeWatcher","temp","q","watcher","AddWatcher","setTimeout","msg_queue_1","watches","GetKey","INACTIVE","ForExp","itemExp","arrayExp","models_1","mvvm_1","const_2","originForExp","forSplit","newCopyNode","itemexp","itemexpValue","that","class_1","$hirented","implementForExp","newcount","custnodes","moved","moveditem","some","moveddom","items","num","bind","DirectiveNode","addProperty","Classes","hacked","classes_1","classList","add","remove","Style","styleexp","istrue","styles","stylename","Html","noBracket","strEval","OnClick","methodStr_1","paramsStr","$2","ps_1","addEventListener","Number","valueOf","isNaN","setValue","inputType","getAttribute","checked","DirModel","inputtype","input","oldarray","Href","href","streval","setAttribute","href_1","model_1","onclick_1","html_1","style_1","innerDirs","RegisterInnerDir","comiple","GetInnerDir","inner_dir_1","directive_node_1","directives","innerDirective","vanillaAttrs","this_1","dirNode","dirMvvm_1","isprop","isevent","dir_1","dir","directiveBind","dom_1","NEW","childdomset","childom","CONSTANT","dom_2","createTextNode","evalexp","textContent","createComment","thedom_1","childdom_1","domstate","removeChild","children_1","Component","checkComponentOption","$ComponentMvvm","domtree","component_1","app_1","directive_1","component_mvvm_1","app_mvvm_1","directive_mvvm_1"],"mappings":"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","file":"rio.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Rio\"] = factory();\n\telse\n\t\troot[\"Rio\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 40);\n","export const DIR_MODEL = \"model\"\nexport const DIR_EVENT_CLICK = \"click\"\nexport const PRE=\"r-\"\n\n/**花括号数据绑定表达式 */\nexport const REG_SINGLE = /^\\{\\{([^\\{\\}]*)\\}\\}$/\nexport const REG_MULTI = /\\{\\{(.*?)\\}\\}/\n/**事件监听响应函数 */\nexport const REG_EVENT=/^(\\w+)\\((.*)\\)$/\n/**字符串 */\nexport const REG_STR=/^(['\"])(.*?)\\1$/\nexport const REG_MID_STR=/(['\"])(.*?)\\1/\n\n/**输入属性 */\nexport const REG_IN=/^\\[(\\w+)\\]$/\n/**输出事件 */\nexport const REG_OUT=/^\\((\\w+)\\)$/\n/**正常属性 */\nexport const REG_ATTR=/^[A-z_]\\w*$/\n\n\n/**测试输出项 */\nexport const REG_TEST_OUTPUT=/^((click))$/\n\nexport enum VNodeStatus{\n    /**依然处于vnode树中 */\n    ACTIVE,\n    /**不在vnode树中但是有可能重新加回来 */\n    INACTIVE,\n    /**抛弃 */\n    DEPRECATED\n}\n\nexport enum DomType{\n    /*没有变化的*/\n    CONSTANT,\n    /**新增的 */\n    NEW,\n    /**删除的 */\n    DELETE\n}","import { REG_SINGLE, REG_MULTI } from \"./const\";\nimport { ParamType } from \"./models\";\n\nexport function LogError(msg:any){\n    console.error(msg)\n}\nexport function LogInfo(msg:any){\n    console.log(msg)\n}\nexport function GetNS(str:string):{namespace:string,value:string}{\n    let res=str.split(\":\")\n    if(res.length==1)\n        return {namespace:null,value:res[0]}\n    return {namespace:res[0],value:res.slice(1).join(\":\")}\n}\nexport function HttpGet(url:string):string{\n    let xhr=new XMLHttpRequest()\n    xhr.open(\"GET\",url,false)\n    xhr.send()\n    if(xhr.readyState==4 && xhr.status==200)\n        return xhr.responseText\n    else\n        return null\n}\nexport function IsStringEmpty(str:string){\n    if(str==null)\n        return true\n    str=str.trim()\n    if(str==\"\")\n        return true\n    return false\n}\nexport function Trim(str:string,char:string){\n    if(char.length>1)\n        throw new Error(\"only receve one character\")\n    let start=-1\n    while(str[start+1]==char){\n        start++\n    }\n    let end=str.length\n    while(str[end-1]==char){\n        end--\n    }\n    return str.substring(start+1,end)\n}\n\nexport function StrToEvalstr(str:string):{isconst:boolean,exp:string}{\n    if (REG_SINGLE.test(str)) {\n        return {isconst:false,exp:RegExp.$1}\n    }else{\n        if(REG_MULTI.test(str)){\n            let reg=/\\{\\{([^\\{\\}]*)\\}\\}/g\n            let res=reg.exec(str)\n            let exp=\"\"\n            let lastindex=0\n            while(res){\n                if(res.index!=lastindex){\n                    exp+=\"\\'\"+str.substring(lastindex,res.index)+\"\\'+\"\n                }\n                lastindex=res.index+res[0].length\n                exp+=\"(\"+RegExp.$1+\")+\"\n                res=reg.exec(str)\n            }\n            if(exp.endsWith(\"+\")){\n                exp=exp.substring(0,exp.length-1)\n            }\n\n            return {isconst:false,exp:exp}\n        }else{\n            return {isconst:true,exp:str}\n        }\n    }\n}\n\nexport function InsertDomChild(parent:Node,child:Node,after:Node){\n    if(after==null){\n        if(parent.firstChild!=null)\n            parent.insertBefore(child,parent.firstChild)\n        else\n            parent.appendChild(child)\n    }else{\n        if(after.nextSibling!=null)\n            parent.insertBefore(child,after.nextSibling)\n        else\n            parent.appendChild(child)\n    }\n}\n\nexport function TypeOf(param:any):ParamType{\n    if(toString.call(param)==\"[object Boolean]\"){\n        return \"boolean\"\n    }\n    if(toString.call(param)==\"[object Array]\"){\n        return \"array\"\n    }\n    if(toString.call(param)==\"[object Number]\"){\n        return \"number\"\n    }\n    if(toString.call(param)==\"[object Object]\"){\n        return \"object\"\n    }\n    if(toString.call(param)==\"[object Null]\"){\n        return \"object\"\n    }\n    if(toString.call(param)==\"[object String]\"){\n        return \"string\"\n    }\n    if(toString.call(param)==\"[object Undefined]\"){\n        throw new Error(\"function TypeOf: undefined is not allowed\")\n    }\n}","import { DomStatus } from './../models';\nimport { Mvvm } from '../mvvm/mvvm';\nimport { NewVNode, VDom } from '../vdom/vdom';\nimport { DomType, VNodeStatus } from './../const';\nimport { AppMvvm } from './../mvvm/app-mvvm';\nimport { ComponentMvvm } from './../mvvm/component-mvvm';\nexport abstract class VNode {\n    protected nodeValue: string\n    protected nodeName: string\n    protected nodeType: number\n    /**普通属性 */\n    protected attrs: { name: string, value: string }[] = []\n    \n    Children: VNode[] = []\n    DomSet: {type:DomType,dom:Node}[]=[]\n\n    \n    protected status:VNodeStatus=VNodeStatus.ACTIVE\n\n    constructor(public Vdom:VDom,public mvvm: Mvvm,public Parent:VNode) {\n        if(this.Vdom!=null){\n            this.nodeValue = this.Vdom.NodeValue\n            this.nodeName = this.Vdom.NodeName\n            this.nodeType = this.Vdom.NodeType\n        }\n    }\n\n\n    abstract Render():DomStatus[];\n\n    Reflow(){\n        this.DomSet=[];\n        this.Children.forEach(child=>{\n            this.DomSet=this.DomSet.concat(child.DomSet)\n        });\n        if(this.Parent!=null)\n            this.Parent.Reflow()\n    }\n    Rerender():void{\n        this.DomSet=this.DomSet.filter(dom=>dom.type!=DomType.DELETE)\n        this.Children.forEach(child=>child.Rerender())\n    }\n    \n\n    abstract Update():void;\n    \n    \n    OnRemoved(){\n        this.Children.forEach(child=>{\n            child.OnRemoved()\n        })\n    }\n    \n    AttachChildren() {\n        //解析子节点\n        for (let i = 0; i < this.Vdom.Children.length; i++) {\n            let childdom=this.Vdom.Children[i]\n            let vchild=NewVNode(childdom,this.mvvm,this)\n            \n            if(vchild!=null){\n                vchild.AttachChildren()\n                this.Children.push(vchild)\n            }\n        }\n    }\n    SetStatus(status:VNodeStatus){\n        this.status=status\n        this.Children.forEach(child=>{\n            child.SetStatus(status)\n        })\n    }\n    GetStatus(){\n        return this.status\n    }\n    OnRouterChange(){\n        this.Children.forEach(child=>child.OnRouterChange())\n    }\n    NavigateTo(url:string):void{\n        if(this.mvvm.$IsRoot()){\n            (this.mvvm as AppMvvm).$NavigateTo(url)\n        }else{\n            if(this.Parent!=null)\n                this.Parent.NavigateTo(url);\n            else{\n                (<ComponentMvvm>this.mvvm).$GetFenceNode().NavigateTo(url);\n            }\n        }\n    }\n    GetNodeName(){\n        return this.nodeName.toLowerCase()\n    }\n}","import { VNode } from \"../vnode/vnode\";\nimport { IsComponentRegistered, InitComponent } from \"../manager/components-manager\";\nimport { Mvvm } from \"../mvvm/mvvm\";\nimport { GetNS } from \"../util\";\nimport { PRE } from \"../const\";\nimport { VinallaNode } from \"../vnode/vinalla-node\";\n\ndeclare let require:(module:string)=>any\nexport class VDom{\n    NodeValue: string\n    NodeName: string\n    NodeType: number\n    Attrs: { Name: string, Value: string }[] = []\n    Children: VDom[] = []\n    GetAttr(name:string){\n        for(let i=0;i<this.Attrs.length;i++){\n            if(this.Attrs[i].Name==name)\n                return this.Attrs[i].Value\n        }\n        return null\n    }\n    AddAttr(attr:string){\n        this.Attrs.push({Name:attr,Value:\"\"})\n    }\n}\nexport function TraverseDom(dom:Node):VDom{\n    if(dom.nodeType==3 && dom.nodeValue.trim()==\"\")\n        return\n    let root=new VDom()\n    root.NodeValue=dom.nodeValue\n    if(root.NodeValue!=null){\n        root.NodeValue=root.NodeValue.replace(/\\s+/g,\"\")\n    }\n    root.NodeName=dom.nodeName.toLowerCase()\n    root.NodeType=dom.nodeType\n    if(dom.nodeType==1){\n        let htmldom=dom as HTMLElement\n        for(let i=0;i<htmldom.attributes.length;i++){\n            root.Attrs.push({Name:htmldom.attributes[i].name,Value:htmldom.attributes[i].value})\n        }\n        for(let i=0;i<htmldom.childNodes.length;i++){\n            let child=TraverseDom(htmldom.childNodes[i])\n            child && root.Children.push(child)\n        }\n    }\n    return root\n}\nexport enum Priority{\n    NORMAL,\n    IF,\n    FOR\n}\nexport function NewVNode(dom:VDom,mvvm:Mvvm,parent:VNode,priority:Priority=Priority.FOR):VNode{\n    if(dom.NodeName.toLowerCase()==\"slot\"){\n        let SlotNode=require(\"../vnode/slot-node\").SlotNode\n        let vnode=new SlotNode(dom,mvvm,parent,dom.GetAttr(\"name\"))\n        return vnode\n    }\n\n    if(priority>=Priority.FOR && dom.GetAttr(PRE+\"for\")!=null){\n        let ForNode=require(\"../vnode/for-node\").ForNode\n        let vnode= new ForNode(dom,mvvm,parent,dom.GetAttr(PRE+\"for\"))\n        return vnode\n    }\n    if(priority>=Priority.IF && dom.GetAttr(PRE+\"if\")!=null){\n        let IfNode=require(\"../vnode/if-node\").IfNode\n        let vnode= new IfNode(dom,mvvm,parent,dom.GetAttr(PRE+\"if\"))              \n        return vnode\n    }\n    if(dom.NodeName==\"r-template\"){\n        let TemplateNode=require(\"../vnode/template-node\").TemplateNode\n        let vnode= new TemplateNode(dom,mvvm,parent)\n        return vnode\n    }\n    if(dom.NodeName==\"router-view\"){\n        let RouterNode=require(\"../vnode/router-node\").RouterNode\n        let vnode= new RouterNode(dom,mvvm,parent)\n        return vnode\n    }\n    let ns=GetNS(dom.NodeName)\n    if(IsComponentRegistered(ns.value,ns.namespace||\"default\")){\n        let construct=InitComponent(ns.value,ns.namespace||\"default\")\n        let selfmvvm=new construct()\n\n        let CustomNode=require(\"../vnode/custom-node\").CustomNode\n        let cust= new CustomNode(dom,mvvm,parent,selfmvvm)\n        selfmvvm.$SetFenceNode(cust)\n\n        selfmvvm.$initialize()\n        selfmvvm.$AttachChildren()\n        \n        \n        return cust\n    }\n        \n    return new VinallaNode(dom,mvvm,parent)\n}","import { ParamType, Prop } from './../models';\nlet datas:string[]=[]\nlet computes:{name:string,get:()=>any}[]=[]\nlet props:Prop[]=[]\nlet initFuncs:string[]=[]\nlet destroyFuncs:string[]=[]\n\n\n\nexport function Data(target:any,key:string){\n    datas.push(key)\n}\nexport function Computed(target:any,key:string,descriptor:PropertyDescriptor){\n    computes.push({name:key,get:(descriptor as any).get})\n}\nexport function Prop(name:string,required:boolean,type?:ParamType){\n    props.push({\n        name:name,\n        required:required,\n        type:type\n    })\n    return function(target:any,key:string){}\n}\n\nexport function OnInit(target:any,key:string,descriptor:PropertyDescriptor){\n    initFuncs.push(key)\n}\nexport function OnDestroy(target:any,key:string,descriptor:PropertyDescriptor){\n    destroyFuncs.push(key)\n}\n\n\n\nexport function FetchProperty(){\n    let res={\n        computes:computes,\n        props:props,\n        initFuncs:initFuncs,\n        destroyFuncs:destroyFuncs,\n        datas:datas\n    }\n    computes=[]\n    props=[]\n    initFuncs=[]\n    destroyFuncs=[]\n    datas=[]\n    return res\n}","import { IComponentMvvm } from './../models';\nimport { ComponentOption, ComponentMvvmFactoryOption } from '../models';\nimport { HttpGet, LogError } from \"../util\";\nimport { TraverseDom } from \"../vdom/vdom\";\nimport { VDom } from './../vdom/vdom';\n\n\nlet repository:{[id:string]:ComponentMvvmFactoryOption}={}\n\nexport function Id(namespace:string,name:string){\n    return namespace+\"::\"+name;\n}\n\nexport function RegisterComponent(name:string,namespace:string,constructor:IComponentMvvm,option:ComponentOption) {\n    let factoryOption:ComponentMvvmFactoryOption={\n        $constructor:constructor,\n        $id:Id(namespace,name),\n        $preProcess:false,\n        $domtree:null,\n        $origin:option\n    }\n    if(repository[factoryOption.$id]!=null)\n        throw new Error(\"component \"+factoryOption.$id+\" already exists\")\n    repository[factoryOption.$id]=factoryOption\n}\nexport function RegisterComponentDirect(option:ComponentMvvmFactoryOption){\n    if(repository[option.$id]!=null)\n        throw new Error(\"component \" + option.$id + \" has already exist\")\n    repository[option.$id]=option\n}\n\nexport function InitComponent(name: string, namespace: string): IComponentMvvm {\n    name = name.toLowerCase()\n    namespace = namespace.toLowerCase()\n    let factory = repository[Id(namespace,name)]\n    if (factory && !factory.$preProcess){\n        preProcess(factory)\n        factory.$preProcess=true\n    }\n    if(factory){\n        return factory.$constructor\n    }else{\n        throw new Error(\"component \"+Id(namespace,name)+\" not exists\")\n    }\n    \n}\nexport function GetDomTree(name: string, namespace: string){\n    name = name.toLowerCase()\n    namespace = namespace.toLowerCase()\n    let factory = repository[Id(namespace,name)]\n    if(factory==null)\n        return null\n    return factory.$domtree\n}\nexport function IsComponentRegistered(name: string, namespace: string) {\n    name = name.toLowerCase()\n    namespace = namespace.toLowerCase()\n    if (repository[Id(namespace,name)])\n        return true\n    else\n        return false\n}\nfunction preProcess(option: ComponentMvvmFactoryOption) {\n    //模版\n    if (option.$origin.templateUrl != null) {\n        option.$origin.template = HttpGet(option.$origin.templateUrl)\n        if (option.$origin.template == null) {\n            LogError(\"path \" + option.$origin.templateUrl + \" not found\")\n            return\n        }\n    }\n\n    let res=(new DOMParser()).parseFromString(option.$origin.template, \"text/html\").body\n    if(res.children.length>1)\n        throw new Error(option.$origin.name+\"::\"+option.$origin.namespace+\" template should have only one root\")\n    if(res.children.length==1)\n        option.$domtree = TraverseDom(res.children[0])\n    else{\n        if(res.childNodes.length==1)\n            option.$domtree = TraverseDom(res.childNodes[0])\n        else\n            throw new Error(\"template should not be empty\")\n    }\n    //样式\n    if (option.$origin.styleUrl != null) {\n        option.$origin.style = HttpGet(option.$origin.styleUrl)\n    }\n    if (option.$origin.style != null) {\n        // let css = option.style.replace(/(?!\\s)([^\\{\\}]+?)(?=\\s*\\{[^\\{\\}]*\\})/g, function (str) {\n        //     return str + \"[\" + option.$id + \"]\"\n        // })\n        var style = document.createElement('style');\n        style.type = 'text/css';\n        style.innerHTML = option.$origin.style;\n        document.getElementsByTagName('head')[0].appendChild(style);\n        addAttr(option.$domtree, option.$id)\n    }\n}\nfunction addAttr(dom: VDom, attr: string) {\n    dom.AddAttr(attr)\n    if (dom.NodeType == 1) {\n        dom.Children.forEach(child => {\n            addAttr(child, attr)\n        })\n    }\n}\n","import { VNode } from '../vnode/vnode';\nimport { SetActiveRouter } from './router-state';\nimport { RefreshApp } from '../manager/start';\n\n\nlet matchedRouter:InnerRouter[]=[]\n\nlet appRouters:InnerRouter[]=[]\nlet cursor:number=-1\nlet firstVNode:VNode=null\nexport function RegisterRouter(routers:Router[]){\n    checkRouter(routers)\n    routers.forEach(router=>{\n        router.urls=router.urls.map(url=>{\n            if(url.indexOf(\"/\")!=0)\n                return \"/\"+url\n            else\n                return url\n        })\n    })\n    routers.forEach(router=>{\n        appRouters.push(copyRouter(null,router))\n    })\n}\nfunction checkRouter(routers:Router[]){\n    routers.forEach(router=>{\n        router.children=router.children?router.children:[]\n        if(router.redirect!=null){\n            router.component=\"\"\n            router.url=\"\"\n        }\n        if(router.component==null && router.components==null){\n            throw new Error(\"must specify component or components in router\")\n        }\n        if(router.url==null && router.urls==null){\n            throw new Error(\"must specify url or urls in router\")\n        }\n        router.params=router.params?router.params:[]\n        router.urls=router.urls?router.urls:[]\n        if(router.url!=null)\n            router.urls.push(router.url)\n        checkRouter(router.children)\n    })\n}\nfunction copyRouter(parent:InnerRouter,router:Router):InnerRouter{\n    let r:InnerRouter= {\n        urls:router.urls,\n        component:router.component,\n        components:router.components,\n        children:[],\n        parent:parent,\n        fullUrls:[],\n        params:router.params,\n        redirect:router.redirect,\n        marked:false\n    }\n    if(parent!=null){\n        r.urls.forEach(url=>{\n            parent.fullUrls.forEach(fullurl=>{\n                if(url.indexOf(\"/\")==0){\n                    r.fullUrls.push(url)\n                }else{\n                    if(url==\"\")\n                        r.fullUrls.push(fullurl)\n                    else\n                        r.fullUrls.push(fullurl+\"/\"+url)\n                }\n            })\n        })\n    }else{\n        r.urls.forEach(url=>r.fullUrls.push(url))\n    }\n    for(let i=0;i<router.children.length;i++){\n        r.children.push(copyRouter(r,router.children[i]))\n    }\n    return r\n}\nfunction matchRouter(matchedRouter:InnerRouter):{name:string,value:string}[]{\n    let vinallaUrl=location.pathname\n    while(vinallaUrl.endsWith(\"/\")){\n        vinallaUrl=vinallaUrl.substr(0,vinallaUrl.length-1)\n    }\n    let vinallaSlice=vinallaUrl.split(\"/\");\n    for(let i=0;i<matchedRouter.fullUrls.length;i++){\n        let matchedUrl=matchedRouter.fullUrls[i];\n        let matchedSlice=matchedUrl.split(\"/\");\n        if(vinallaSlice.length!=matchedSlice.length)\n            continue;\n        let params:{name:string,value:string}[]=[];\n        for(var j=0;j<matchedSlice.length;j++){\n            if(/^\\:(\\w+)$/.test(matchedSlice[j]) ){\n                if(vinallaSlice[j]!=\"\"){\n                    let name=RegExp.$1\n                    params.push({name:name,value:vinallaSlice[j]})\n                    continue;\n                }else{\n                    break\n                }\n            }\n            if(matchedSlice[j]==vinallaSlice[j]){\n                continue;\n            }\n            break;\n        }\n        if(j==matchedSlice.length){\n            let requireParams=matchedRouter.params;\n            let searchParams=getSearchParams();\n            params=params.concat(searchParams);\n            requireParams.forEach(rp=>{\n                let exist=params.find(p=>p.name==rp.name);\n                if(exist==null && rp.required){\n                    throw new Error(\"router match failed,no matched params:\"+rp.name);\n                }\n            })\n            return params;\n        }\n    }\n    return null;\n}\nfunction getSearchParams():{name:string,value:string}[]{\n    let searchSlice=location.search.split(\"?\")\n    let res:{name:string,value:string}[]=[]\n    if(searchSlice.length==2){\n        let params=searchSlice[1].split(\"&\")\n        params.forEach(p=>{\n            let name_value=p.split(\"=\")\n            if(name_value.length==2){\n                res.push({name:name_value[0],value:name_value[1]})\n            }\n        })\n    }\n    return res\n}\nfunction getLeaf(router:InnerRouter):InnerRouter[]{\n    if(router.marked)\n        return []\n    if(router.children.length==0){\n        router.marked=true\n        return [router];\n    }\n    \n    let res:InnerRouter[]=[]\n    router.children.forEach(child=>{\n        res=res.concat(getLeaf(child))\n    })\n    if(res.length==0){\n        router.marked=true\n        return [router];\n    }\n    return res\n}\nfunction clearMark(router:InnerRouter){\n    router.children.forEach(child=>{\n        clearMark(child)\n    })\n    router.marked=false\n}\nfunction matchUrl(){\n    appRouters.forEach(r=>clearMark(r))\n\n    let routers:InnerRouter[]=[]\n\n    while(true){\n        let res:InnerRouter[]=[]\n        appRouters.forEach(r=>{\n            res=res.concat(getLeaf(r))\n        })\n        if(res.length==0){\n            break\n        }else{\n            routers=routers.concat(res)\n        }\n    }\n\n    let redirect=false\n    for(let i=0;i<routers.length;i++){\n        let router=routers[i]\n        if(router.redirect!=null){\n            window.history.replaceState(null,\"\",router.redirect)\n            redirect=true\n            break\n        }\n        let params=matchRouter(router)\n        if(params!=null){\n            SetActiveRouter(location.pathname,params)\n            matchedRouter=[router]\n            let parent=router.parent\n            while(parent!=null){\n                matchedRouter.unshift(parent)\n                parent=parent.parent\n            }\n            break\n        }\n    }\n    if(redirect){\n        matchUrl()\n    }\n}\nexport function NextRouter(vnode:VNode,name?:string):string{\n    if(appRouters==null){\n        throw new Error(\"no router specified\")\n    }\n    if(cursor==-1){\n        matchUrl()\n        firstVNode=vnode\n        cursor=0\n    }\n    if(cursor<matchedRouter.length){\n        let component=name?matchedRouter[cursor].components[name]:matchedRouter[cursor].component\n        cursor++\n        return component\n    }else{\n        throw new Error(\"router match failed\")\n    }\n    \n}\nexport function MoveBack(){\n    cursor--\n}\nexport interface Router extends _Router{\n    url?: string\n}\nexport interface _Router{\n    urls?:string[]\n    component?: string\n    components?:{[name:string]:string}\n    children?:Router[]\n    params?:{name:string,required:boolean}[],\n    redirect?:string\n}\ninterface InnerRouter extends _Router{\n    parent:InnerRouter\n    children:InnerRouter[]\n    fullUrls:string[],\n    marked:boolean\n}\n\nexport function NotifyUrlChange(){\n    matchUrl()\n    firstVNode.OnRouterChange()\n    RefreshApp()\n}\n\n\n","import { GetActiveRouter } from \"../router/router-state\";\nimport { VNode } from \"../vnode/vnode\";\nimport { OnDataChange, RouterState, DomStatus } from './../models';\nimport {ReactiveData, ReactiveComputed} from \"../observer/observer\"\nimport {EvalExp} from \"../eval\"\nimport { Watcher } from \"../observer/watcher\";\nexport abstract class Mvvm {\n    private $data:any={}\n    protected $namespace=\"default\"\n\n    protected $treeRoot:VNode\n    \n    protected $dataItems:{name:string,value:any}[]=[]\n    protected $computeItems:{name:string,get:()=>any}[]=[]\n    private $isroot=false\n\n    protected get $router():RouterState{\n        return {\n            active:GetActiveRouter(),\n            cur:null\n        }\n    }\n\n    constructor(){\n    }\n    $initialize(){\n        this.$dataItems=this.$InitDataItems()\n        this.$computeItems=this.$InitComputeItems()\n        this.$treeRoot=this.$InitTreeroot()\n        this.$namespace=this.$InitNamespace()\n\n        this.$dataItems.forEach(item=>{\n            this.$data[item.name]=item.value\n            Object.defineProperty(this,item.name,{\n                get:()=>{\n                    return this.$data[item.name]\n                },\n                set:(value:any)=>{\n                    this.$data[item.name]=value\n                }\n            })\n        })\n        ReactiveData(this.$data)\n\n        this.$computeItems.forEach(item=>{\n            ReactiveComputed(this,this.$treeRoot,item.name,item.get)\n        })\n\n    }\n    $AttachChildren(){\n        this.$treeRoot.AttachChildren()\n    }\n    \n    $GetExpOrFunValue(expOrFunc:string|Function):any{\n        let res:any;\n        if(typeof expOrFunc == \"string\"){\n            res=EvalExp(this,expOrFunc)\n        }\n        if(typeof expOrFunc ==\"function\"){\n            res=expOrFunc.call(this)\n        }\n        return res;\n    }\n    $ExtendMvvm():Mvvm{return this;}\n    \n    $SetValue(exp:string,value:any){\n        let keys=exp.split(\".\")\n        let target=this.$data\n        let hasTraget=true\n        for(let i=0;i<keys.length-1;i++){\n            if(target!=null)\n                target=target[keys[i]]\n            else{\n                hasTraget=false\n                break\n            }\n        }\n        if(hasTraget && target!=null)\n            target[keys[keys.length-1]]=value\n    }\n    $CreateWatcher(vnode:VNode,exp:string|Function,listener:OnDataChange,watchingArrayItem?:boolean){\n        new Watcher(this,vnode,exp,listener,watchingArrayItem)\n    }\n    \n    $OnDestroy(){\n        this.$treeRoot.OnRemoved()\n    }\n    $SetRoot(isroot:boolean){\n        this.$isroot=isroot\n    }\n    $IsRoot(){\n        return this.$isroot\n    }\n    $GetDataItems(){\n        return this.$dataItems\n    }\n    $GetComputedItems(){\n        return this.$computeItems\n    }\n    $Refresh(){\n        this.$treeRoot.Rerender()\n    }\n    $RevokeMethod(method:string,...params:any[]){\n        if(typeof (this as any)[method]==\"function\")\n            (this as any)[method].apply(this,params)\n        else\n            throw new Error(method +\" is not a function\")\n    }\n\n    abstract $InitDataItems():{name:string,value:any}[];\n    abstract $InitComputeItems():{name:string,get:(()=>any)}[];\n    abstract $InitNamespace():string;\n\n    abstract $Render():DomStatus;\n    \n    abstract $InitTreeroot():VNode;\n\n    \n}","import { AppMvvm } from './../mvvm/app-mvvm';\nimport { GetApp } from \"./app-manager\";\n\nlet apps:AppMvvm[]=[]\nexport function Start() {\n    let appscons=GetApp()\n    appscons.forEach(App=>{\n        let mvvm=new App()\n        mvvm.$initialize()\n        mvvm.$AttachChildren()\n        mvvm.$SetRoot(true)\n        apps.push(mvvm)\n        let content = mvvm.$Render()\n        let target=document.querySelector(mvvm.$InitEl())\n        target.parentElement.replaceChild(content.dom, target)\n    })\n    \n}\nexport function RefreshApp(){\n    apps.forEach(app=>app.$Refresh())\n}","import { REG_IN, REG_OUT, VNodeStatus } from \"../const\";\nimport { DomStatus } from '../models';\nimport { Mvvm } from \"../mvvm/mvvm\";\nimport { NewVNode, VDom } from \"../vdom/vdom\";\nimport { ComponentMvvm } from './../mvvm/component-mvvm';\nimport { PlugNode } from \"./plug-node\";\nimport { VNode } from \"./vnode\";\n\nexport class CustomNode extends VNode{\n    //输入与输出值\n    private ins_pure:{[name:string]:any}={}\n    private ins_exp:{[name:string]:string}={}\n    private outs:{[name:string]:string}={}\n\n    constructor(public Vdom:VDom,public mvvm: Mvvm,public Parent:VNode,public SurroundMvvm:ComponentMvvm) {\n        super(Vdom,mvvm,Parent)\n        if(this.Vdom){\n            for (let i = 0; i < this.Vdom.Attrs.length; i++) {\n                let name=this.Vdom.Attrs[i].Name;\n                let value=this.Vdom.Attrs[i].Value;\n                //输入\n                let ins=this.SurroundMvvm.$InitIns()\n                for(let i=0;i<ins.length;i++){\n                    let prop=ins[i]\n                    \n                    if(REG_IN.test(name) && prop.name==RegExp.$1){\n                        this.ins_exp[RegExp.$1]=value\n                        break\n                    }else{\n                        if(prop.name==name){\n                            this.ins_pure[name]=value\n                            break\n                        }\n                    }\n                }\n                //输出\n                let outs=this.SurroundMvvm.$InitOuts()\n                for(let i=0;i<outs.length;i++){\n                    let event=outs[i]\n                    \n                    if(REG_OUT.test(name) && event.name==RegExp.$1){\n                        this.outs[RegExp.$1]=value\n                        break\n                    }\n                }\n            }\n        }\n        \n    }\n    AddIns(name:string,exp:string){\n        this.ins_exp[name]=exp\n    }\n    /**获取跟slot匹配的模版内容 */\n    GetTemplate(name:string):PlugNode{\n        for(let i=0;i<this.Children.length;i++){\n            let template=this.Children[i] as PlugNode\n            if(template.templatename==name)\n                return template\n        }\n        return null\n    }\n    Render(): DomStatus[] {\n        let doms=this.SurroundMvvm.$Render()\n        this.DomSet=[doms]\n        return this.DomSet\n    }\n    \n    AttachChildren(){\n        if(this.Vdom!=null){\n            //制造中间节点管理template\n            let defaultTemplate=new PlugNode(null,this.mvvm,null,\"default\")\n            let templates:{[name:string]:VNode}={\"default\":defaultTemplate}\n            //解析子节点\n            for (let i = 0; i < this.Vdom.Children.length; i++) {\n                let childnode=this.Vdom.Children[i]\n\n                let name=childnode.GetAttr(\"slot\")\n                if(name==null || name==\"\"){\n                    name=\"default\"\n                }\n                if(templates[name]==null){\n                    templates[name]=new PlugNode(null,this.mvvm,null,name)\n                }\n                let vchild=NewVNode(childnode,templates[name].mvvm,templates[name])\n                \n                vchild.AttachChildren()\n                templates[name].Children.push(vchild)\n            }\n            for(let name in templates){\n                this.Children.push(templates[name])\n            }\n        }\n    }\n\n    GetInValue(prop:string){\n        if(this.ins_pure[prop]!=null)\n            return this.ins_pure[prop]\n        if(this.ins_exp[prop]!=null)\n            return this.mvvm.$GetExpOrFunValue(this.ins_exp[prop])\n        return null\n    }\n    GetIn(prop:string){\n        if(this.ins_pure[prop]!=null)\n            return {value:this.ins_pure[prop],const:true} \n        if(this.ins_exp[prop]!=null)\n            return {value:this.ins_exp[prop],const:false}\n        return null\n    }\n    GetOut(prop:string){\n        return this.outs[prop]\n    }\n    \n    \n    Rerender() {\n        this.SurroundMvvm.$Refresh()\n    }\n    Update(){\n        this.SurroundMvvm.$Update()\n    }\n\n    OnRemoved(){\n        this.SurroundMvvm.$OnDestroy()\n    }\n    SetStatus(status:VNodeStatus){\n        this.status=status\n        this.SurroundMvvm.$SetStatus(status)\n    }\n    Reflow(){\n    }\n}","import { VNodeStatus } from '../const';\nimport { Mvvm } from '../mvvm/mvvm';\nimport { OnDataChange } from './../models';\nimport { VNode } from './../vnode/vnode';\nimport { CleanTarget, SetTarget } from './observer';\n\n\nexport class Watcher{\n    private value:any\n    private deepRecord:any[]=[]\n\n    constructor(private mvvm:Mvvm,private vnode:VNode,public ExpOrFunc:string|Function,private cb:OnDataChange,private watchingArrayItem?:boolean){\n        this.value=this.getValue()\n        if(this.watchingArrayItem && toString.call(this.value)==\"[object Array]\"){\n            for(let i=0;i<this.value.length;i++){\n                this.deepRecord[i]=this.value[i]\n            }\n        }\n    }\n    private getValue(){\n        SetTarget(this)\n        let res=this.mvvm.$GetExpOrFunValue(this.ExpOrFunc)        \n        CleanTarget()\n        return res\n    }\n    GetVNode(){\n        return this.vnode\n    }\n    Update(){\n        if(this.vnode.GetStatus()==VNodeStatus.ACTIVE){\n            let newval=this.getValue()\n            if(this.value!=newval){\n                this.cb(newval,this.value)\n                this.value=newval\n            }else{\n                //判断数组元素是否有变化\n                if(this.watchingArrayItem && toString.call(this.value)==\"[object Array]\" ){\n                    let diff=false\n                    for(let i=0;i<newval.length;i++){\n                        if(newval[i]!=this.deepRecord[i]){\n                            this.cb(newval,this.value)\n                            diff=true\n                            break\n                        }\n                    }\n                    if(diff){\n                        this.deepRecord=[]\n                        for(let i=0;i<newval.length;i++){\n                            this.deepRecord[i]=newval[i]\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n","import { VNode } from '../vnode/vnode';\nimport { Watcher } from \"./watcher\";\nimport { Mvvm } from '../mvvm/mvvm';\nimport { WatcherCollecter } from './watcher-collect';\n\nlet $target:Watcher\n\nexport function SetTarget(target:Watcher){\n    $target=target\n}\nexport function CleanTarget(){\n    $target=null\n}\n    \nexport function ReactiveData(data:any){\n    if(data!=null && typeof data==\"object\"){\n        Object.keys(data).forEach(key=>{\n            reactiveKey(data,key)\n            ReactiveData(data[key])\n        })\n    }\n}\nfunction reactiveKey(data:any,key:string){\n    let collecter=new WatcherCollecter(key)        \n    let value = data[key]\n    if(toString.call(value)==\"[object Array]\"){\n        reactiveArray(value,collecter)\n    }\n    Object.defineProperty(data, key, {\n        get: ()=> {\n            if($target!=null){\n                collecter.AddTarget($target)\n            }\n            return value\n        },\n        set: (newval)=>{\n            if (newval != value) {\n                value=newval\n                if(toString.call(value)==\"[object Array]\"){\n                    reactiveArray(value,collecter)\n                }\n                ReactiveData(newval)                    \n                collecter.Notify()\n            }\n        },\n        enumerable:true,\n        configurable:true\n    })\n}\n    \nfunction reactiveArray(array:any[],collecter:WatcherCollecter){\n    if(array.push!=Array.prototype.push)\n        return\n    Object.defineProperty(array,\"push\",{\n        enumerable:false,\n        configurable:true,\n        value:(...params:any[])=>{\n            let old=array.length\n            let res=Array.prototype.push.call(array,...params)\n            for(let i=old;i<res;i++){\n                reactiveKey(array,\"\"+i)\n            }\n            collecter.Notify()                \n            return res\n        }\n    })\n    Object.defineProperty(array,\"pop\",{\n        enumerable:false,\n        configurable:true,\n        value:(...params:any[])=>{\n            let res=Array.prototype.pop.call(array,...params)\n            collecter.Notify()                \n            return res\n        }\n    })\n    Object.defineProperty(array,\"splice\",{\n        enumerable:false,\n        configurable:true,\n        value:(...params:any[])=>{\n            let res=Array.prototype.splice.call(array,...params)\n            if(params.length>2){\n                let newitems=params.slice(2)\n                newitems.forEach(item=>{\n                    let index=array.indexOf(item)\n                    reactiveKey(array,\"\"+index)\n                })\n            }\n            collecter.Notify()                \n            return res\n        }\n    })\n    Object.defineProperty(array,\"shift\",{\n        enumerable:false,\n        configurable:true,\n        value:(...params:any[])=>{\n            let res=Array.prototype.shift.call(array,...params)\n            collecter.Notify()                \n            return res\n        }\n    })\n}\n    \nexport function ReactiveComputed(mvvm:Mvvm,vnode:VNode,key:string,func:()=>any){\n    let collecter=new WatcherCollecter(key)\n    let firstget=true\n    let value:any\n    \n    Object.defineProperty(mvvm, key, {\n        get: ()=> {\n            if($target!=null){\n                collecter.AddTarget($target)\n            }\n            if(firstget){\n                let old=$target\n                $target=null\n                value=func.call(mvvm)\n                new Watcher(mvvm,vnode,func,(newval)=>{\n                    value=newval\n                    collecter.Notify()\n                })\n                $target=old\n                firstget=false\n            }\n            return value\n        },\n        enumerable:true,\n        configurable:true\n    })\n}\n\n","import { RouterInfo, RouterChangeCallback } from './../models';\nimport { VNode } from '../vnode/vnode';\nimport { VNodeStatus } from '../const';\n\nclass _RouterInfo implements RouterInfo{\n    constructor(public path:string,public params:{name:string,value:string}[]){\n\n    }\n    getParam(name:string):string{\n        let p=this.params.find(p=>p.name==name)\n        return p && p.value ||null\n    }\n}\n\nlet active:RouterInfo=new _RouterInfo(\"\",[])\n\nlet listeners:{cb:RouterChangeCallback,vnode:VNode}[]=[]\n\nexport function SetActiveRouter(path:string,params:{name:string,value:any}[]){\n    let old:RouterInfo=new _RouterInfo(path,params)\n    \n    active.path=path\n    active.params=params\n\n    listeners= listeners.filter(listen=>listen.vnode.GetStatus()!=VNodeStatus.DEPRECATED)\n    listeners.forEach(listen=>{\n        if(listen.vnode.GetStatus()==VNodeStatus.ACTIVE)\n            listen.cb(active,old)\n    })\n}\nexport function GetActiveRouter(){\n    return active\n}\nexport function WatchRouterChange(vnode:VNode,listener:RouterChangeCallback){\n    listeners.push({cb:listener,vnode:vnode})\n}\n\n\n","var EvalExp=function(context,exp,attachObj){\n    var res;\n    var newcontext=context\n    if(attachObj!=null){\n        newcontext=Object.assign(context,$attachObj)\n    }\n    try {\n        with(newcontext){\n            res=eval(exp)\n        }\n        return res\n    } catch (error) {\n        console.error(\"eval \"+exp+\" failed\")\n        console.error(error)\n    }\n    return \"\" \n}\n\nexports.EvalExp=EvalExp\n","import { IDirectiveConstructor } from \"../models\";\nimport { Id } from \"./components-manager\";\n\nlet repository:{[id:string]:IDirectiveConstructor}={}\n\nexport function RegisterDirective(name:string,namespace:string,constructor:IDirectiveConstructor){\n    if(repository[Id(namespace,name)]!=null)\n        throw new Error(\"directive \"+Id(namespace,name)+\" already exists\")\n    repository[Id(namespace,name)]=constructor\n}\nexport function GetDirectiveCon(name:string,namespace:string):IDirectiveConstructor{\n    name=name.toLowerCase()\n    namespace=namespace.toLowerCase()\n    let constructor=repository[Id(namespace,name)]\n    return constructor\n}\nexport function IsDirectiveRegistered(name:string,namespace:string){\n    name=name.toLowerCase()\n    namespace=namespace.toLowerCase()\n    if(repository[Id(namespace,name)]!=null)\n        return true\n    else\n        return false\n}\n","import { IAppMvvm } from './../models';\n\nlet apps:IAppMvvm[]=[]\n\nexport function RegisterApp(app:IAppMvvm){\n    apps.push(app)\n}\nexport function GetApp(){\n    return apps\n}","import { Prop } from \"../models\";\nimport { DirectiveNode } from \"../vnode/directive-node\";\nimport { VinallaNode } from './../vnode/vinalla-node';\nexport class DirectiveMVVM {\n    \n\n    $Name:string\n    $element:HTMLElement\n\n\n    $Ins:Prop[]=[]\n    $Outs:string[]=[]\n\n    $InitFuncs:string[]=[]\n    $DestroyFuncs:string[]=[]\n    \n\n    constructor(private $directive:DirectiveNode,private $vnode:VinallaNode){\n    }\n    \n    \n    $OnDestroy(){\n        this.$DestroyFuncs.forEach(destroy=>{\n            (this as any)[destroy].call(this)\n        })\n    }\n    \n    $Render(){\n        this.$element=(this.$vnode.DomSet[0].dom as HTMLElement)\n        this.$InitFuncs.forEach(init=>{\n            (this as any)[init].call(this)\n        })\n        this.$Ins.forEach(prop=>{\n            let inName=this.$directive.GetIn(prop.name)\n            if(inName==null && prop.required){\n                throw new Error(\"component \\'\"+this.$Name+\"\\' need prop \\'\"+prop.name)\n            }\n            if(inName!=null){\n                if(inName.const){\n                    (this as any)[prop.name]=inName.value\n                }else{\n                    let newvalue=this.$vnode.mvvm.$GetExpOrFunValue(inName.value)\n                    this.$checkProp(prop,newvalue);\n                    (this as any)[prop.name]=newvalue\n\n                    this.$vnode.mvvm.$CreateWatcher(this.$vnode,inName.value,(newvalue:any,oldvalue:any)=>{\n                        this.$checkProp(prop,newvalue);\n                        (this as any)[prop.name]=newvalue\n                    });\n                }\n            }\n        })\n    }\n    private $checkProp(prop:Prop,value:any){\n        let error=(name:string,prop:string,type:string)=>{\n            throw new Error(\"component \\'\"+name+\"\\' prop \\'\"+prop+\"\\' not receive \"+type)\n        }\n        if(prop.type==\"array\" && toString.call(value)!=\"[object Array]\"){\n            error(this.$Name,prop.name,prop.type)\n        }\n        if(prop.type==\"object\" && toString.call(value)!=\"[object Object]\"){\n            error(this.$Name,prop.name,prop.type)\n        }\n        if(prop.type==\"number\" && toString.call(value)!=\"[object Number]\"){\n            error(this.$Name,prop.name,prop.type)\n        }\n        if(prop.type==\"boolean\" && toString.call(value)!=\"[object Boolean]\"){\n            error(this.$Name,prop.name,prop.type)\n        }\n        if(prop.type==\"string\" && toString.call(value)!=\"[object String]\"){\n            error(this.$Name,prop.name,prop.type)\n        }\n    }\n}","import { NotifyUrlChange } from '../router/router-manager';\nimport { VNode } from '../vnode/vnode';\nimport { Mvvm } from './mvvm';\nimport { DomStatus } from '../models';\nexport class AppMvvm extends Mvvm{\n    protected $el:string=\"\"\n    \n    $NavigateTo(url:string){\n        window.history.replaceState(null,null,url)\n        NotifyUrlChange()\n    }\n    $Render(): DomStatus {\n        let doms=this.$treeRoot.Render()\n        return doms[0]\n    }\n    \n    $InitNamespace(): string {\n        throw new Error(\"Method not implemented.\");\n    }\n    $InitDataItems(): {name:string,value:any}[] {\n        throw new Error(\"Method not implemented.\");\n    }\n    $InitComputeItems(): { name: string; get: () => any }[] {\n        throw new Error(\"Method not implemented.\");\n    }\n\n    $InitTreeroot(): VNode {\n        throw new Error(\"Method not implemented.\");\n    }\n    $InitEl():string{\n        throw new Error(\"Method not implemented.\");\n    }\n}","import { DomStatus, Event, Prop } from \"../models\";\nimport { TypeOf } from \"../util\";\nimport { CustomNode } from \"../vnode/custom-node\";\nimport { VNode } from \"../vnode/vnode\";\nimport { VNodeStatus } from './../const';\nimport { Mvvm } from './mvvm';\nexport class ComponentMvvm extends Mvvm{\n    \n\n    private $fenceNode:CustomNode\n    private $name:string=\"\"\n    \n    private $ins:Prop[]=[]\n    private $outs:Event[]=[]\n\n    \n    $initialize(){\n        super.$initialize()\n\n        this.$ins=this.$InitIns()\n        this.$outs=this.$InitOuts()\n        this.$name=this.$InitName()\n\n        this.$ins.forEach(prop=>{\n            let inName=this.$fenceNode.GetIn(prop.name)\n            if(inName==null && prop.required){\n                throw new Error(\"component \\'\"+this.$name+\"\\' need prop \\'\"+prop.name)\n            }\n            if(inName!=null){\n                if(inName.const){\n                    (this as any)[prop.name]=inName.value\n                }else{\n                    Object.defineProperty(this,prop.name,{\n                        get:()=>{\n                            let newvalue=this.$fenceNode.mvvm.$GetExpOrFunValue(inName.value);\n                            this.$checkProp(prop,newvalue);\n                            return newvalue;\n                        }\n                    })\n                }\n            }\n        })\n\n        \n    }\n    \n    private $checkProp(prop:Prop,value:any){\n        let error=(name:string,prop:string,type:string)=>{\n            throw new Error(\"component \\'\"+name+\"\\' prop \\'\"+prop+\"\\' not receive \"+type)\n        }\n        if(prop.type==\"array\" && toString.call(value)!=\"[object Array]\"){\n            error(this.$name,prop.name,prop.type)\n        }\n        if(prop.type==\"object\" && toString.call(value)!=\"[object Object]\"){\n            error(this.$name,prop.name,prop.type)\n        }\n        if(prop.type==\"number\" && toString.call(value)!=\"[object Number]\"){\n            error(this.$name,prop.name,prop.type)\n        }\n        if(prop.type==\"boolean\" && toString.call(value)!=\"[object Boolean]\"){\n            error(this.$name,prop.name,prop.type)\n        }\n        if(prop.type==\"string\" && toString.call(value)!=\"[object String]\"){\n            error(this.$name,prop.name,prop.type)\n        }\n    }\n\n    $Render():DomStatus{\n        let doms=this.$treeRoot.Render()\n        return doms[0]\n    }\n    \n    $Update(){\n        this.$treeRoot.Update()\n    }\n    $SetStatus(status:VNodeStatus){\n        this.$treeRoot.SetStatus(status)\n    }\n    \n    \n    $Emit(event:string,...data:any[]){\n        if(this.$fenceNode!=null && this.$fenceNode.mvvm!=null){\n            let e=this.$outs.find(out=>{\n                return out.name==event;\n            });\n            if(e==null){\n                throw new Error(\"no specified event \"+event+\" at component \"+this.$namespace+\"::\"+this.$name)\n            }\n            if(data.length!=e.paramsType.length){\n                throw new Error(\"no specified params \"+event+\" at component \"+this.$namespace+\"::\"+this.$name)\n            }\n            for(let i=0;i<e.paramsType.length;i++){\n                if(TypeOf(data[i])!=e.paramsType[i]){\n                    throw new Error(\"params expected \"+e.paramsType[i]+\",but received \"+toString.call(data[i])+\" at component \"+this.$namespace+\"::\"+this.$name)\n                }\n            }\n            let method=this.$fenceNode.GetOut(event)\n            this.$fenceNode.mvvm.$RevokeMethod(method,...data)\n        }\n    };\n    \n    $OnRouterChange(){\n        this.$treeRoot.OnRouterChange()\n    }\n    $GetFenceNode(){\n        return this.$fenceNode\n    }\n    $SetFenceNode(node:CustomNode){\n        this.$fenceNode=node\n    }\n\n    \n    $InitNamespace(): string {\n        throw new Error(\"Method not implemented.\");\n    }\n    $InitDataItems(): {name:string,value:any}[] {\n        throw new Error(\"Method not implemented.\");\n    }\n    $InitComputeItems(): { name: string; get: () => any }[] {\n        throw new Error(\"Method not implemented.\");\n    }\n    $InitName():string{\n        throw new Error(\"Method not implemented.\");\n    }\n    $InitIns():Prop[]{\n        throw new Error(\"Method not implemented.\");\n    }\n    $InitOuts():Event[]{\n        throw new Error(\"Method not implemented.\");\n    }\n    $InitTreeroot(): VNode {\n        throw new Error(\"Method not implemented.\");\n    }\n    $GetIns(){\n        return this.$ins\n    }\n}","import { DirectiveOption, IDirectiveConstructor } from \"../models\";\nimport { FetchProperty } from \"./property\";\nimport { RegisterDirective } from \"../manager/directive-manager\";\nimport { VNode } from \"../vnode/vnode\";\nimport { DirectiveNode } from \"../vnode/directive-node\";\n\nexport function Directive(option:DirectiveOption){\n    checkDirectiveOption(option)\n    let res=FetchProperty()\n    return function(target:IDirectiveConstructor){\n        let constructor= class $DirectiveMvvm extends target{\n            $Name=option.name\n            $Namespace=option.namespace\n            $Ins=res.props\n            $Out=option.events\n            $InitFuncs=res.initFuncs\n            $DestroyFuncs=res.destroyFuncs\n            constructor(directive:DirectiveNode,vnode:VNode){\n                super(directive,vnode)\n            }\n        }\n        RegisterDirective(option.name,option.namespace,constructor)\n    }\n}\nfunction checkDirectiveOption(option:DirectiveOption){\n    option.events=option.events?option.events:[]\n    option.namespace=option.namespace?option.namespace:\"default\"\n}","import { RegisterApp } from \"../manager/app-manager\";\nimport { AppOption, IAppMvvm } from \"../models\";\nimport { NewVNode, TraverseDom } from \"../vdom/vdom\";\nimport { VNode } from \"../vnode/vnode\";\nimport { FetchProperty } from \"./property\";\n\n\n\nexport function App(option:AppOption){\n    checkAppOption(option)\n    let res=FetchProperty()\n    return function(target:IAppMvvm){\n        let constructor= class $AppMvvm extends target{\n            \n            $InitFuncs:string[]=res.initFuncs\n            $DestroyFuncs:string[]=res.destroyFuncs\n            \n            $initialize(){\n                super.$initialize()\n                this.$InitFuncs.forEach(init=>{\n                    (this as any)[init].call(this)\n                })\n            }\n            $OnDestroy(){\n                super.$OnDestroy()\n                this.$DestroyFuncs.forEach(destroy=>{\n                    (this as any)[destroy].call(this)\n                })\n            }\n            $InitTreeroot(): VNode {\n                let dom=document.querySelector(option.el)\n                if(dom==null){\n                    throw new Error(\"no specified element \"+option.el)\n                }\n                let vdom=TraverseDom(dom)\n                let vnode=NewVNode(vdom,this,null)\n                return vnode\n            }\n            $InitNamespace(): string {\n                return option.namespace\n            }\n            $InitDataItems(): {name:string,value:any}[] {\n                let datas:{name:string,value:any}[]=[]\n                res.datas.forEach(item=>{\n                    datas.push({name:item,value:(this as any)[item]})\n                })\n                return datas\n            }\n            $InitComputeItems(): { name: string; get: () => any }[] {\n                return res.computes\n            }\n            $InitEl(){\n                return option.el\n            }\n            \n        }\n        RegisterApp(constructor)\n    }\n}\nfunction checkAppOption(option:AppOption){\n    option.namespace=option.namespace?option.namespace:\"default\"\n}","import { DomStatus } from '../models';\nimport { Mvvm } from \"../mvvm/mvvm\";\nimport { VDom } from \"../vdom/vdom\";\nimport { VNode } from \"./vnode\";\n\nexport class PlugNode extends VNode{\n    constructor(protected vdom:VDom,public mvvm: Mvvm,public Parent:VNode,public templatename:string) {\n        super(vdom,mvvm,Parent)\n    }\n    \n    Render():DomStatus[]{\n        this.Children.forEach(child=>{\n            let doms=child.Render()\n            this.DomSet=this.DomSet.concat(doms)\n        })\n        return this.DomSet\n    }\n    \n    Update(){\n        let children: VNode[] = []\n        this.Children.forEach(child => {\n            children.push(child)\n        })\n        children.forEach(child => {\n            child.Update()\n        })\n    }\n    \n}","import { DomType } from './../const';\nimport { VNode } from \"./vnode\";\nimport { Mvvm } from \"../mvvm/mvvm\";\nimport { CustomNode } from \"./custom-node\";\nimport { InitComponent } from \"../manager/components-manager\";\nimport { GetNS } from '../util';\nimport { VDom } from '../vdom/vdom';\nimport { NextRouter, MoveBack } from \"../router/router-manager\";\nimport { DomStatus } from '../models';\n\nexport class RouterNode extends VNode{\n\n    constructor(public Vdom:VDom,public mvvm: Mvvm,public Parent:VNode) {\n        super(Vdom,mvvm,Parent)\n    }\n\n    Render() :DomStatus[]{\n        let router=NextRouter(this)\n        if(router!=null){\n            let vnode=this.instance(router)\n            this.Children=[vnode]\n            this.DomSet=vnode.Render()\n            MoveBack()\n        }\n        return this.DomSet\n        \n    }\n    OnRouterChange(){\n        let router=NextRouter(this)\n        if(router!=null){\n            let vnode=this.instance(router)\n            this.Children=[vnode]\n            this.DomSet.forEach(dom=>dom.type=DomType.DELETE)\n            this.DomSet= this.DomSet.concat(vnode.Render())\n            this.Parent.Reflow();\n            MoveBack()\n        }else{\n            this.Children=[]\n            this.DomSet.forEach(dom=>{\n                dom.type=DomType.DELETE\n            })\n        }\n    }\n    \n    private instance(componentStr:string):VNode{\n\n        let ns=GetNS(componentStr)\n        if(ns.namespace==null)\n            ns.namespace=\"default\"\n        let construct=InitComponent(ns.value,ns.namespace)\n        \n        if(construct==null){\n            throw new Error(`router can not find component name:${ns.value},namespace:${ns.namespace}`)\n        }\n        let mvvm=new construct()\n        let custnode=new CustomNode(null,this.mvvm,null,mvvm)\n        mvvm.$SetFenceNode(custnode)\n\n        mvvm.$initialize()\n        mvvm.$AttachChildren()\n        \n        return custnode\n    }\n    Update(){\n\n    }\n    Reflow(){\n    }\n}\n","import { DomStatus } from './../models';\nimport { VNode } from \"./vnode\";\n\nexport class TemplateNode extends VNode{\n    Render():DomStatus[]{\n        this.Children.forEach(child=>{\n            this.DomSet=this.DomSet.concat(child.Render())\n        })\n        return this.DomSet;\n    }\n    Update(){\n\n    }\n}","import { DomType } from './../const';\nimport { Mvvm } from \"../mvvm/mvvm\";\nimport { VNode } from \"./vnode\";\nimport { VDom, NewVNode, Priority } from \"../vdom/vdom\";\nimport { VNodeStatus } from \"../const\";\nimport { DomStatus } from '../models';\n\nexport class IfNode extends VNode {\n    constructor(public Vdom:VDom,public mvvm: Mvvm, public Parent: VNode, private ifExp: string) {\n        super(Vdom,mvvm, Parent)\n    }\n    \n    AttachChildren() {\n        let boolvalue=this.mvvm.$GetExpOrFunValue(this.ifExp)\n        if(boolvalue){\n            let vnode=NewVNode(this.Vdom,this.mvvm,null,Priority.NORMAL)\n            vnode.AttachChildren()\n            this.Children=[vnode]\n        }\n    }\n    Render():DomStatus[]{\n        this.Children.forEach(child=>{\n            this.DomSet=this.DomSet.concat(child.Render())\n        })\n        this.mvvm.$CreateWatcher(this,this.ifExp, newvalue=>this.reImpletement(newvalue))\n        return this.DomSet\n    }\n    Update(){\n        let attached = this.mvvm.$GetExpOrFunValue(this.ifExp)\n        this.reImpletement(attached)\n    }\n\n    private reImpletement(newvalue:boolean){\n        if (newvalue) {\n            let vnode=NewVNode(this.Vdom,this.mvvm,null,Priority.NORMAL)\n            vnode.AttachChildren()\n            this.Children=[vnode]\n            this.Children.forEach(child=>{\n                this.DomSet=this.DomSet.concat(child.Render())\n            })\n            this.Parent.Reflow();\n        }else{\n            this.Children=[]\n            this.DomSet.forEach(dom=>{\n                dom.type=DomType.DELETE\n            })\n        }\n    }\n\n    OnRemoved(){\n        if(this.Children.length>0)\n            this.Children[0].OnRemoved()\n    }\n    SetStatus(status:VNodeStatus){\n        this.status=status\n        if(this.Children.length>0)\n            this.Children[0].SetStatus(status)\n    }\n    \n}","import { Watcher } from './watcher';\nimport {RefreshApp} from \"../manager/start\"\n\nlet queue:Watcher[]=[]\nlet settimeout=false\nexport function AddWatcher(watcher:Watcher){\n    if(queue.indexOf(watcher)==-1)\n        queue.push(watcher)\n    if(!settimeout){\n        settimeout=true\n        \n        setTimeout(() => {\n            RevokeWatcher()\n            settimeout=false            \n        }, 0);\n    }\n}\nexport function RevokeWatcher(){\n    let temp:Watcher[]=[]\n    queue.forEach(q=>temp.push(q))\n    queue=[]\n    temp.forEach(watcher=>watcher.Update())\n    if(queue.length>0){\n        RevokeWatcher()\n    }else{\n        RefreshApp()\n    }\n}","import { Watcher } from \"./watcher\";\nimport { AddWatcher } from \"./msg-queue\";\nimport { VNodeStatus } from \"../const\";\n\nexport class WatcherCollecter{\n    private watches:Watcher[]=[]\n    constructor(private key:string){\n    }\n    GetKey(){\n        return this.key\n    }\n    AddTarget(watcher:Watcher){\n        if(this.watches.indexOf(watcher)==-1)\n            this.watches.push(watcher)\n    }\n    \n    Notify(){\n        this.watches=this.watches.filter(watcher=>{\n            if(watcher.GetVNode().GetStatus()==VNodeStatus.ACTIVE ){\n                AddWatcher(watcher)\n                return true\n            }\n            if(watcher.GetVNode().GetStatus()==VNodeStatus.INACTIVE )\n                return true\n            if(watcher.GetVNode().GetStatus()==VNodeStatus.DEPRECATED )\n                return false\n        })\n    }\n}","import { DomType } from './const';\nimport { AppMvvm } from './mvvm/app-mvvm';\nimport { ComponentMvvm } from './mvvm/component-mvvm';\nimport { DirectiveMVVM } from './mvvm/directive-mvvm';\nimport { VDom } from './vdom/vdom';\nimport { DirectiveNode } from './vnode/directive-node';\nimport { VNode } from './vnode/vnode';\n\ninterface BaseOption{\n    namespace?:string,\n}\nexport interface ComponentOption extends BaseOption{\n    events?:Event[],\n    name:string,\n    template?:string,\n    templateUrl?:string,\n    style?:string,\n    styleUrl?:string\n    \n}\nexport interface AppOption extends BaseOption{\n    el:string\n}\nexport interface DirectiveOption extends BaseOption{\n    name:string\n    events?:string[]\n}\n\nexport type ParamType=\"array\"|\"object\"|\"number\"|\"string\"|\"boolean\"\nexport interface Prop{\n    name:string\n    required:boolean\n    type?:ParamType\n}\nexport interface Event{\n    name:string,\n    paramsType:ParamType[]\n}\nexport interface OnDataChange {\n    (newvalue:any,oldvalue:any):void\n}\n/**for语句 */\nexport class ForExp{\n    constructor(public itemExp:string,public arrayExp:string){}\n}\n\n\n\nexport interface IComponentMvvm{\n    new ():ComponentMvvm\n}\nexport interface IAppMvvm{\n    new ():AppMvvm\n}\nexport interface IDirectiveConstructor{\n    new (directive:DirectiveNode,vnode:VNode):DirectiveMVVM\n}\nexport interface ComponentMvvmFactoryOption {\n    $constructor:IComponentMvvm\n    $preProcess:boolean\n    $id:string,\n    $domtree:VDom,\n    $origin:ComponentOption\n}\nexport interface RouterInfo{\n    path:string,\n    params:{\n        name:string,\n        value:string\n    }[],\n    getParam(name:string):string\n}\nexport interface RouterState{\n    active:RouterInfo,\n    cur:RouterInfo\n}\nexport type RouterChangeCallback=(newrouter:RouterInfo,oldrouter:RouterInfo)=>void\n\nexport interface DomStatus{\n    dom:Node,\n    type:DomType\n}","import { VNodeStatus } from \"../const\";\nimport { EvalExp } from '../eval';\nimport { DomStatus, ForExp } from \"../models\";\nimport { Mvvm } from '../mvvm/mvvm';\nimport { NewVNode, Priority, VDom } from '../vdom/vdom';\nimport { DomType } from './../const';\nimport { VNode } from \"./vnode\";\nimport { TemplateNode } from \"./template-node\";\n\nexport class ForNode extends VNode{\n    public ForExp:ForExp\n    constructor(public Vdom:VDom,public mvvm: Mvvm,public Parent:VNode,private originForExp:string) {\n        super(Vdom,mvvm,Parent)\n        let forSplit=this.originForExp.trim().split(/\\s+/)\n        this.ForExp=new ForExp(forSplit[0],forSplit[2]) \n    }\n    private newCopyNode(n:number){\n        let itemexp=this.ForExp.itemExp;\n        let itemexpValue=this.ForExp.arrayExp+\"[\"+n+\"]\";\n        let that=this;\n        let mvvm=new (class extends Mvvm{\n            $InitDataItems(): { name: string; value: any; }[] {\n                return [];\n            }\n            $InitComputeItems(): { name: string; get: () => any; }[] {\n                return [];\n            }\n            $Render(): DomStatus {\n                return null;\n            }\n            protected $hirented=that.mvvm;\n            $InitTreeroot(): VNode {\n                return null;\n            }\n            $InitNamespace(): string {\n                return that.mvvm.$InitNamespace();\n            }\n            $GetExpOrFunValue(exp:string):any{\n                let mvvm=this.$ExtendMvvm()\n                return EvalExp(mvvm,exp)\n            }\n            $ExtendMvvm(){\n                let mvvm=that.mvvm.$ExtendMvvm();\n                Object.defineProperty(mvvm,itemexp,{\n                    get:function(){\n                        return mvvm.$GetExpOrFunValue(itemexpValue);\n                    },\n                    enumerable:true,\n                    configurable:true\n                });\n                Object.defineProperty(mvvm,\"$index\",{\n                    value:n,\n                    configurable:true,\n                    enumerable:true\n                })\n                \n                return mvvm\n            }\n            $RevokeMethod(method:string,...params:any[]){\n                let mvvm=this.$ExtendMvvm();\n                mvvm.$RevokeMethod(method,...params);\n            }\n        });\n        let vnode=NewVNode(this.Vdom,mvvm,this,Priority.IF);\n        vnode.AttachChildren();\n        return vnode;\n    }\n    private implementForExp(newcount:number){\n        if(newcount>this.Children.length){\n            let custnodes:TemplateNode[]=[]\n            for(let i=this.Children.length;i<newcount;i++){       \n                let custnode=this.newCopyNode(i)\n                custnodes.push(custnode)\n            }\n            custnodes.forEach(custnode=>{\n                this.Children.push(custnode)                    \n                this.DomSet=this.DomSet.concat(custnode.Render())\n            })\n            this.Parent.Reflow()\n            return\n        }\n        if(newcount<this.Children.length){\n            let moved=this.Children.splice(newcount)\n            moved.forEach(moveditem=>{\n                this.DomSet.forEach(dom=>{\n                    let exist=moveditem.DomSet.some(moveddom=>{\n                        return moveddom.dom==dom.dom\n                    })\n                    if(exist){\n                        dom.type=DomType.DELETE\n                    }\n                })\n            })\n            \n            moved.forEach(vnode=>vnode.SetStatus(VNodeStatus.DEPRECATED))\n            moved.forEach(item=>{\n                item.OnRemoved()\n            })\n        }\n    }\n    \n    Update(){\n        let items=this.mvvm.$GetExpOrFunValue(this.ForExp.arrayExp)\n        if(toString.call(items) === \"[object Array]\"){\n            this.implementForExp(items.length)\n        }\n    }\n    AttachChildren() {\n        let num=this.mvvm.$GetExpOrFunValue(this.ForExp.arrayExp+\".length\")\n        for(let i=0;i<num;i++){\n            this.Children.push(this.newCopyNode(i))\n        }\n    }\n    Render():DomStatus[]{\n        this.mvvm.$CreateWatcher(this,this.ForExp.arrayExp+\".length\",this.implementForExp.bind(this))\n\n        this.Children.forEach(child=>{\n            this.DomSet=this.DomSet.concat(child.Render())\n        })\n        return this.DomSet;\n    }\n    OnRemoved(){\n        this.Children.forEach(vnode=>vnode.OnRemoved())\n    }\n    SetStatus(status:VNodeStatus){\n        this.status=status\n        this.Children.forEach(vnode=>vnode.SetStatus(status))\n    }\n    \n}","import { VNodeStatus } from \"../const\";\nimport { DomStatus } from '../models';\nimport { VDom } from \"../vdom/vdom\";\nimport { ComponentMvvm } from './../mvvm/component-mvvm';\nimport { VNode } from \"./vnode\";\n\nexport class SlotNode extends VNode{\n    constructor(protected vdom:VDom,public mvvm: ComponentMvvm, public Parent: VNode, private name: string) {\n        super(vdom,mvvm,Parent)\n        if(this.name==null || this.name==\"\")\n            this.name=\"default\"\n    }\n    Render(): DomStatus[] {\n        let template=this.mvvm.$GetFenceNode().GetTemplate(this.name)\n        if(template!=null){\n            template.Parent=this;\n            this.Children=[template];\n            this.DomSet=template.Render();\n        }\n        return this.DomSet;\n    }\n    \n    Update(){\n        let template=this.mvvm.$GetFenceNode().GetTemplate(this.name)\n        if(template!=null){\n            template.Update()\n        }\n    }\n    SetStatus(status:VNodeStatus){\n        this.status=status\n        let template=this.mvvm.$GetFenceNode().GetTemplate(this.name)\n        template.SetStatus(status)\n    }\n    OnRemoved(){\n        let template=this.mvvm.$GetFenceNode().GetTemplate(this.name)\n        template.OnRemoved()\n    }\n    \n}","import { REG_IN, REG_OUT } from '../const';\nimport { VDom } from '../vdom/vdom';\n\nexport class DirectiveNode {\n    //输入与输出值\n    protected ins_pure: { [name: string]: any } = {}\n    protected ins_exp: { [name: string]: string } = {}\n    protected outs: { [name: string]: string } = {}\n\n    constructor(private vdom:VDom) {\n        this.vdom.Attrs.forEach(attr=>{\n            this.addProperty(attr.Name,attr.Value)\n        })\n    }\n    private addProperty(name: string, value: string):boolean{\n        //输入\n        if(REG_IN.test(name)){\n            this.ins_exp[RegExp.$1]=value\n            return\n        }\n        //输出\n        if(REG_OUT.test(name) ){\n            this.outs[RegExp.$1]=value\n            return\n        }\n        this.ins_pure[name]=value\n        return\n    }\n    GetIn(prop:string){\n        if(this.ins_pure[prop]!=null)\n            return {value:this.ins_pure[prop],const:true} \n        if(this.ins_exp[prop]!=null)\n            return {value:this.ins_exp[prop],const:false}\n\n        return null\n    }\n    GetOut(prop:string){\n        return this.outs[prop]\n    }\n}","import { VinallaNode } from './../vnode/vinalla-node';\nimport { LogError } from '../util';\nexport function Classes(exp:string,vnode:VinallaNode,isconst:boolean){\n    if(isconst){\n        let hacked=\"var a=\"+exp+\";a\";\n        let classes:any;\n        try {\n            classes=eval(hacked);\n        } catch (error) {\n            LogError(\"json format error:\"+exp)\n            return;\n        }\n        for(let key in classes){\n            let istrue=vnode.mvvm.$GetExpOrFunValue(key);\n            if(istrue){\n                (vnode.DomSet[0].dom as HTMLElement).classList.add(classes[key]);\n            }\n            vnode.mvvm.$CreateWatcher(vnode,key,(newvalue)=>{\n                if(newvalue){\n                    (vnode.DomSet[0].dom as HTMLElement).classList.add(classes[key]);\n                }else{\n                    (vnode.DomSet[0].dom as HTMLElement).classList.remove(classes[key]);\n                }\n            })\n        }\n    }\n}","import { VinallaNode } from './../vnode/vinalla-node';\nimport { LogError } from '../util';\nexport function Style(exp:string,vnode:VinallaNode,isconst:boolean){\n    if(isconst){\n        let hacked=\"var a=\"+exp+\";a\";\n        let styleexp:any;\n        try {\n            styleexp=eval(hacked);\n        } catch (error) {\n            LogError(\"json format error:\"+exp)\n            return;\n        }\n        \n        for(let key in styleexp){\n            let istrue=vnode.mvvm.$GetExpOrFunValue(key);\n            let styles=styleexp[key];\n            if(istrue){\n                for(let stylename in styles){\n                    ((vnode.DomSet[0].dom as HTMLElement).style as any)[stylename]=styles[stylename];\n                }\n            }\n            vnode.mvvm.$CreateWatcher(vnode,key,(newvalue)=>{\n                if(newvalue){\n                    for(let stylename in styles){\n                        ((vnode.DomSet[0].dom as HTMLElement).style as any)[stylename]=styles[stylename];\n                    }\n                }else{\n                    for(let stylename in styles){\n                        ((vnode.DomSet[0].dom as HTMLElement).style as any)[stylename]=\"\";\n                    }\n                }\n            })\n        }\n    }\n}","import { VinallaNode } from './../vnode/vinalla-node';\nimport { StrToEvalstr } from \"../util\";\n\nexport function Html(exp:string,vnode:VinallaNode,noBracket:boolean){\n    if(noBracket){\n        let strEval=StrToEvalstr(exp);\n        if(strEval.isconst)\n            (vnode.DomSet[0].dom as HTMLElement).innerHTML=strEval.exp;\n        else{\n            let newvalue=vnode.mvvm.$GetExpOrFunValue(strEval.exp);\n            (vnode.DomSet[0].dom as HTMLElement).innerHTML=newvalue;\n            vnode.mvvm.$CreateWatcher(vnode,strEval.exp,newvalue=>{\n                (vnode.DomSet[0].dom as HTMLElement).innerHTML=newvalue\n            })\n        }\n    }else{\n        let newvalue=vnode.mvvm.$GetExpOrFunValue(exp);\n        (vnode.DomSet[0].dom as HTMLElement).innerHTML=newvalue;\n        vnode.mvvm.$CreateWatcher(vnode,exp,newvalue=>{\n            (vnode.DomSet[0].dom as HTMLElement).innerHTML=newvalue\n        })\n    }\n}","import { VinallaNode } from './../vnode/vinalla-node';\nimport {REG_EVENT, REG_STR} from \"../const\"\nexport function OnClick(exp:string,vnode:VinallaNode,isconst:boolean){\n    if (REG_EVENT.test(exp)) {\n        let methodStr = RegExp.$1\n        let paramsStr = RegExp.$2\n        if (paramsStr.length > 0) {\n            let ps = paramsStr.split(\",\")\n            vnode.DomSet[0].dom.addEventListener(\"click\", () => {\n                let params: any[] = []\n                ps.forEach(p => {\n                    if (!REG_STR.test(p)) {\n                        if (p === \"true\") {\n                            params.push(true)\n                            return\n                        }\n                        if (p === \"false\") {\n                            params.push(false)\n                        }\n                        let n = new Number(p).valueOf()\n                        if (!isNaN(n)) {\n                            params.push(n.valueOf())\n                        } else {\n                            //肯定是本地变量\n                            params.push(vnode.mvvm.$GetExpOrFunValue(p))\n                        }\n                    } else {\n                        params.push(RegExp.$2)\n                    }\n                })\n                vnode.mvvm.$RevokeMethod(methodStr, ...params)\n            })\n        }else{\n            vnode.DomSet[0].dom.addEventListener(\"click\", () => {\n                vnode.mvvm.$RevokeMethod(methodStr)  \n            })\n        }\n    }\n}","import { VinallaNode } from './../vnode/vinalla-node';\nimport { VNode } from \"../vnode/vnode\"\nexport function DirModel(exp: string, vnode: VinallaNode,isconst:boolean) {\n    let inputtype=vnode.Vdom.GetAttr(\"type\")\n    let input=vnode.Vdom.NodeName.toLowerCase()\n\n    let newvalue=vnode.mvvm.$GetExpOrFunValue(exp);\n    setValue(vnode, newvalue)\n    if(input==\"input\" && inputtype==\"checkbox\"){\n        vnode.mvvm.$CreateWatcher(vnode,exp, (newvalue) => {\n            setValue(vnode, newvalue)\n        },true);\n    }else{\n        vnode.mvvm.$CreateWatcher(vnode,exp, (newvalue) => {\n            setValue(vnode, newvalue)\n        });\n    }\n    vnode.DomSet[0].dom.addEventListener(\"input\", (event: any) => {\n        //select控件\n        if (vnode.GetNodeName() == \"select\") {\n            vnode.mvvm.$SetValue(exp, event.target.value)\n            return\n        }\n        //text radio checkbox控件\n        let inputType = (vnode.DomSet[0].dom as HTMLElement).getAttribute(\"type\")\n        if (inputType == null || inputType == \"\")\n            inputType = \"text\"\n        switch (inputType) {\n            case \"text\":\n            case \"radio\":\n                vnode.mvvm.$SetValue(exp, event.target.value)\n                break\n            case \"checkbox\":\n                let cur = vnode.mvvm.$GetExpOrFunValue(exp)\n                if (toString.call(cur) == \"[object Array]\") {\n                    let oldarray = cur as Array<any>;\n                    let index = oldarray.indexOf(event.target.value)\n                    if (index == -1) {\n                        oldarray.push(event.target.value)\n                    } else {\n                        oldarray.splice(index, 1)\n                    }\n                }\n                break\n        }\n    })\n}\n\nfunction setValue(vnode: VNode, newvalue: any) {\n    let dom=vnode.DomSet[0].dom;\n    //select控件\n    if (vnode.GetNodeName()== \"select\") {\n        (dom as HTMLSelectElement).value = newvalue;\n        return\n    }\n    //text radio checkbox控件\n    let inputType = (dom as HTMLElement).getAttribute(\"type\")\n    if (inputType == null || inputType == \"\")\n        inputType = \"text\"\n    switch (inputType) {\n        case \"text\":\n            (dom as HTMLInputElement).value = newvalue\n            break\n        case \"radio\":\n            if ((dom as HTMLInputElement).value == newvalue) {\n                (dom as HTMLInputElement).checked = true\n            } else\n                (dom as HTMLInputElement).checked = false;\n            break\n        case \"checkbox\":\n            if (toString.call(newvalue) == \"[object Array]\") {\n                if (newvalue.indexOf((dom as HTMLInputElement).value) == -1) {\n                    (dom as HTMLInputElement).checked = false\n                } else\n                    (dom as HTMLInputElement).checked = true;\n            }\n\n            break\n    }\n}","import { PRE } from \"../const\";\nimport { StrToEvalstr } from \"../util\";\nimport { VinallaNode } from './../vnode/vinalla-node';\n\nexport function Href(exp:string,vnode:VinallaNode,isconst:boolean){\n    let href:string=\"\"\n    if(vnode.DomSet[0].dom.nodeName.toLowerCase()==\"a\"){\n        if(isconst){\n            let streval=StrToEvalstr(exp)\n            if(streval.isconst){\n                href=streval.exp;\n                (vnode.DomSet[0].dom as HTMLElement).setAttribute(PRE+\"href\",streval.exp);\n            }\n            else{\n                let newvalue=vnode.mvvm.$GetExpOrFunValue(streval.exp);\n                href=newvalue;\n                (vnode.DomSet[0].dom as HTMLElement).setAttribute(PRE+\"href\",newvalue);\n                vnode.mvvm.$CreateWatcher(vnode,streval.exp,newvalue=>{\n                    href=newvalue;\n                    (vnode.DomSet[0].dom as HTMLElement).setAttribute(PRE+\"href\",newvalue);\n                })                \n            }\n        }else{\n            let newvalue=vnode.mvvm.$GetExpOrFunValue(exp);\n            href=newvalue;\n            vnode.mvvm.$CreateWatcher(vnode,exp,newvalue=>{\n                href=newvalue;\n                (vnode.DomSet[0].dom as HTMLElement).setAttribute(PRE+\"href\",newvalue);\n            });\n        }\n        \n    }\n    vnode.DomSet[0].dom.addEventListener(\"click\",()=>{\n        vnode.NavigateTo(href)\n    })\n}\n","import { VinallaNode } from './../vnode/vinalla-node';\nimport { Href } from './href';\nimport { PRE } from '../const';\nimport { DirModel } from './model';\nimport { OnClick } from './onclick';\nimport {Html} from \"./html\"\nimport {Style} from \"./style\"\nimport {Classes} from \"./class\"\n\nlet innerDirs:{[name:string]:InnerDirective}={}\nfunction RegisterInnerDir(name:string,comiple:InnerDirective){\n    if(innerDirs[name]!=null)\n        throw new Error(\"inner directive \"+name+\" already exists\")\n    innerDirs[name]=comiple\n}\n\nexport function GetInnerDir(name:string){\n    return innerDirs[name]\n}\n\nexport interface InnerDirective{\n    (exp:string,vnode:VinallaNode,isconst:boolean,):void\n}\n\n\nRegisterInnerDir(PRE+\"href\",Href)\nRegisterInnerDir(PRE+\"model\",DirModel)\nRegisterInnerDir(PRE+\"click\",OnClick)\nRegisterInnerDir(PRE+\"html\",Html)\nRegisterInnerDir(PRE+\"class\",Classes)\nRegisterInnerDir(PRE+\"style\",Style)","import { GetInnerDir } from \"../directive/inner-dir\";\nimport { GetDirectiveCon, IsDirectiveRegistered } from '../manager/directive-manager';\nimport { DirectiveMVVM } from '../mvvm/directive-mvvm';\nimport { GetNS, InsertDomChild, StrToEvalstr } from '../util';\nimport { DomType, REG_IN, REG_OUT, REG_ATTR } from './../const';\nimport { InnerDirective } from './../directive/inner-dir';\nimport { DirectiveNode } from './directive-node';\nimport { VNode } from './vnode';\nimport { VDom } from \"../vdom/vdom\";\nimport { Mvvm } from \"../mvvm/mvvm\";\nimport { DomStatus } from \"../models\";\nexport class VinallaNode extends VNode{\n    \n    private directives:DirectiveMVVM[]=[]\n    private innerDirective:{dir:InnerDirective,isconst:boolean,exp:string}[]=[];\n    \n    constructor(public Vdom:VDom,public mvvm: Mvvm,public Parent:VNode){\n        super(Vdom,mvvm,Parent);\n        this.nodeValue = this.Vdom.NodeValue\n        this.nodeName = this.Vdom.NodeName\n        this.nodeType = this.Vdom.NodeType\n        //保存元素属性\n        let vanillaAttrs=this.Vdom.Attrs\n        for (let i = 0; i < this.Vdom.Attrs.length; i++) {\n            let attr=this.Vdom.Attrs[i]\n            let ns=GetNS(attr.Name)\n            if(ns.namespace==null)\n                ns.namespace=this.mvvm.$InitNamespace()\n            if(IsDirectiveRegistered(ns.value,ns.namespace)){\n                let dirNode=new DirectiveNode(this.Vdom)\n                let dirCons=GetDirectiveCon(ns.value,ns.namespace)\n                let dirMvvm=new dirCons(dirNode,this)\n                vanillaAttrs=vanillaAttrs.filter(attr=>{\n                    let name=attr.Name\n                    if(REG_IN.test(attr.Name) || REG_OUT.test(attr.Name))\n                        name=RegExp.$1\n                    \n                    let isprop= dirMvvm.$Ins.some(prop=>prop.name==name)\n                    let isevent=dirMvvm.$Outs.some(event=>event==name)\n                    return !(isprop || isevent)\n                })\n                this.directives.push(dirMvvm)\n                return\n            }\n        }\n        vanillaAttrs= vanillaAttrs.filter(attr=>{\n            if(REG_IN.test(attr.Name)){\n                let dir=GetInnerDir(RegExp.$1)\n                if(dir!=null){\n                    this.innerDirective.push({dir:dir,isconst:false,exp:attr.Value})\n                    return false\n                }\n            }\n            let dir=GetInnerDir(attr.Name)\n            if(dir!=null){\n                this.innerDirective.push({dir:dir,isconst:true,exp:attr.Value})\n                return false\n            }\n            return true\n        })\n        vanillaAttrs.forEach(attr=>{\n            if(REG_ATTR.test(attr.Name)){\n                this.attrs.push({name:attr.Name,value:attr.Value})\n            }\n        })\n    }\n\n    OnRemoved(){\n        super.OnRemoved()\n        this.directives.forEach(dir=>dir.$OnDestroy())\n    }\n\n    protected directiveBind(){\n        this.directives.forEach(dir=>dir.$Render())\n        this.innerDirective.forEach(item=>{\n            item.dir(item.exp,this,item.isconst)\n        })\n    }\n    \n    \n    Render() :DomStatus[]{\n        if (this.nodeType == 1) {\n            let dom = document.createElement(this.nodeName)\n            this.attrs.forEach(prop => {\n                dom.setAttribute(prop.name, prop.value)\n            })\n            \n            this.DomSet = [{type:DomType.NEW,dom:dom}] \n            \n            this.Children.forEach(child => {\n                let childdomset=child.Render();\n                childdomset.forEach(childdom=>{\n                    this.DomSet[0].dom.appendChild(childdom.dom)\n                });\n                childdomset.forEach(childom=>{\n                    childom.type=DomType.CONSTANT\n                });\n            })\n            this.directiveBind()\n            return this.DomSet\n        }\n        if (this.nodeType == 3) {\n            let dom = document.createTextNode(this.nodeValue)\n            this.DomSet=[{type:DomType.NEW,dom:dom}]\n            let evalexp=StrToEvalstr(this.nodeValue)\n            if (!evalexp.isconst) {\n                dom.textContent=this.mvvm.$GetExpOrFunValue(evalexp.exp)\n                this.mvvm.$CreateWatcher(this,evalexp.exp,(newvalue, oldvalue)=>{\n                    dom.textContent = newvalue\n                })\n            }else{\n                dom.textContent=evalexp.exp\n            }\n            return this.DomSet\n        }\n        if(this.nodeType==8){\n            let dom=document.createComment(this.nodeValue)\n            this.DomSet=[{type:DomType.NEW,dom: dom}]\n            return this.DomSet\n        }\n    }\n    Rerender() {\n        this.DomSet.forEach(dom=>dom.type=DomType.CONSTANT);\n        if(this.nodeType==1){\n            let thedom=this.DomSet[0].dom\n            let childdom:Node=null\n            this.Children.forEach(child=>{\n                child.DomSet.forEach(domstate=>{\n                    if(domstate.type==DomType.CONSTANT){\n                        childdom=domstate.dom\n                        return\n                    }\n                    if(domstate.type==DomType.NEW){\n                        InsertDomChild(thedom,domstate.dom,childdom)\n                        childdom=domstate.dom\n                        return\n                    }\n                    if(domstate.type==DomType.DELETE){\n                        thedom.removeChild(domstate.dom)\n                        return\n                    }\n                })\n            })\n        }\n        this.Children.forEach(child=>child.Rerender())\n    }\n    Update(){\n        //todo 更新属性\n        if (this.nodeType == 1) {\n            let children: VNode[] = []\n            this.Children.forEach(child => {\n                children.push(child)\n            })\n            children.forEach(child => {\n                child.Update()\n            })\n            //todo 设置属性\n            return\n        }\n        if (this.nodeType == 3) {\n            let evalexp=StrToEvalstr(this.nodeValue)\n            if (!evalexp.isconst) {\n                this.DomSet[0].dom.textContent=this.mvvm.$GetExpOrFunValue(evalexp.exp)\n            }else{\n                this.DomSet[0].dom.textContent=evalexp.exp\n            }\n        }\n    }\n    Reflow(){\n    }\n}","import { IComponentMvvm, Event } from './../models';\nimport { RegisterComponent, GetDomTree } from '../manager/components-manager';\nimport { ComponentOption, Prop } from '../models';\nimport { FetchProperty } from './property';\nimport { VNode } from '../vnode/vnode';\nimport { NewVNode } from '../vdom/vdom';\n\n\n\nexport function Component(option:ComponentOption){\n    checkComponentOption(option)\n    let res=FetchProperty()\n    return function(target:IComponentMvvm){\n        let constructor= class $ComponentMvvm extends target{\n            $InitFuncs:string[]=res.initFuncs\n            $DestroyFuncs:string[]=res.destroyFuncs\n            \n            $initialize(){\n                super.$initialize()\n                this.$InitFuncs.forEach(init=>{\n                    (this as any)[init].call(this)\n                })\n            }\n            $OnDestroy(){\n                super.$OnDestroy()\n                this.$DestroyFuncs.forEach(destroy=>{\n                    (this as any)[destroy].call(this)\n                })\n            }\n            $InitTreeroot():VNode{\n                let domtree=GetDomTree(this.$InitName(),this.$InitNamespace())\n                if(domtree==null){\n                    throw new Error(\"not found template or templateUrl for component \"+this.$InitName()+\" in \"+this.$InitNamespace())\n                }\n                let vnode=NewVNode(domtree,this,null)\n                return vnode\n            }\n            $InitNamespace(): string {\n                return option.namespace\n            }\n            $InitDataItems(): {name:string,value:any}[] {\n                let datas:{name:string,value:any}[]=[]\n                res.datas.forEach(item=>{\n                    datas.push({name:item,value:(this as any)[item]})\n                })\n                return datas\n            }\n            $InitComputeItems(): { name: string; get: () => any }[] {\n                return res.computes\n            }\n            $InitName():string{\n                return option.name\n            }\n            $InitIns():Prop[]{\n                return res.props\n            }\n            $InitOuts():Event[]{\n                return option.events\n            }\n        }\n        RegisterComponent(option.name,option.namespace,constructor,option)\n    }\n}\n\n\nfunction checkComponentOption(option:ComponentOption){\n    option.namespace=option.namespace?option.namespace:\"default\"\n    option.events=option.events?option.events:[]\n}\n\n","import { Start } from \"./manager/start\";\n\n\nexport {Component} from \"./decorator/component\";\nexport {App} from \"./decorator/app\";\nexport {Data,Computed,Prop,OnInit,OnDestroy} from \"./decorator/property\";\nexport {Directive} from \"./decorator/directive\"\n\nexport {ComponentMvvm} from \"./mvvm/component-mvvm\"\nexport {AppMvvm} from \"./mvvm/app-mvvm\"\nexport {DirectiveMVVM} from \"./mvvm/directive-mvvm\"\n\nexport {RegisterRouter} from \"./router/router-manager\"\n\ndocument.addEventListener(\"DOMContentLoaded\", function () {\n    Start()\n})\n\n\n"],"sourceRoot":""}